(()=>{"use strict";(()=>{function e(){console.log("CanvasPal: Starting grade scraping...");try{const e=document.querySelector("h1.ic-Action-header__Heading")?.textContent;if(!e?.includes("Grades"))return console.warn("CanvasPal: Not on a grades page"),null;const t=["h1.page-title",".course-title",".ig-header .name",".course_name","#course_name",".course-nav-link","title",".context_title"];let n="";for(const e of t){const t=document.querySelector(e);if(t?.textContent?.trim()){if(n=t.textContent.trim(),"title"===e){const e=n.match(/: (.+?) -/);e&&(n=e[1])}break}}n||(n="Unknown Course");const s=["#grades_summary",".student_assignments",".assignment-grades",".gradebook-table",".student_assignment_table","#assignments-not-weighted","#assignments-weighted"].map((e=>document.querySelector(e))).find((e=>e));if(!s)return console.warn("CanvasPal: Grade table not found - this might not be a grades page"),null;console.log("CanvasPal: Found course:",n);const a=["tr.student_assignment",".assignment-row",".slick-row",".grade-values",".group_total",".group_grade",".assignment_graded"];let o=[];for(const e of a){const t=s.querySelectorAll(e);if(t.length>0){o=Array.from(t).filter((e=>{const t="true"===e.getAttribute("data-muted"),n="true"===e.getAttribute("data-pending_quiz"),s=e.classList.contains("group_total"),a=e.classList.contains("final_grade");return!(t||n||s||a)})).map((e=>{const t=[".grade",".score",".points",".assignment_score",".total_grade"],n=e.querySelector("th.title a"),s=n?.textContent?.trim()||[".assignment_name",".title",".assignment-name",".assignment_title",".name"].map((t=>e.querySelector(t))).find((e=>e?.textContent?.trim()))?.textContent?.trim()||"Unknown Assignment";let a=0;const o=e.querySelector(".score_holder");if(o){const n=o.querySelector(".original_points")?.textContent?.trim();a=n?parseFloat(n)||0:parseFloat(t.map((t=>e.querySelector(t))).find((e=>e?.textContent?.trim()))?.textContent?.trim()?.replace(/[^0-9.-]/g,"")||"0")}return{name:s,points:a,pointsPossible:parseFloat([".points_possible",".max-points",".total_possible"].map((t=>e.querySelector(t))).find((e=>e?.textContent?.trim()))?.textContent?.trim()?.replace(/[^0-9.-]/g,"")||"0"),weight:parseFloat([".assignment_weight",".weight",".group_weight"].map((t=>e.querySelector(t))).find((e=>e?.textContent?.trim()))?.textContent?.trim()?.replace(/[^0-9.-]/g,"")||"0")}}));break}}if(0===o.length)return console.warn("CanvasPal: No assignments found in grade table"),null;console.log("CanvasPal: Found",o.length,"assignments");const r={courseName:n,assignments:o};return console.log("CanvasPal: Successfully scraped data:",r),r}catch(e){return console.error("CanvasPal: Error scraping grades:",e),null}}chrome.runtime.onMessage.addListener(((t,n,s)=>{if("getGrades"===t.action){console.log("CanvasPal: Received grade request");const t=e();return s({grades:t,success:null!==t}),!0}}));const t=()=>{new MutationObserver(((t,n)=>{document.getElementById("grades_summary")&&(n.disconnect(),e())})).observe(document.body,{childList:!0,subtree:!0})};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()})()})();
//# sourceMappingURL=gradeScraper.js.map