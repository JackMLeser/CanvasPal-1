{"version":3,"file":"contentScript/index.js","mappings":"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","sources":["webpack://canvaspal/./src/contentScript/canvasButton.ts","webpack://canvaspal/./src/utils/logger.ts","webpack://canvaspal/./src/utils/performanceMonitor.ts","webpack://canvaspal/./src/utils/debugPanel.ts","webpack://canvaspal/./src/utils/dateDebugPanel.ts","webpack://canvaspal/./src/utils/dateDebugger.ts","webpack://canvaspal/./src/utils/priorityCalculator.ts","webpack://canvaspal/./src/utils/assignmentDetector.ts","webpack://canvaspal/./src/contentScript/index.ts"],"sourcesContent":["// Create and inject the button and popup HTML\nconst createElements = async () => {\n    try {\n        console.log('Creating CanvasPal elements');\n        \n        // Ensure we have access to chrome APIs\n        if (!chrome?.runtime) {\n            throw new Error('Chrome APIs not available');\n        }\n\n        // Create and inject styles\n        const styleSheet = document.createElement('style');\n        styleSheet.textContent = `\n            .canvas-pal-button {\n                position: fixed;\n                right: 20px;\n                top: 20px;\n                width: 44px;\n                height: 44px;\n                border-radius: 50%;\n                background: #0066CC;\n                color: white;\n                border: none;\n                font-size: 16px;\n                font-weight: 600;\n                cursor: pointer;\n                z-index: 2147483647;\n                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                backdrop-filter: blur(8px);\n            }\n\n            .canvas-pal-button:hover {\n                transform: translateY(-2px);\n                background: #0056b3;\n                box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n            }\n\n            .canvas-pal-button.has-assignments {\n                animation: canvas-pal-pulse 2s infinite;\n            }\n\n            @keyframes canvas-pal-pulse {\n                0% { transform: scale(1); }\n                50% { transform: scale(1.05); }\n                100% { transform: scale(1); }\n            }\n\n            .canvas-pal-toggle {\n                position: fixed;\n                top: 20px;\n                right: 70px;\n                z-index: 2147483647;\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                background: rgba(255, 255, 255, 0.9);\n                padding: 6px 12px;\n                border-radius: 20px;\n                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n                font-family: 'Lato', sans-serif;\n                font-size: 12px;\n            }\n\n            .canvas-pal-toggle input {\n                margin: 0;\n                cursor: pointer;\n            }\n\n            .popup-container {\n                position: fixed;\n                right: 20px;\n                top: 75px;\n                width: 350px;\n                min-height: 400px;\n                background: #f9f9f9;\n                border: 2px solid #000;\n                z-index: 2147483646;\n                display: none;\n                font-family: 'Lato', sans-serif;\n            }\n\n            .popup-container.show {\n                display: block;\n            }\n\n            .popup-header {\n                display: flex;\n                align-items: center;\n                justify-content: space-between;\n                background-color: #0066CC;\n                color: white;\n                padding: 12px;\n                position: relative;\n                border-bottom: 1px solid #666;\n                margin-bottom: 16px;\n            }\n\n            .popup-title {\n                flex-grow: 1;\n                text-align: center;\n                margin: 0;\n                font-size: 2.3em;\n                color: #FFFFFF;\n                font-family: 'Lato', sans-serif;\n            }\n\n            .task-count {\n                position: absolute;\n                bottom: 8px;\n                left: 9px;\n                font-size: .7em;\n                color: #FFFFFF;\n                font-family: 'Lato', sans-serif;\n            }\n\n            .logo {\n                margin-left: 16px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                width: 50px;\n                height: 50px;\n            }\n\n            .logo-image {\n                width: 100%;\n                height: 100%;\n                border-radius: 20%;\n                border: 3px solid #FFFFFF;\n                padding: 4px;\n                background: white;\n                object-fit: contain;\n            }\n\n            @media (prefers-color-scheme: dark) {\n                .logo-image {\n                    background: transparent;\n                    border-color: rgba(255, 255, 255, 0.8);\n                }\n            }\n\n            .assignments-list {\n                max-height: 300px;\n                overflow-y: auto;\n                padding: 16px;\n            }\n\n            .assignment-item {\n                padding: 12px;\n                border: 1px solid #eee;\n                margin-bottom: 8px;\n                border-radius: 4px;\n                background: white;\n            }\n\n            .assignment-item.high-priority {\n                border-left: 4px solid #d92b2b;\n            }\n\n            .assignment-item.medium-priority {\n                border-left: 4px solid #f0ad4e;\n            }\n\n            .assignment-item.low-priority {\n                border-left: 4px solid #5cb85c;\n            }\n\n            .settings-button {\n                bottom: 16px;\n                right: 16px;\n                position: absolute;\n                text-align: center;\n            }\n\n            .settings-button button {\n                background-color: #0066CC;\n                color: white;\n                padding: 10px 20px;\n                border-radius: 8px;\n                border: none;\n                transition: background-color 0.3s, transform 0.3s;\n                font-family: 'Lato', sans-serif;\n                cursor: pointer;\n                font-size: 14px;\n                font-weight: 500;\n            }\n\n            .settings-button button:hover {\n                background-color: #0056b3;\n                transform: scale(1.08);\n            }\n\n            @media (prefers-color-scheme: dark) {\n                .popup-container {\n                    background: #1c1c1e;\n                    border-color: #666;\n                }\n\n                .assignment-item {\n                    background: #2c2c2e;\n                    border-color: #666;\n                    color: white;\n                }\n\n                .logo img {\n                    background: transparent;\n                }\n\n                .canvas-pal-toggle {\n                    background: rgba(45, 59, 69, 0.9);\n                    color: white;\n                }\n            }\n        `;\n        document.head.appendChild(styleSheet);\n\n        // Create button\n        const button = document.createElement('button');\n        button.className = 'canvas-pal-button';\n        button.textContent = '0';\n        document.body.appendChild(button);\n\n        // Create toggle for non-Canvas pages\n        const toggleContainer = document.createElement('div');\n        toggleContainer.className = 'canvas-pal-toggle';\n        toggleContainer.innerHTML = `\n            <label>\n                <input type=\"checkbox\" id=\"canvas-pal-visibility\" checked>\n                <span>Follow Outside Canvas</span>\n            </label>\n        `;\n        document.body.appendChild(toggleContainer);\n\n        // Create popup container\n        const popup = document.createElement('div');\n        popup.className = 'popup-container';\n        popup.innerHTML = `\n            <div class=\"popup-header\">\n                <div class=\"popup-title\">CanvasPAL</div>\n                <div class=\"task-count\" id=\"taskCount\">0 Tasks</div>\n                <div class=\"logo\">\n                    <img src=\"data:image/png;base64,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\" alt=\"CanvasPAL Logo\" class=\"logo-image\" />\n                </div>\n            </div>\n            <div class=\"assignments-list\" id=\"assignmentList\">\n                <!-- Assignments will be populated here -->\n            </div>\n            <div class=\"settings-button\">\n                <button id=\"settings-button\">Settings</button>\n            </div>\n        `;\n        document.body.appendChild(popup);\n\n        // No need for complex icon loading since we're using root-relative path\n\n        // Add settings button click handler\n        const settingsButton = popup.querySelector('#settings-button');\n        if (settingsButton) {\n            settingsButton.addEventListener('click', () => {\n                console.log('Settings button clicked');\n                try {\n                    const settingsUrl = chrome.runtime.getURL('settings/settings.html');\n                    console.log('Opening settings at:', settingsUrl);\n                    window.open(settingsUrl, '_blank');\n                } catch (error) {\n                    console.error('Error opening settings:', error);\n                }\n            });\n        }\n\n        return { button, toggleContainer, popup };\n    } catch (error) {\n        console.error('Error creating elements:', error);\n        return null;\n    }\n};\n\n// Helper function to determine priority class\nfunction getPriorityClass(score: number): string {\n    if (score >= 0.7) return 'high-priority';\n    if (score >= 0.4) return 'medium-priority';\n    return 'low-priority';\n}\n\n// Helper function to safely update assignments list\nfunction updateAssignmentsList(assignments: any[], assignmentList: HTMLElement, taskCount: HTMLElement) {\n    try {\n        console.log('Updating assignments list:', assignments);\n        taskCount.textContent = `${assignments.length} Tasks`;\n        assignmentList.innerHTML = assignments.map(assignment => `\n            <div class=\"assignment-item ${getPriorityClass(assignment.priorityScore)}\">\n                <div style=\"font-weight: bold;\">${assignment.title}</div>\n                <div>Due: ${new Date(assignment.dueDate).toLocaleString()}</div>\n                <div>Course: ${assignment.course}</div>\n                <div>Points: ${assignment.points !== undefined ? assignment.points : (assignment.maxPoints || 0)}</div>\n            </div>\n        `).join('');\n    } catch (error) {\n        console.error('Error updating assignments list:', error);\n    }\n}\n\n// Initialize button and popup functionality\nexport const initializeButton = async () => {\n    try {\n        console.log('Initializing CanvasPal button');\n        const isCanvasPage = window.location.href.includes('.instructure.com');\n        const elements = await createElements();\n        \n        if (!elements) {\n            console.error('Failed to create elements');\n            return;\n        }\n\n        const { button, toggleContainer, popup } = elements;\n\n        // Show/hide toggle based on page type\n        toggleContainer.style.display = isCanvasPage ? 'flex' : 'none';\n\n        // Initialize visibility from settings\n        if (chrome?.storage?.local) {\n            chrome.storage.local.get('settings', (data) => {\n                try {\n                    const settings = data.settings || { displayOptions: { showOutsideCanvas: true } };\n                    const showOutsideCanvas = settings.displayOptions?.showOutsideCanvas ?? true;\n                    \n                    // Update checkbox state\n                    const checkbox = document.getElementById('canvas-pal-visibility') as HTMLInputElement;\n                    if (checkbox) {\n                        checkbox.checked = showOutsideCanvas;\n                    }\n\n                    // Update button visibility\n                    if (!isCanvasPage) {\n                        button.style.display = showOutsideCanvas ? 'flex' : 'none';\n                    }\n                } catch (error) {\n                    console.error('Error handling settings:', error);\n                }\n            });\n        }\n\n        // Handle button click\n        button.addEventListener('click', () => {\n            popup.classList.toggle('show');\n        });\n\n        // Handle toggle change\n        const checkbox = document.getElementById('canvas-pal-visibility');\n        checkbox?.addEventListener('change', (e) => {\n            const target = e.target as HTMLInputElement;\n            if (chrome?.storage?.local) {\n                chrome.storage.local.get('settings', (data) => {\n                    try {\n                        const settings = data.settings || { displayOptions: {} };\n                        if (!settings.displayOptions) settings.displayOptions = {};\n                        settings.displayOptions.showOutsideCanvas = target.checked;\n                        chrome.storage.local.set({ settings });\n                        \n                        // Update button visibility\n                        if (!isCanvasPage) {\n                            button.style.display = target.checked ? 'flex' : 'none';\n                        }\n                    } catch (error) {\n                        console.error('Error updating settings:', error);\n                    }\n                });\n            }\n        });\n\n        // Close popup when clicking outside\n        document.addEventListener('click', (e) => {\n            const target = e.target as HTMLElement;\n            if (!popup.contains(target) && !button.contains(target)) {\n                popup.classList.remove('show');\n            }\n        });\n\n        // Handle assignment updates\n        if (chrome?.runtime) {\n            chrome.runtime.onMessage.addListener((message) => {\n                try {\n                    console.log('Received message:', message);\n                    if (message.type === 'ASSIGNMENTS_UPDATE') {\n                        button.textContent = message.data.length.toString();\n                        button.classList.toggle('has-assignments', message.data.length > 0);\n\n                        const assignmentList = document.getElementById('assignmentList');\n                        const taskCount = document.getElementById('taskCount');\n                        \n                        if (assignmentList && taskCount) {\n                            updateAssignmentsList(message.data, assignmentList, taskCount);\n                        }\n                    } else if (message.type === 'REFRESH_ASSIGNMENTS') {\n                        // Request fresh assignments from the background script\n                        chrome.runtime.sendMessage({ type: 'GET_ASSIGNMENTS' });\n                    }\n                } catch (error) {\n                    console.error('Error handling message:', error);\n                }\n            });\n\n            // Get initial assignments\n            console.log('Requesting initial assignments');\n            chrome.runtime.sendMessage({ type: 'GET_ASSIGNMENTS' }, (response) => {\n                try {\n                    console.log('Received initial assignments:', response);\n                    if (response?.assignments) {\n                        button.textContent = response.assignments.length.toString();\n                        button.classList.toggle('has-assignments', response.assignments.length > 0);\n\n                        const assignmentList = document.getElementById('assignmentList');\n                        const taskCount = document.getElementById('taskCount');\n                        \n                        if (assignmentList && taskCount) {\n                            updateAssignmentsList(response.assignments, assignmentList, taskCount);\n                        }\n                    }\n                } catch (error) {\n                    console.error('Error getting initial assignments:', error);\n                }\n            });\n        }\n    } catch (error) {\n        console.error('Error initializing button:', error);\n    }\n};\n","export enum LogLevel {\n    DEBUG = 0,\n    INFO = 1,\n    WARN = 2,\n    ERROR = 3\n}\n\ninterface LogEntry {\n    timestamp: string;\n    level: LogLevel;\n    message: string;\n    data?: any;\n    stack?: string;\n}\n\nexport class Logger {\n    private static readonly MAX_LOGS = 1000;\n    private static instances: Map<string, Logger> = new Map();\n    private context: string;\n    private currentLevel: LogLevel;\n\n    public constructor(context: string, level: LogLevel = LogLevel.INFO) {\n        this.context = context;\n        this.currentLevel = level;\n        this.cleanOldLogs();\n    }\n\n    public static getInstance(context: string, level: LogLevel = LogLevel.INFO): Logger {\n        const key = `${context}-${level}`;\n        if (!this.instances.has(key)) {\n            this.instances.set(key, new Logger(context, level));\n        }\n        return this.instances.get(key)!;\n    }\n\n    setLevel(level: LogLevel): void {\n        this.currentLevel = level;\n    }\n\n    debug(message: string, data?: any): void {\n        this.log(LogLevel.DEBUG, message, data);\n    }\n\n    info(message: string, data?: any): void {\n        this.log(LogLevel.INFO, message, data);\n    }\n\n    warn(message: string, data?: any): void {\n        this.log(LogLevel.WARN, message, data);\n    }\n\n    error(message: string, data?: any): void {\n        this.log(LogLevel.ERROR, message, data);\n    }\n\n    public async log(level: LogLevel, message: string, ...args: any[]): Promise<void> {\n        if (level >= this.currentLevel) {\n            const timestamp = new Date().toISOString();\n            const prefix = this.getLogPrefix(level);\n            const formattedMessage = `[${timestamp}] ${prefix} [${this.context}] ${message}`;\n\n            if (args.length) {\n                const formattedData = this.formatLogData(args);\n                console.log(formattedMessage, formattedData);\n            } else {\n                console.log(formattedMessage);\n            }\n\n            const entry: LogEntry = {\n                timestamp,\n                level,\n                message,\n                data: args,\n                stack: Error().stack\n            };\n\n            this.saveLogs(entry);\n\n            if (level === LogLevel.ERROR) {\n                this.notifyError(entry);\n            }\n        }\n    }\n\n    private getLogPrefix(level: LogLevel): string {\n        switch (level) {\n            case LogLevel.DEBUG:\n                return ' DEBUG:';\n            case LogLevel.INFO:\n                return ' INFO:';\n            case LogLevel.WARN:\n                return ' WARN:';\n            case LogLevel.ERROR:\n                return ' ERROR:';\n            default:\n                return '';\n        }\n    }\n\n    private formatLogData(data: any): any {\n        try {\n            if (Array.isArray(data)) {\n                return data.map(item => this.formatLogData(item));\n            }\n\n            if (data && typeof data === 'object') {\n                // Check if it's an Error object\n                if (data instanceof Error) {\n                    return {\n                        name: data.name,\n                        message: data.message,\n                        stack: data.stack\n                    };\n                }\n\n                // Handle regular objects\n                const formatted: Record<string, any> = {};\n                for (const [key, value] of Object.entries(data)) {\n                    formatted[key] = this.formatLogData(value);\n                }\n                return formatted;\n            }\n\n            return data;\n        } catch (error) {\n            return '[Error formatting log data]';\n        }\n    }\n\n    private async saveLogs(entry: LogEntry): Promise<void> {\n        const { logs = [] } = await chrome.storage.local.get('logs');\n        logs.push(entry);\n\n        if (logs.length > Logger.MAX_LOGS) {\n            logs.splice(0, logs.length - Logger.MAX_LOGS);\n        }\n\n        await chrome.storage.local.set({ logs });\n    }\n\n    private async cleanOldLogs(): Promise<void> {\n        const { logs = [] } = await chrome.storage.local.get('logs');\n        const thirtyDaysAgo = new Date();\n        thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n\n        const filteredLogs = logs.filter((log: LogEntry) => \n            new Date(log.timestamp) > thirtyDaysAgo\n        );\n\n        await chrome.storage.local.set({ logs: filteredLogs });\n    }\n\n    private notifyError(entry: LogEntry): void {\n        chrome.notifications.create({\n            type: 'basic',\n            iconUrl: '/dist/icons/icon128.png',\n            title: 'CanvasPal Error',\n            message: entry.message,\n            priority: 2\n        });\n    }\n\n    async getLogs(level?: LogLevel): Promise<LogEntry[]> {\n        const { logs = [] } = await chrome.storage.local.get('logs');\n        return level ? logs.filter((log: LogEntry) => log.level === level) : logs;\n    }\n}\n\nexport const logger = Logger.getInstance('default');\n","import { Logger } from './logger';\n\ninterface PerformanceMetric {\n    name: string;\n    startTime: number;\n    endTime?: number;\n    duration?: number;\n    metadata?: Record<string, any>;\n}\n\ninterface PerformanceReport {\n    metrics: PerformanceMetric[];\n    summary: {\n        totalDuration: number;\n        averageDuration: number;\n        slowestOperation: {\n            name: string;\n            duration: number;\n        };\n        fastestOperation: {\n            name: string;\n            duration: number;\n        };\n    };\n}\n\nexport class PerformanceMonitor {\n    private metrics: PerformanceMetric[] = [];\n    private logger: Logger;\n    private static instance: PerformanceMonitor;\n\n    private constructor() {\n        this.logger = new Logger('PerformanceMonitor');\n    }\n\n    public static getInstance(): PerformanceMonitor {\n        if (!PerformanceMonitor.instance) {\n            PerformanceMonitor.instance = new PerformanceMonitor();\n        }\n        return PerformanceMonitor.instance;\n    }\n\n    public startMetric(name: string, metadata?: Record<string, any>): string {\n        const id = `${name}_${Date.now()}`;\n        this.metrics.push({\n            name,\n            startTime: performance.now(),\n            metadata\n        });\n        return id;\n    }\n\n    public endMetric(name: string): void {\n        const metric = this.metrics.find(m => m.name === name && !m.endTime);\n        if (metric) {\n            metric.endTime = performance.now();\n            metric.duration = metric.endTime - metric.startTime;\n            this.logger.debug(`Performance metric - ${name}:`, {\n                duration: `${metric.duration.toFixed(2)}ms`,\n                metadata: metric.metadata\n            });\n        }\n    }\n\n    public getReport(): PerformanceReport {\n        const completedMetrics = this.metrics.filter(m => m.duration !== undefined);\n        \n        if (completedMetrics.length === 0) {\n            return {\n                metrics: [],\n                summary: {\n                    totalDuration: 0,\n                    averageDuration: 0,\n                    slowestOperation: { name: 'none', duration: 0 },\n                    fastestOperation: { name: 'none', duration: 0 }\n                }\n            };\n        }\n\n        const totalDuration = completedMetrics.reduce((sum, m) => sum + (m.duration || 0), 0);\n        const averageDuration = totalDuration / completedMetrics.length;\n\n        const sorted = [...completedMetrics].sort((a, b) => \n            (b.duration || 0) - (a.duration || 0));\n\n        return {\n            metrics: completedMetrics,\n            summary: {\n                totalDuration,\n                averageDuration,\n                slowestOperation: {\n                    name: sorted[0].name,\n                    duration: sorted[0].duration || 0\n                },\n                fastestOperation: {\n                    name: sorted[sorted.length - 1].name,\n                    duration: sorted[sorted.length - 1].duration || 0\n                }\n            }\n        };\n    }\n\n    public clear(): void {\n        this.metrics = [];\n    }\n\n    public monitorAsync<T>(name: string, fn: () => Promise<T>, metadata?: Record<string, any>): Promise<T> {\n        this.startMetric(name, metadata);\n        return fn().finally(() => this.endMetric(name));\n    }\n\n    public monitor<T>(name: string, fn: () => T, metadata?: Record<string, any>): T {\n        this.startMetric(name, metadata);\n        const result = fn();\n        this.endMetric(name);\n        return result;\n    }\n}","import { Assignment } from '../types/models';\nimport { Logger } from './logger';\nimport { PerformanceMonitor } from './performanceMonitor';\n\nexport class DebugPanel {\n    private panel: HTMLElement | null = null;\n    private logger: Logger;\n    private performanceMonitor: PerformanceMonitor;\n    private isVisible: boolean = false;\n    private debugManager: { isDebugEnabled(): boolean };\n\n    constructor(debugManager: { isDebugEnabled(): boolean }) {\n        this.logger = new Logger('DebugPanel');\n        this.performanceMonitor = PerformanceMonitor.getInstance();\n        this.debugManager = debugManager;\n        this.initializeKeyboardShortcut();\n    }\n\n    private createPanel(): void {\n        const initPanel = () => {\n            if (!document.body) {\n                // Wait for body to be available\n                requestAnimationFrame(initPanel);\n                return;\n            }\n\n            this.panel = document.createElement('div');\n            this.panel.id = 'canvaspal-debug-panel';\n            this.panel.innerHTML = `\n                <div class=\"debug-panel-header\">\n                    <span> CanvasPal Debug</span>\n                    <div class=\"debug-panel-controls\">\n                        <button id=\"clear-metrics\" title=\"Clear Performance Metrics\"></button>\n                        <button id=\"canvaspal-debug-close\"></button>\n                    </div>\n                </div>\n                <div class=\"debug-panel-content\">\n                    <div id=\"performance-metrics\"></div>\n                    <div id=\"assignment-info\"></div>\n                </div>\n            `;\n\n            // Apply styles\n            this.panel.style.cssText = `\n                position: fixed;\n                bottom: 20px;\n                right: 20px;\n                width: 350px;\n                max-height: 500px;\n                background: rgba(0, 0, 0, 0.9);\n                color: white;\n                padding: 15px;\n                border-radius: 8px;\n                font-family: monospace;\n                font-size: 12px;\n                z-index: 9999;\n                overflow-y: auto;\n                box-shadow: 0 0 10px rgba(0,0,0,0.5);\n                display: none;\n            `;\n\n            // Add button styles\n            const style = document.createElement('style');\n            style.textContent = `\n                .debug-panel-header {\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: center;\n                    margin-bottom: 10px;\n                    padding-bottom: 10px;\n                    border-bottom: 1px solid rgba(255,255,255,0.1);\n                }\n\n                .debug-panel-controls {\n                    display: flex;\n                    gap: 8px;\n                }\n\n                .debug-panel-controls button {\n                    background: none;\n                    border: none;\n                    color: white;\n                    cursor: pointer;\n                    padding: 4px;\n                    border-radius: 4px;\n                    transition: background 0.2s;\n                }\n\n                .debug-panel-controls button:hover {\n                    background: rgba(255,255,255,0.1);\n                }\n\n                .performance-section {\n                    margin: 10px 0;\n                    padding: 8px;\n                    background: rgba(255,255,255,0.05);\n                    border-radius: 4px;\n                }\n\n                .metric-item {\n                    margin: 4px 0;\n                    display: flex;\n                    justify-content: space-between;\n                }\n\n                .metric-value {\n                    color: #90EE90;\n                }\n\n                .slow-metric {\n                    color: #ff6b6b;\n                }\n\n                .normal-metric {\n                    color: #ffd700;\n                }\n\n                .fast-metric {\n                    color: #90EE90;\n                }\n            `;\n\n            // Wait for head to be available\n            if (document.head) {\n                document.head.appendChild(style);\n            } else {\n                document.addEventListener('DOMContentLoaded', () => {\n                    document.head.appendChild(style);\n                });\n            }\n\n            document.body.appendChild(this.panel);\n\n            // Add event listeners\n            document.getElementById('canvaspal-debug-close')?.addEventListener('click', () => {\n                this.toggleVisibility();\n            });\n\n            document.getElementById('clear-metrics')?.addEventListener('click', () => {\n                this.performanceMonitor.clear();\n                this.updatePerformanceMetrics();\n            });\n        };\n\n        // Start the initialization process\n        if (document.readyState === 'loading') {\n            document.addEventListener('DOMContentLoaded', initPanel);\n        } else {\n            initPanel();\n        }\n    }\n\n    private initializeKeyboardShortcut(): void {\n        document.addEventListener('keydown', (e) => {\n            // Only respond to shortcuts if debug mode is enabled\n            if (this.debugManager.isDebugEnabled() && (e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'D') {\n                e.preventDefault();\n                this.toggleVisibility();\n            }\n        });\n    }\n\n    public toggleVisibility(): void {\n        // Only allow showing the panel if debug mode is enabled\n        if (this.isVisible || this.debugManager.isDebugEnabled()) {\n            // Create panel if it doesn't exist and we're showing it\n            if (!this.panel && !this.isVisible) {\n                this.createPanel();\n            }\n            \n            if (this.panel) {\n                this.isVisible = !this.isVisible;\n                this.panel.style.display = this.isVisible ? 'block' : 'none';\n                \n                // Remove panel from DOM when hiding it\n                if (!this.isVisible && this.panel.parentNode) {\n                    this.panel.parentNode.removeChild(this.panel);\n                    this.panel = null;\n                }\n                \n                this.logger.debug(`Debug panel ${this.isVisible ? 'shown' : 'hidden'}`);\n            }\n        }\n    }\n\n    private updatePerformanceMetrics(): void {\n        const metricsContainer = document.getElementById('performance-metrics');\n        if (!metricsContainer) return;\n\n        const report = this.performanceMonitor.getReport();\n        \n        metricsContainer.innerHTML = `\n            <div class=\"performance-section\">\n                <h3>Performance Summary</h3>\n                <div class=\"metric-item\">\n                    <span>Total Duration:</span>\n                    <span class=\"metric-value\">${report.summary.totalDuration.toFixed(2)}ms</span>\n                </div>\n                <div class=\"metric-item\">\n                    <span>Average Duration:</span>\n                    <span class=\"metric-value\">${report.summary.averageDuration.toFixed(2)}ms</span>\n                </div>\n                <div class=\"metric-item\">\n                    <span>Slowest Operation:</span>\n                    <span class=\"slow-metric\">${report.summary.slowestOperation.name} (${report.summary.slowestOperation.duration.toFixed(2)}ms)</span>\n                </div>\n                <div class=\"metric-item\">\n                    <span>Fastest Operation:</span>\n                    <span class=\"fast-metric\">${report.summary.fastestOperation.name} (${report.summary.fastestOperation.duration.toFixed(2)}ms)</span>\n                </div>\n            </div>\n            <div class=\"performance-section\">\n                <h3>Recent Operations</h3>\n                ${report.metrics.slice(-5).map(metric => `\n                    <div class=\"metric-item\">\n                        <span>${metric.name}</span>\n                        <span class=\"${this.getMetricSpeedClass(metric.duration || 0)}\">${metric.duration?.toFixed(2)}ms</span>\n                    </div>\n                `).join('')}\n            </div>\n        `;\n    }\n\n    private getMetricSpeedClass(duration: number): string {\n        if (duration > 100) return 'slow-metric';\n        if (duration > 50) return 'normal-metric';\n        return 'fast-metric';\n    }\n\n    public updateAssignmentInfo(assignments: Assignment[]): void {\n        const container = document.getElementById('assignment-info');\n        if (!container) return;\n\n        const typeCounts = this.getAssignmentTypeCounts(assignments);\n        const priorityRanges = this.getPriorityRanges(assignments);\n\n        container.innerHTML = `\n            <div style=\"margin-bottom: 15px;\">\n                <div style=\"color: #0066cc; margin-bottom: 8px;\">\n                    Found ${assignments.length} assignments\n                </div>\n                ${this.renderTypeCounts(typeCounts)}\n                ${this.renderPriorityDistribution(priorityRanges)}\n            </div>\n            ${this.renderAssignmentList(assignments)}\n        `;\n\n        // Update performance metrics\n        this.updatePerformanceMetrics();\n    }\n\n    private getAssignmentTypeCounts(assignments: Assignment[]): Record<string, number> {\n        return assignments.reduce((acc, assignment) => {\n            acc[assignment.type] = (acc[assignment.type] || 0) + 1;\n            return acc;\n        }, {} as Record<string, number>);\n    }\n\n    private getPriorityRanges(assignments: Assignment[]): Record<string, number> {\n        return assignments.reduce((acc, assignment) => {\n            if (assignment.priorityScore >= 0.7) acc.high = (acc.high || 0) + 1;\n            else if (assignment.priorityScore >= 0.4) acc.medium = (acc.medium || 0) + 1;\n            else acc.low = (acc.low || 0) + 1;\n            return acc;\n        }, {} as Record<string, number>);\n    }\n\n    private renderTypeCounts(counts: Record<string, number>): string {\n        return `\n            <div style=\"margin-bottom: 10px;\">\n                <div style=\"color: #ffd700; margin-bottom: 5px;\">Assignment Types:</div>\n                ${Object.entries(counts).map(([type, count]) => `\n                    <div style=\"margin-left: 10px; color: #90EE90;\">\n                        ${type}: ${count}\n                    </div>\n                `).join('')}\n            </div>\n        `;\n    }\n\n    private renderPriorityDistribution(ranges: Record<string, number>): string {\n        const colors = {\n            high: '#ff6b6b',\n            medium: '#ffd700',\n            low: '#90EE90'\n        };\n\n        return `\n            <div style=\"margin-bottom: 10px;\">\n                <div style=\"color: #ffd700; margin-bottom: 5px;\">Priority Distribution:</div>\n                ${Object.entries(ranges).map(([range, count]) => `\n                    <div style=\"margin-left: 10px; color: ${colors[range as keyof typeof colors]};\">\n                        ${range}: ${count}\n                    </div>\n                `).join('')}\n            </div>\n        `;\n    }\n\n    private renderAssignmentList(assignments: Assignment[]): string {\n        return `\n            <div style=\"margin-top: 15px;\">\n                <div style=\"color: #ffd700; margin-bottom: 5px;\">Detailed Assignments:</div>\n                ${assignments.map(assignment => this.renderAssignmentDetail(assignment)).join('')}\n            </div>\n        `;\n    }\n\n    private renderAssignmentDetail(assignment: Assignment): string {\n        const priorityColor = assignment.priorityScore >= 0.7 ? '#ff6b6b' :\n                            assignment.priorityScore >= 0.4 ? '#ffd700' : '#90EE90';\n\n        return `\n            <div style=\"margin: 8px 0; padding: 8px; border-left: 2px solid ${priorityColor}; background: rgba(255,255,255,0.1);\">\n                <div style=\"margin-bottom: 4px;\"> ${assignment.title}</div>\n                <div style=\"color: #90EE90; margin-bottom: 4px;\">\n                    ${assignment.points ? ` ${assignment.points}/${assignment.maxPoints} points` : 'No points data'}\n                </div>\n                <div style=\"color: #ADD8E6; font-size: 11px;\">\n                     Due: ${this.formatDate(assignment.dueDate)}\n                </div>\n                <div style=\"color: #DDA0DD; font-size: 11px;\">\n                     Course: ${assignment.course}\n                </div>\n                <div style=\"color: ${priorityColor}; font-size: 11px; margin-top: 4px;\">\n                     Priority: ${Math.round(assignment.priorityScore * 100)}%\n                </div>\n            </div>\n        `;\n    }\n\n    public logDetectionEvent(message: string, data?: any): void {\n        this.logger.debug(message, data);\n        // Could add visual indication of new events in the panel\n    }\n\n    private formatDate(date: string): string {\n        // Handle special date strings\n        if (date === 'All Day' || date === 'No due date') {\n            return date;\n        }\n\n        // Extract date from \"Due: \" format if present\n        const dateStr = date.startsWith('Due: ') ? date.substring(5) : date;\n        \n        try {\n            const dateObj = new Date(dateStr);\n            // Check if date parsing was successful\n            if (!isNaN(dateObj.getTime())) {\n                return dateObj.toLocaleDateString('en-US', {\n                    month: 'short',\n                    day: 'numeric',\n                    year: 'numeric'\n                });\n            }\n            // Return original string if parsing fails\n            return date;\n        } catch {\n            // Return original string if parsing fails\n            return date;\n        }\n    }\n\n    public updatePerformanceAnalysis(analysis: any): void {\n        // Implementation\n    }\n}","import { Logger } from './logger';\n\ninterface DateDebugInfo {\n    totalDates: number;\n    types: {\n        due: number;\n        availability: number;\n        unlock: number;\n        unknown: number;\n    };\n    detections: {\n        element: string;\n        text: string;\n        type: string;\n        date: string;\n    }[];\n}\n\nexport class DateDebugPanel {\n    private panel: HTMLElement | null = null;\n    private logger: Logger;\n    private debugManager: { isDebugEnabled(): boolean };\n    private isVisible: boolean = false;\n\n    constructor(debugManager: { isDebugEnabled(): boolean }) {\n        this.logger = new Logger('DateDebugPanel');\n        this.debugManager = debugManager;\n        this.initializeKeyboardShortcut();\n    }\n\n    private initializeKeyboardShortcut(): void {\n        document.addEventListener('keydown', (e) => {\n            if (this.debugManager.isDebugEnabled() && (e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'T') {\n                e.preventDefault();\n                this.toggleVisibility();\n            }\n        });\n    }\n\n    private createPanel(): void {\n        if (!document.body) {\n            // Wait for body to be available\n            requestAnimationFrame(() => this.createPanel());\n            return;\n        }\n\n        this.panel = document.createElement('div');\n        this.panel.id = 'date-debug-panel';\n        this.panel.style.cssText = `\n            position: fixed;\n            bottom: 20px;\n            left: 20px;\n            width: 300px;\n            max-height: 400px;\n            background: rgba(0, 0, 0, 0.9);\n            color: white;\n            padding: 15px;\n            border-radius: 8px;\n            font-family: monospace;\n            font-size: 12px;\n            z-index: 9999;\n            overflow-y: auto;\n            box-shadow: 0 0 10px rgba(0,0,0,0.5);\n            display: none;\n        `;\n\n        const header = document.createElement('div');\n        header.innerHTML = `\n            <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;\">\n                <span style=\"color: #ffd700; font-weight: bold;\"> Date Detection Debug</span>\n                <button id=\"date-debug-close\" style=\"background: none; border: none; color: white; cursor: pointer;\"></button>\n            </div>\n        `;\n        this.panel.appendChild(header);\n\n        const content = document.createElement('div');\n        content.id = 'date-debug-content';\n        this.panel.appendChild(content);\n\n        document.body.appendChild(this.panel);\n\n        document.getElementById('date-debug-close')?.addEventListener('click', () => {\n            this.toggleVisibility();\n        });\n    }\n\n    public toggleVisibility(): void {\n        // Only allow showing the panel if debug mode is enabled\n        if (this.isVisible || this.debugManager.isDebugEnabled()) {\n            // Create panel if it doesn't exist and we're showing it\n            if (!this.panel && !this.isVisible) {\n                this.createPanel();\n            }\n            \n            if (this.panel) {\n                this.isVisible = !this.isVisible;\n                this.panel.style.display = this.isVisible ? 'block' : 'none';\n                \n                // Remove panel from DOM when hiding it\n                if (!this.isVisible && this.panel.parentNode) {\n                    this.panel.parentNode.removeChild(this.panel);\n                    this.panel = null;\n                }\n                \n                this.logger.debug(`Date debug panel ${this.isVisible ? 'shown' : 'hidden'}`);\n            }\n        }\n    }\n\n    public updateDebugInfo(info: DateDebugInfo): void {\n        const content = document.getElementById('date-debug-content');\n        if (!content) return;\n\n        content.innerHTML = `\n            <div class=\"date-stats\" style=\"margin-bottom: 15px;\">\n                <div style=\"color: #0066cc; margin-bottom: 8px;\">\n                    Found ${info.totalDates} date${info.totalDates !== 1 ? 's' : ''}\n                </div>\n                ${this.renderTypeDistribution(info.types)}\n            </div>\n            <div class=\"date-detections\">\n                <div style=\"color: #ffd700; margin-bottom: 8px;\">Detected Dates:</div>\n                ${this.renderDetections(info.detections)}\n            </div>\n        `;\n    }\n\n    private renderTypeDistribution(types: DateDebugInfo['types']): string {\n        const colors = {\n            due: '#ff6b6b',\n            availability: '#4CAF50',\n            unlock: '#2196F3',\n            unknown: '#9e9e9e'\n        };\n\n        return Object.entries(types)\n            .map(([type, count]) => `\n                <div style=\"margin-left: 10px; color: ${colors[type as keyof typeof colors]};\">\n                    ${type.charAt(0).toUpperCase() + type.slice(1)}: ${count}\n                </div>\n            `).join('');\n    }\n\n    private renderDetections(detections: DateDebugInfo['detections']): string {\n        return detections\n            .map(detection => `\n                <div style=\"margin: 8px 0; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 4px;\">\n                    <div style=\"margin-bottom: 4px; color: #90EE90;\">\n                        ${detection.text}\n                    </div>\n                    <div style=\"font-size: 11px; color: #ADD8E6;\">\n                        Type: ${detection.type}\n                    </div>\n                    <div style=\"font-size: 11px; color: #DDA0DD;\">\n                        Parsed: ${detection.date}\n                    </div>\n                    <div style=\"font-size: 11px; color: #FFB6C1;\">\n                        Element: ${detection.element}\n                    </div>\n                </div>\n            `).join('');\n    }\n\n    public logDateDetection(message: string, data?: any): void {\n        this.logger.debug(message, data);\n    }\n}","import { Logger } from './logger';\nimport { DateDebugPanel } from './dateDebugPanel';\n\ninterface DateMatch {\n    element: HTMLElement;\n    date: Date;\n    type: 'due' | 'availability' | 'unlock' | 'unknown';\n    text: string;\n}\n\nexport class DateDebugger {\n    private logger: Logger;\n    private debugPanel: DateDebugPanel;\n    private debugManager: { isDebugEnabled(): boolean };\n    private static readonly DATE_DEBUG_STYLES = `\n        .debug-date {\n            background-color: rgba(255, 255, 0, 0.3) !important;\n            border: 2px solid #ffd700 !important;\n            position: relative !important;\n            z-index: 1000;\n            padding: 2px !important;\n            margin: 2px !important;\n            border-radius: 3px !important;\n            display: inline-block !important;\n        }\n\n        .debug-date::after {\n            content: attr(data-debug-type);\n            position: absolute;\n            top: -20px;\n            left: 0;\n            background: #ffd700;\n            color: black;\n            font-size: 10px;\n            padding: 2px 4px;\n            border-radius: 2px;\n            z-index: 1001;\n            pointer-events: none;\n            white-space: nowrap;\n        }\n\n        .debug-date[data-debug-type=\"DUE DATE\"] {\n            border-color: #ff6b6b !important;\n        }\n\n        .debug-date[data-debug-type=\"DUE DATE\"]::after {\n            background: #ff6b6b;\n            color: white;\n        }\n\n        .debug-date[data-debug-type=\"AVAILABILITY\"] {\n            border-color: #4CAF50 !important;\n        }\n\n        .debug-date[data-debug-type=\"AVAILABILITY\"]::after {\n            background: #4CAF50;\n            color: white;\n        }\n\n        .debug-date[data-debug-type=\"UNLOCK\"] {\n            border-color: #2196F3 !important;\n        }\n\n        .debug-date[data-debug-type=\"UNLOCK\"]::after {\n            background: #2196F3;\n            color: white;\n        }\n    `;\n\n    constructor() {\n        // Create debug manager\n        this.debugManager = {\n            isDebugEnabled: () => true // Always enable debug for development\n        };\n\n        this.logger = new Logger('DateDebugger');\n        this.debugPanel = new DateDebugPanel(this.debugManager);\n        this.injectDebugStyles();\n    }\n\n    private injectDebugStyles(): void {\n        const styleElement = document.createElement('style');\n        styleElement.textContent = DateDebugger.DATE_DEBUG_STYLES;\n        document.head.appendChild(styleElement);\n    }\n\n    public highlightDates(): DateMatch[] {\n        const dateMatches: DateMatch[] = [];\n        \n        // Common date-containing elements\n        const dateElements = document.querySelectorAll<HTMLElement>(\n            '[class*=\"date\"], [class*=\"due\"], [class*=\"deadline\"], ' +\n            '[aria-label*=\"due\"], [title*=\"due\"], ' +\n            '[data-date], [datetime]'\n        );\n\n        dateElements.forEach(element => {\n            const match = this.processDateElement(element);\n            if (match) {\n                dateMatches.push(match);\n                this.applyDebugHighlight(match);\n            }\n        });\n\n        // Look for dates in text content\n        const textMatches = this.findDatesInTextNodes();\n        dateMatches.push(...textMatches);\n\n        // Update debug panel with results\n        this.updateDebugPanel(dateMatches);\n\n        this.logger.debug('Found dates:', dateMatches);\n        return dateMatches;\n    }\n\n    private findDatesInTextNodes(): DateMatch[] {\n        const matches: DateMatch[] = [];\n        const walker = document.createTreeWalker(\n            document.body,\n            NodeFilter.SHOW_TEXT,\n            {\n                acceptNode: (node) => {\n                    if (node.parentElement?.closest('.debug-date')) {\n                        return NodeFilter.FILTER_REJECT;\n                    }\n                    const hasDate = this.containsDatePattern(node.textContent || '');\n                    return hasDate ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;\n                }\n            }\n        );\n\n        let node: Text | null;\n        while (node = walker.nextNode() as Text) {\n            const textMatches = this.findDatesInText(node);\n            textMatches.forEach(match => {\n                matches.push(match);\n                this.applyDebugHighlight(match);\n            });\n        }\n\n        return matches;\n    }\n\n    private updateDebugPanel(matches: DateMatch[]): void {\n        const types = {\n            due: 0,\n            availability: 0,\n            unlock: 0,\n            unknown: 0\n        };\n\n        matches.forEach(match => {\n            types[match.type]++;\n        });\n\n        const debugInfo = {\n            totalDates: matches.length,\n            types,\n            detections: matches.map(match => ({\n                element: this.getElementDescription(match.element),\n                text: match.text,\n                type: this.getDebugLabel(match.type),\n                date: match.date.toLocaleString()\n            }))\n        };\n\n        this.debugPanel.updateDebugInfo(debugInfo);\n    }\n\n    private getElementDescription(element: HTMLElement): string {\n        const tagName = element.tagName.toLowerCase();\n        const id = element.id ? `#${element.id}` : '';\n        const classes = Array.from(element.classList)\n            .filter(cls => !cls.includes('debug-date'))\n            .map(cls => `.${cls}`)\n            .join('');\n        \n        return `${tagName}${id}${classes}`;\n    }\n\n    private processDateElement(element: HTMLElement): DateMatch | null {\n        const dateStr = element.getAttribute('data-date') ||\n                       element.getAttribute('datetime') ||\n                       element.getAttribute('title') ||\n                       element.getAttribute('aria-label') ||\n                       element.textContent;\n\n        if (!dateStr) return null;\n\n        const date = this.parseDate(dateStr);\n        if (!date) return null;\n\n        const type = this.determineDateType(element, dateStr);\n        \n        return {\n            element,\n            date,\n            type,\n            text: dateStr\n        };\n    }\n\n    private findDatesInText(node: Text): DateMatch[] {\n        const matches: DateMatch[] = [];\n        const text = node.textContent || '';\n        \n        // Common date patterns\n        const datePatterns = [\n            // ISO format\n            /\\d{4}-\\d{2}-\\d{2}/g,\n            // MM/DD/YYYY or DD/MM/YYYY\n            /\\d{1,2}\\/\\d{1,2}\\/\\d{4}/g,\n            // Month DD, YYYY\n            /(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]* \\d{1,2},? \\d{4}/gi,\n            // Tomorrow, Today, etc.\n            /\\b(?:today|tomorrow|yesterday)\\b/gi,\n            // Next/Last Day\n            /(?:next|last) (?:monday|tuesday|wednesday|thursday|friday|saturday|sunday)\\b/gi\n        ];\n\n        datePatterns.forEach(pattern => {\n            const regex = new RegExp(pattern);\n            let match;\n            while ((match = regex.exec(text)) !== null) {\n                const date = this.parseDate(match[0]);\n                if (date) {\n                    // Create a new span element to wrap the date text\n                    const span = document.createElement('span');\n                    node.splitText(match.index);\n                    const dateNode = node.splitText(match[0].length);\n                    span.textContent = match[0];\n                    node.parentNode?.replaceChild(span, node);\n\n                    matches.push({\n                        element: span,\n                        date,\n                        type: this.determineDateType(span, match[0]),\n                        text: match[0]\n                    });\n                }\n            }\n        });\n\n        return matches;\n    }\n\n    private parseDate(dateStr: string): Date | null {\n        try {\n            const normalized = dateStr.toLowerCase();\n            \n            // Handle relative dates\n            if (normalized.includes('today')) {\n                return new Date();\n            } else if (normalized.includes('tomorrow')) {\n                const tomorrow = new Date();\n                tomorrow.setDate(tomorrow.getDate() + 1);\n                return tomorrow;\n            } else if (normalized.includes('yesterday')) {\n                const yesterday = new Date();\n                yesterday.setDate(yesterday.getDate() - 1);\n                return yesterday;\n            }\n\n            // Try parsing as ISO date first\n            const date = new Date(dateStr);\n            if (!isNaN(date.getTime())) {\n                return date;\n            }\n\n            // Try other common formats\n            const formats = [\n                // Add more date formats as needed\n                /(\\d{1,2})\\/(\\d{1,2})\\/(\\d{4})/,\n                /(\\w+) (\\d{1,2}),? (\\d{4})/\n            ];\n\n            for (const format of formats) {\n                const match = dateStr.match(format);\n                if (match) {\n                    const parsed = new Date(dateStr);\n                    if (!isNaN(parsed.getTime())) {\n                        return parsed;\n                    }\n                }\n            }\n        } catch (error) {\n            this.logger.debug('Date parsing failed:', { dateStr, error });\n        }\n        return null;\n    }\n\n    private determineDateType(element: HTMLElement, text: string): DateMatch['type'] {\n        const context = (element.textContent + ' ' +\n                        (element.getAttribute('aria-label') || '') + ' ' +\n                        (element.getAttribute('title') || '')).toLowerCase();\n\n        if (context.includes('due') || context.includes('deadline')) {\n            return 'due';\n        } else if (context.includes('available') || context.includes('opens')) {\n            return 'availability';\n        } else if (context.includes('unlock') || context.includes('start')) {\n            return 'unlock';\n        }\n        return 'unknown';\n    }\n\n    private applyDebugHighlight(match: DateMatch): void {\n        const element = match.element;\n        element.classList.add('debug-date');\n        element.setAttribute('data-debug-type', this.getDebugLabel(match.type));\n        element.setAttribute('title', `Detected ${match.type} date: ${match.date.toLocaleDateString()}`);\n    }\n\n    private getDebugLabel(type: DateMatch['type']): string {\n        switch (type) {\n            case 'due': return 'DUE DATE';\n            case 'availability': return 'AVAILABILITY';\n            case 'unlock': return 'UNLOCK';\n            default: return 'DATE';\n        }\n    }\n\n    private containsDatePattern(text: string | null): boolean {\n        if (!text) return false;\n        return /\\d{4}-\\d{2}-\\d{2}|\\d{1,2}\\/\\d{1,2}\\/\\d{4}|(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]* \\d{1,2},? \\d{4}|\\b(?:today|tomorrow|yesterday)\\b|(?:next|last) (?:monday|tuesday|wednesday|thursday|friday|saturday|sunday)\\b/i.test(text);\n    }\n}","import { Assignment, PriorityWeights, PriorityDetails } from '../types/models';\nimport { Logger } from './logger';\nimport { DebugPanel } from './debugPanel';\nimport { PerformanceMonitor } from './performanceMonitor';\n\nexport class PriorityCalculator {\n    private PRIORITY_WEIGHTS: PriorityWeights = {\n        GRADE_IMPACT: 0.35,\n        COURSE_GRADE: 0.25,\n        DUE_DATE: 0.4  // Increased weight for due dates\n    };\n\n    private readonly TYPE_WEIGHTS = {\n        exam: 1.4,     // Highest priority\n        quiz: 1.2,     // High priority\n        assignment: 1.0, // Standard weight\n        discussion: 0.8, // Lower priority\n        announcement: 0.5 // Lowest priority\n    };\n\n    private logger: Logger;\n    private debugPanel: DebugPanel;\n    private performanceMonitor: PerformanceMonitor;\n    private debugManager: { isDebugEnabled(): boolean };\n\n    constructor() {\n        // Create debug manager\n        this.debugManager = {\n            isDebugEnabled: () => true // Always enable debug for development\n        };\n\n        this.logger = new Logger('PriorityCalculator');\n        this.debugPanel = new DebugPanel(this.debugManager);\n        this.performanceMonitor = PerformanceMonitor.getInstance();\n    }\n\n    public calculatePriority(assignment: Assignment): number {\n        return this.performanceMonitor.monitor('calculatePriority', () => {\n            try {\n                const metrics = {\n                    daysUntilDue: this.performanceMonitor.monitor('calculateDaysUntilDue', \n                        () => this.calculateDaysUntilDue(assignment.dueDate)),\n                    gradeImpact: this.performanceMonitor.monitor('calculateGradeImpact', \n                        () => this.calculateGradeImpact(assignment)),\n                    courseGradeImpact: this.performanceMonitor.monitor('calculateCourseGradeImpact', \n                        () => this.calculateCourseGradeImpact(assignment)),\n                    typeWeight: this.performanceMonitor.monitor('getTypeWeight', \n                        () => this.getTypeWeight(assignment.type))\n                };\n\n                // Calculate individual components\n                const components = this.performanceMonitor.monitor('calculateComponents', () => ({\n                    gradeComponent: metrics.gradeImpact * this.PRIORITY_WEIGHTS.GRADE_IMPACT,\n                    courseComponent: metrics.courseGradeImpact * this.PRIORITY_WEIGHTS.COURSE_GRADE,\n                    dateComponent: this.calculateDueDatePriority(metrics.daysUntilDue) * this.PRIORITY_WEIGHTS.DUE_DATE\n                }));\n\n                // Generate priority details\n                const priorityDetails: PriorityDetails = {\n                    dueStatus: this.getDueStatus(metrics.daysUntilDue),\n                    daysUntilDue: metrics.daysUntilDue,\n                    pointsImpact: this.getPointsImpact(assignment.points),\n                    typeImportance: this.getTypeImportance(assignment.type, assignment.title),\n                    components: {\n                        dueDateScore: components.dateComponent,\n                        gradeImpactScore: components.gradeComponent,\n                        typeScore: metrics.typeWeight\n                    }\n                };\n\n                // Calculate final priority with enhanced weighting\n                const finalPriority = this.performanceMonitor.monitor('calculateFinalPriority', () => {\n                    let priority = components.gradeComponent + components.courseComponent + components.dateComponent;\n                    \n                    // Apply type weight using both type and title\n                    priority *= this.getTypeWeight(assignment.type, assignment.title);\n                    \n                    // Additional boosts for critical assignments\n                    if (metrics.daysUntilDue <= 0) {\n                        priority *= 1.5; // 50% boost for overdue\n                    } else if (metrics.daysUntilDue <= 1) {\n                        priority *= 1.3; // 30% boost for due within 24 hours\n                    }\n                    \n                    // Boost for high-point assignments\n                    if (assignment.points >= 50) {\n                        priority *= 1.2; // 20% boost for assignments worth 50+ points\n                    }\n                    \n                    // Cap final priority between 0 and 1.5\n                    return Math.min(Math.max(priority, 0), 1.5);\n                });\n\n                // Attach priority details to assignment\n                assignment.priorityDetails = priorityDetails;\n\n                // Log calculation details to debug panel\n                this.debugPanel.logDetectionEvent('Priority calculation:', {\n                    assignment: assignment.title,\n                    components,\n                    metrics,\n                    finalPriority,\n                    performance: this.performanceMonitor.getReport()\n                });\n\n                return finalPriority;\n            } catch (error) {\n                this.logger.error('Error calculating priority:', error);\n                return 0;\n            }\n        }, { assignmentTitle: assignment.title });\n    }\n\n    private calculateDaysUntilDue(dueDate: string): number {\n        // Handle special cases\n        if (dueDate === 'All Day') {\n            return 0; // Due today\n        }\n        if (dueDate === 'No due date') {\n            return 14; // Default to 2 weeks\n        }\n\n        // Extract date from \"Due: \" format if present\n        const dateStr = dueDate.startsWith('Due: ') ? dueDate.substring(5) : dueDate;\n        \n        try {\n            const dueDateObj = new Date(dateStr);\n            // Check if date parsing was successful\n            if (!isNaN(dueDateObj.getTime())) {\n                const now = new Date();\n                const diffTime = dueDateObj.getTime() - now.getTime();\n                return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n            }\n            // Default to 2 weeks if parsing fails\n            this.logger.warn('Invalid date format:', dueDate);\n            return 14;\n        } catch (error) {\n            this.logger.error('Error calculating days until due:', error);\n            return 14; // Default to 2 weeks on error\n        }\n    }\n\n    private calculateDueDatePriority(daysUntilDue: number): number {\n        if (daysUntilDue <= 0) return 1.5; // Overdue assignments get 150% priority\n        if (daysUntilDue <= 1) return 1.2; // Due within 24 hours gets 120% priority\n        if (daysUntilDue <= 3) return 1.0; // Due within 3 days gets full priority\n        if (daysUntilDue >= 14) return 0.3; // Far future assignments get low priority\n        return 1 - (daysUntilDue / 14); // Linear decrease in priority over 14 days\n    }\n\n    private calculateGradeImpact(assignment: Assignment): number {\n        // If no points info available, use a moderate default based on type\n        if (!assignment.points || !assignment.maxPoints) {\n            switch (assignment.type) {\n                case 'quiz':\n                    return 0.7; // Quizzes typically important\n                case 'exam':\n                    return 0.9; // Exams very important\n                default:\n                    return 0.5;\n            }\n        }\n\n        // Calculate base impact from points\n        let impact = 0;\n        \n        // Scale based on point ranges\n        if (assignment.points >= 100) impact = 1.0;        // 100+ points = max priority\n        else if (assignment.points >= 50) impact = 0.9;    // 50-99 points = very high\n        else if (assignment.points >= 20) impact = 0.7;    // 20-49 points = high\n        else if (assignment.points >= 10) impact = 0.5;    // 10-19 points = medium\n        else impact = 0.3;                                 // <10 points = lower\n\n        // Adjust impact based on grade weight if available\n        if (assignment.gradeWeight) {\n            impact *= (1 + assignment.gradeWeight); // Weight increases impact\n        }\n\n        // Title-based adjustments\n        const title = assignment.title.toLowerCase();\n        if (title.includes('exam') || title.includes('final') || title.includes('midterm')) {\n            impact *= 1.3; // 30% boost for exams\n        } else if (title.includes('quiz')) {\n            impact *= 1.1; // 10% boost for quizzes\n        }\n\n        // Cap final impact at 1.5\n        return Math.min(impact, 1.5);\n    }\n\n    private calculateCourseGradeImpact(assignment: Assignment): number {\n        if (!assignment.courseGrade) return 0.85; // Default if no course grade available\n        return 1 - assignment.courseGrade; // Lower grades mean higher priority\n    }\n\n    private getTypeWeight(type: Assignment['type'], title: string = ''): number {\n        // Check title for exam-related keywords\n        const lowerTitle = title.toLowerCase();\n        if (lowerTitle.includes('exam') ||\n            lowerTitle.includes('final') ||\n            lowerTitle.includes('midterm')) {\n            return this.TYPE_WEIGHTS.exam;\n        }\n\n        // Check title for quiz if type is assignment\n        if (type === 'assignment' && lowerTitle.includes('quiz')) {\n            return this.TYPE_WEIGHTS.quiz;\n        }\n\n        // Use type-based weights\n        switch (type) {\n            case 'quiz':\n                return this.TYPE_WEIGHTS.quiz;\n            case 'assignment':\n                return this.TYPE_WEIGHTS.assignment;\n            case 'discussion':\n                return this.TYPE_WEIGHTS.discussion;\n            case 'announcement':\n                return this.TYPE_WEIGHTS.announcement;\n            default:\n                return this.TYPE_WEIGHTS.assignment;\n        }\n    }\n\n    private getDueStatus(daysUntilDue: number): PriorityDetails['dueStatus'] {\n        if (daysUntilDue <= 0) return 'overdue';\n        if (daysUntilDue <= 1) return 'due-soon';\n        if (daysUntilDue <= 7) return 'upcoming';\n        return 'far-future';\n    }\n\n    private getPointsImpact(points: number): PriorityDetails['pointsImpact'] {\n        if (points >= 50) return 'high';\n        if (points >= 20) return 'medium';\n        return 'low';\n    }\n\n    private getTypeImportance(type: Assignment['type'], title: string): PriorityDetails['typeImportance'] {\n        const lowerTitle = title.toLowerCase();\n        \n        // Check for exam-related keywords in title\n        if (lowerTitle.includes('exam') ||\n            lowerTitle.includes('final') ||\n            lowerTitle.includes('midterm')) {\n            return 'critical';\n        }\n\n        // Check for quiz in title if type is assignment\n        if (type === 'assignment' && lowerTitle.includes('quiz')) {\n            return 'high';\n        }\n\n        // Use type-based importance\n        switch (type) {\n            case 'quiz':\n                return 'high';\n            case 'assignment':\n                return 'normal';\n            case 'discussion':\n                return 'low';\n            case 'announcement':\n                return 'low';\n            default:\n                return 'normal';\n        }\n    }\n\n    public setPriorityWeights(weights: Partial<PriorityWeights>): void {\n        const totalWeight = (weights.GRADE_IMPACT || this.PRIORITY_WEIGHTS.GRADE_IMPACT) +\n                          (weights.COURSE_GRADE || this.PRIORITY_WEIGHTS.COURSE_GRADE) +\n                          (weights.DUE_DATE || this.PRIORITY_WEIGHTS.DUE_DATE);\n\n        if (Math.abs(totalWeight - 1) > 0.001) {\n            this.logger.warn('Priority weights do not sum to 1. Using default weights.');\n            return;\n        }\n\n        Object.assign(this.PRIORITY_WEIGHTS, weights);\n        this.logger.info('Priority weights updated:', this.PRIORITY_WEIGHTS);\n        this.debugPanel.logDetectionEvent('Priority weights updated:', this.PRIORITY_WEIGHTS);\n    }\n}\n","import { Assignment, AssignmentType, AssignmentDetails } from '../types/models';\nimport { Logger, LogLevel } from '../utils/logger';\nimport { DebugPanel } from './debugPanel';\nimport { DateDebugger } from './dateDebugger';\nimport { PerformanceMonitor } from './performanceMonitor';\nimport { PriorityCalculator } from './priorityCalculator';\n\nexport class AssignmentDetector {\n    private logger: Logger;\n    private debugPanel: DebugPanel;\n    private dateDebugger: DateDebugger;\n    private performanceMonitor: PerformanceMonitor;\n    private debugManager: { isDebugEnabled(): boolean };\n    private priorityCalculator: PriorityCalculator;\n\n    constructor() {\n        // Create debug manager\n        this.debugManager = {\n            isDebugEnabled: () => true // Always enable debug for development\n        };\n\n        this.logger = new Logger('AssignmentDetector', LogLevel.INFO);\n        try {\n          this.debugPanel = new DebugPanel(this.debugManager);\n          this.dateDebugger = new DateDebugger();\n          this.performanceMonitor = PerformanceMonitor.getInstance();\n          this.priorityCalculator = new PriorityCalculator();\n        } catch (error) {\n          console.error(\"Error initializing debug tools: \", error);\n          // Provide fallback implementations to prevent crashes\n          this.debugPanel = { logDetectionEvent: () => {} } as any;\n          this.dateDebugger = { highlightDates: async () => [] } as any;\n          this.performanceMonitor = { monitorAsync: async (name: string, fn: () => Promise<any>) => fn() } as any;\n          this.priorityCalculator = new PriorityCalculator();\n        }\n    }\n\n    public async detectAssignments(): Promise<Assignment[]> {\n        return this.performanceMonitor.monitorAsync('detectAssignments', async () => {\n            try {\n                // Check if we're on a Canvas page\n                if (!window.location.hostname.includes('instructure.com')) {\n                    this.logger.info('Not on a Canvas page, skipping assignment detection');\n                    return [];\n                }\n\n                this.logger.info('Starting assignment detection');\n                this.debugPanel.logDetectionEvent('Starting assignment detection');\n                \n                // Monitor date detection\n                const dateMatches = await this.performanceMonitor.monitorAsync('dateDetection',\n                    async () => this.dateDebugger.highlightDates(),\n                    { totalElements: document.querySelectorAll('[class*=\"date\"]').length }\n                );\n\n                this.debugPanel.logDetectionEvent('Date detection complete', {\n                    totalDates: dateMatches.length,\n                    dueDates: dateMatches.filter(m => m.type === 'due').length,\n                    performance: this.performanceMonitor.getReport()\n                });\n\n                let allAssignments: Assignment[] = [];\n\n                try {\n                    // Monitor API fetches in parallel\n                    const [plannerItems, missingSubmissions, dashboardItems] = await Promise.all([\n                        this.performanceMonitor.monitorAsync('fetchPlannerItems',\n                            () => this.fetchPlannerItems()),\n                        this.performanceMonitor.monitorAsync('fetchMissingSubmissions',\n                            () => this.fetchMissingSubmissions()),\n                        this.performanceMonitor.monitorAsync('parseDashboardCards',\n                            () => this.parseDashboardCards())\n                    ]);\n\n                    this.logger.info(`Retrieved: ${plannerItems.length} planner items, ${missingSubmissions.length} missing submissions, ${dashboardItems.length} dashboard items`);\n\n                    // Combine and filter assignments\n                    allAssignments = [...plannerItems, ...missingSubmissions, ...dashboardItems]\n                        .filter(assignment => this.isValidAssignment(assignment));\n\n                    // Sort assignments by priority score (highest first)\n                    allAssignments.sort((a, b) => b.priorityScore - a.priorityScore);\n\n                    this.logger.info(`Total valid assignments found: ${allAssignments.length}`);\n                    this.debugPanel.logDetectionEvent('Assignments sorted by priority:',\n                        allAssignments.map(a => ({\n                            title: a.title,\n                            dueDate: a.dueDate,\n                            priority: a.priorityScore\n                        }))\n                    );\n                } catch (error) {\n                    this.logger.error('Error fetching assignments:', error);\n                    return [];\n                }\n\n                // Monitor date validation\n                await this.performanceMonitor.monitorAsync('validateDates',\n                    async () => this.validateAssignmentDates(allAssignments, dateMatches),\n                    { assignmentCount: allAssignments.length }\n                );\n\n                const performanceReport = this.performanceMonitor.getReport();\n                this.debugPanel.logDetectionEvent('Assignment detection complete', {\n                    totalAssignments: allAssignments.length,\n                    performance: performanceReport\n                });\n\n                return allAssignments;\n            } catch (error) {\n                this.logger.error('Error detecting assignments:', error);\n                return [];\n            }\n        });\n    }\n\n    private async validateAssignmentDates(assignments: Assignment[], dateMatches: any[]): Promise<void> {\n        return this.performanceMonitor.monitorAsync('validateAssignmentDates', async () => {\n            assignments.forEach(assignment => {\n                const matchingDateElements = dateMatches.filter(match => {\n                    try {\n                        const matchDate = new Date(match.date).getTime();\n                        const assignmentDate = new Date(assignment.dueDate).getTime();\n                        return Math.abs(matchDate - assignmentDate) < 24 * 60 * 60 * 1000;\n                    } catch {\n                        return false;\n                    }\n                });\n\n                if (matchingDateElements.length > 0) {\n                    this.debugPanel.logDetectionEvent('Date validation:', {\n                        assignment: assignment.title,\n                        dueDate: assignment.dueDate,\n                        matchingElements: matchingDateElements.length\n                    });\n                }\n            });\n        }, { assignmentCount: assignments.length, dateMatchCount: dateMatches.length });\n    }\n\n    private async fetchPlannerItems(): Promise<Assignment[]> {\n        try {\n            const baseUrl = window.location.origin;\n            this.logger.info(`Fetching planner items from ${baseUrl}`);\n            \n            const response = await fetch(`${baseUrl}/api/v1/planner/items?per_page=50`, {\n                headers: {\n                    'Accept': 'application/json+canvas-string-ids, application/json',\n                    'X-Requested-With': 'XMLHttpRequest'\n                },\n                credentials: 'include'\n            });\n\n            if (!response.ok) {\n                this.logger.error(`HTTP error fetching planner items! status: ${response.status}`);\n                const errorText = await response.text();\n                this.logger.error(`Error details: ${errorText}`);\n                return [];\n            }\n            \n            const items = await response.json();\n            this.debugPanel.logDetectionEvent('Planner items retrieved:', items);\n            this.logger.info(`Retrieved ${items.length} planner items`);\n\n            return items.map((item: any) => {\n                try {\n                    const assignment = this.convertPlannerItem(item);\n                    if (assignment) {\n                        this.debugPanel.logDetectionEvent('Processed planner item:', {\n                            title: assignment.title,\n                            type: assignment.type,\n                            dueDate: assignment.dueDate\n                        });\n                        return assignment;\n                    }\n                    return null;\n                } catch (error) {\n                    this.logger.error('Error processing planner item:', error);\n                    return null;\n                }\n            }).filter((item: Assignment | null): item is Assignment => item !== null);\n        } catch (error) {\n            this.logger.error('Error fetching planner items:', error);\n            return [];\n        }\n    }\n\n    private async fetchMissingSubmissions(): Promise<Assignment[]> {\n        try {\n            const baseUrl = window.location.origin;\n            this.logger.info(`Fetching missing submissions from ${baseUrl}`);\n            \n            const response = await fetch(`${baseUrl}/api/v1/users/self/missing_submissions?include[]=planner_overrides`, {\n                headers: {\n                    'Accept': 'application/json',\n                    'X-Requested-With': 'XMLHttpRequest'\n                },\n                credentials: 'include'\n            });\n\n            if (!response.ok) {\n                this.logger.error(`HTTP error fetching missing submissions! status: ${response.status}`);\n                const errorText = await response.text();\n                this.logger.error(`Error details: ${errorText}`);\n                return [];\n            }\n            \n            const submissions = await response.json();\n            this.logger.info(`Retrieved ${submissions.length} missing submissions`);\n            return submissions.map((submission: any) => {\n                try {\n                    return this.convertMissingSubmission(submission);\n                } catch (error) {\n                    this.logger.error('Error processing missing submission:', error);\n                    return null;\n                }\n            })\n                .filter((item: Assignment | null): item is Assignment => item !== null) as Assignment[];\n        } catch (error) {\n            this.logger.error('Error fetching missing submissions:', error);\n            return [];\n        }\n    }\n\n    private async parseDashboardCards(): Promise<Assignment[]> {\n        try {\n            // Check if we're on a Canvas page\n            if (!window.location.hostname.includes('instructure.com')) {\n                this.logger.info('Not on a Canvas page, skipping dashboard cards fetch');\n                return [];\n            }\n\n            const baseUrl = window.location.origin;\n            this.logger.info(`Fetching dashboard cards from ${baseUrl}`);\n            \n            // First get the dashboard cards\n            const cardsResponse = await fetch(`${baseUrl}/api/v1/dashboard/dashboard_cards`, {\n                headers: {\n                    'Accept': 'application/json+canvas-string-ids, application/json',\n                    'X-Requested-With': 'XMLHttpRequest'\n                },\n                credentials: 'include'\n            });\n\n            if (!cardsResponse.ok) {\n                this.logger.error(`HTTP error fetching dashboard cards! status: ${cardsResponse.status}`);\n                const errorText = await cardsResponse.text();\n                this.logger.error(`Error details: ${errorText}`);\n                return [];\n            }\n            \n            const cards = await cardsResponse.json();\n            this.logger.info(`Retrieved ${cards?.length || 0} dashboard cards`);\n\n            // Then get the activity stream items which contain more recent assignments\n            const streamResponse = await fetch(`${baseUrl}/api/v1/users/self/activity_stream?only_active_courses=true`, {\n                headers: {\n                    'Accept': 'application/json',\n                    'X-Requested-With': 'XMLHttpRequest'\n                },\n                credentials: 'include'\n            });\n\n            if (!streamResponse.ok) {\n                this.logger.error(`HTTP error fetching activity stream! status: ${streamResponse.status}`);\n                return [];\n            }\n\n            const streamItems = await streamResponse.json();\n            this.logger.info(`Retrieved ${streamItems?.length || 0} activity stream items`);\n\n            const assignments: Assignment[] = [];\n\n            // Process dashboard cards\n            if (cards) {\n                for (const card of cards) {\n                    this.logger.info(`Processing card: ${card.shortName || card.courseName}`);\n                    \n                    // Get assignments from the card's upcoming_assignments\n                    if (card.upcoming_assignments) {\n                        this.logger.info(`Card has ${card.upcoming_assignments.length} upcoming assignments`);\n                        for (const assignment of card.upcoming_assignments) {\n                            try {\n                                const converted = this.convertDashboardAssignment(assignment, card);\n                                if (converted) {\n                                    this.logger.info(`Processed upcoming assignment: ${converted.title} for course ${converted.course}`);\n                                    assignments.push(converted);\n                                }\n                            } catch (error) {\n                                this.logger.error('Error processing upcoming assignment:', error);\n                            }\n                        }\n                    }\n\n                    // Get assignments from the card's published_grades\n                    if (card.published_grades) {\n                        this.logger.info(`Card has ${card.published_grades.length} published grades`);\n                        for (const grade of card.published_grades) {\n                            try {\n                                if (grade.assignment) {\n                                    const converted = this.convertDashboardAssignment(grade.assignment, card);\n                                    if (converted) {\n                                        this.logger.info(`Processed graded assignment: ${converted.title} for course ${converted.course}`);\n                                        assignments.push(converted);\n                                    }\n                                }\n                            } catch (error) {\n                                this.logger.error('Error processing graded assignment:', error);\n                            }\n                        }\n                    }\n                }\n            }\n\n            // Process activity stream items\n            if (streamItems) {\n                for (const item of streamItems) {\n                    if (item.type === 'Assignment' || item.type === 'Submission') {\n                        try {\n                            const assignment = item.assignment || item;\n                            const converted = this.convertDashboardAssignment(assignment, {\n                                shortName: item.context_name || item.course_name,\n                                id: item.course_id,\n                                contextCode: item.context_code\n                            });\n                            if (converted) {\n                                this.logger.info(`Processed stream assignment: ${converted.title} for course ${converted.course}`);\n                                assignments.push(converted);\n                            }\n                        } catch (error) {\n                            this.logger.error('Error processing stream assignment:', error);\n                        }\n                    }\n                }\n            }\n\n            // Also try to get assignments from the todo list\n            try {\n                const todoResponse = await fetch(`${baseUrl}/api/v1/users/self/todo`, {\n                    headers: {\n                        'Accept': 'application/json',\n                        'X-Requested-With': 'XMLHttpRequest'\n                    },\n                    credentials: 'include'\n                });\n\n                if (todoResponse.ok) {\n                    const todoItems = await todoResponse.json();\n                    this.logger.info(`Retrieved ${todoItems?.length || 0} todo items`);\n\n                    for (const item of todoItems) {\n                        try {\n                            if (item.assignment) {\n                                const converted = this.convertDashboardAssignment(item.assignment, {\n                                    shortName: item.context_name,\n                                    id: item.course_id,\n                                    contextCode: item.context_type\n                                });\n                                if (converted) {\n                                    this.logger.info(`Processed todo assignment: ${converted.title} for course ${converted.course}`);\n                                    assignments.push(converted);\n                                }\n                            }\n                        } catch (error) {\n                            this.logger.error('Error processing todo assignment:', error);\n                        }\n                    }\n                }\n            } catch (error) {\n                this.logger.error('Error fetching todo items:', error);\n            }\n\n            this.logger.info(`Total assignments found from dashboard: ${assignments.length}`);\n            return assignments;\n        } catch (error) {\n            this.logger.error('Error parsing dashboard cards:', error);\n            return [];\n        }\n    }\n\n    private convertPlannerItem(item: any): Assignment | null {\n        if (!item.plannable || !item.plannable_type) return null;\n\n        const type = this.determineAssignmentType(item.plannable_type);\n        if (!type || !item.plannable_date) return null;\n\n        // Try to get course name from various sources\n        let courseName = '';\n        if (item.context_name) {\n            courseName = item.context_name;\n        } else if (item.context?.name) {\n            courseName = item.context.name;\n        } else if (item.plannable?.context_name) {\n            courseName = item.plannable.context_name;\n        }\n\n        // If we still don't have a course name, try to extract from context_type\n        if (!courseName && item.context_type === 'Course' && item.course_id) {\n            courseName = `Course ${item.course_id}`;\n        }\n\n        // Ensure the assignment isn't too old\n        const dueDate = new Date(item.plannable_date);\n        const now = new Date();\n        const threeMonthsAgo = new Date();\n        threeMonthsAgo.setMonth(now.getMonth() - 3);\n\n        if (dueDate < threeMonthsAgo) {\n            this.logger.info(`Skipping old planner item: ${item.plannable?.title}, due: ${item.plannable_date}`);\n            return null;\n        }\n\n        this.logger.info(`Converting planner item: ${item.plannable?.title}, course: ${courseName}`);\n\n        const result: Assignment = {\n            id: item.plannable_id.toString(),\n            title: item.plannable?.title || item.plannable?.name || '',\n            dueDate: item.plannable_date,\n            course: courseName,\n            courseId: item.course_id?.toString(),\n            type,\n            points: item.plannable?.points_possible || item.plannable?.scoring_range?.points_possible || 0,\n            maxPoints: item.plannable?.points_possible || item.plannable?.scoring_range?.points_possible || 0,\n            completed: !!item.planner_override?.marked_complete,\n            priorityScore: 0,\n            url: item.html_url,\n            details: {\n                submissionType: item.plannable?.submission_types,\n                isCompleted: !!item.planner_override?.marked_complete,\n                isLocked: !!item.plannable?.locked_for_user,\n                description: item.plannable?.description\n            }\n        };\n\n        // Calculate priority score\n        result.priorityScore = this.priorityCalculator.calculatePriority({\n            ...result,\n            courseGrade: item.plannable?.score ? item.plannable.score / result.maxPoints : undefined\n        });\n\n        return result;\n    }\n\n    private convertMissingSubmission(submission: any): Assignment | null {\n        if (!submission.due_at) return null;\n\n        // Ensure the submission isn't too old\n        const dueDate = new Date(submission.due_at);\n        const now = new Date();\n        const threeMonthsAgo = new Date();\n        threeMonthsAgo.setMonth(now.getMonth() - 3);\n\n        if (dueDate < threeMonthsAgo) {\n            this.logger.info(`Skipping old missing submission: ${submission.name}, due: ${submission.due_at}`);\n            return null;\n        }\n\n        // Try to get course name from various sources\n        let courseName = '';\n        if (submission.course?.name) {\n            courseName = submission.course.name;\n        } else if (submission.context_name) {\n            courseName = submission.context_name;\n        } else if (submission.assignment?.course?.name) {\n            courseName = submission.assignment.course.name;\n        }\n\n        // If we still don't have a course name, try to extract from course_id\n        if (!courseName && submission.course_id) {\n            courseName = `Course ${submission.course_id}`;\n        }\n\n        this.logger.info(`Converting missing submission: ${submission.name}, course: ${courseName}`);\n\n        const result: Assignment = {\n            id: submission.id.toString(),\n            title: submission.name || submission.assignment?.name || '',\n            dueDate: submission.due_at,\n            course: courseName,\n            courseId: submission.course_id?.toString(),\n            type: 'assignment',\n            points: submission.points_possible || submission.assignment?.points_possible || 0,\n            maxPoints: submission.points_possible || submission.assignment?.points_possible || 0,\n            completed: false,\n            priorityScore: 0,\n            url: submission.html_url,\n            details: {\n                isCompleted: false,\n                isLocked: false,\n                submissionType: submission.submission_types,\n                description: submission.description || submission.assignment?.description\n            }\n        };\n\n        // Calculate priority score - missing submissions get a courseGrade of 0 to increase priority\n        result.priorityScore = this.priorityCalculator.calculatePriority({\n            ...result,\n            courseGrade: 0 // Missing submission means no grade, which should increase priority\n        });\n\n        return result;\n    }\n\n    private convertDashboardAssignment(assignment: any, card: any): Assignment | null {\n        try {\n            // Check if this is a valid assignment with a due date\n            if (!assignment || (!assignment.due_at && !assignment.due_date)) {\n                return null;\n            }\n\n            const dueDate = assignment.due_at || assignment.due_date;\n            \n            // Filter out old assignments\n            const now = new Date();\n            const oneWeekAgo = new Date();\n            oneWeekAgo.setDate(now.getDate() - 7);\n            \n            const assignmentDate = new Date(dueDate);\n            if (assignmentDate < oneWeekAgo) {\n                this.logger.info(`Skipping old dashboard assignment: ${assignment.name || assignment.title}, due: ${dueDate}`);\n                return null;\n            }\n\n            const type = this.determineAssignmentType(assignment.type || assignment.submission_types?.[0] || 'assignment');\n            \n            // Try to get course name from various sources\n            let courseName = '';\n            if (card.shortName) {\n                courseName = card.shortName;\n            } else if (card.courseName) {\n                courseName = card.courseName;\n            } else if (card.contextName) {\n                courseName = card.contextName;\n            } else if (assignment.contextName) {\n                courseName = assignment.contextName;\n            } else if (assignment.course_name) {\n                courseName = assignment.course_name;\n            }\n\n            // If we still don't have a course name, try to extract from context_code or URL\n            if (!courseName) {\n                if (card.contextCode) {\n                    const contextMatch = card.contextCode.match(/course_(\\d+)/i);\n                    if (contextMatch) {\n                        courseName = `Course ${contextMatch[1]}`;\n                    }\n                } else if (assignment.html_url) {\n                    const urlMatch = assignment.html_url.match(/courses\\/(\\d+)/);\n                    if (urlMatch) {\n                        courseName = `Course ${urlMatch[1]}`;\n                    }\n                }\n            }\n\n            // Extract points from various sources\n            let points = 0;\n            \n            // First try direct points_possible\n            if (assignment.points_possible !== undefined && assignment.points_possible !== null) {\n                points = parseFloat(assignment.points_possible);\n            }\n            \n            // Then try assignment details\n            if (points === 0 && assignment.assignment) {\n                if (assignment.assignment.points_possible !== undefined && assignment.assignment.points_possible !== null) {\n                    points = parseFloat(assignment.assignment.points_possible);\n                }\n            }\n            \n            // Try score or grade\n            if (points === 0) {\n                if (assignment.score !== undefined && assignment.score !== null) {\n                    points = parseFloat(assignment.score);\n                } else if (assignment.grade !== undefined && assignment.grade !== null) {\n                    const numericGrade = parseFloat(assignment.grade);\n                    if (!isNaN(numericGrade)) {\n                        points = numericGrade;\n                    }\n                }\n            }\n\n            // Try todo item points\n            if (points === 0 && assignment.todo) {\n                if (assignment.todo.points_possible !== undefined && assignment.todo.points_possible !== null) {\n                    points = parseFloat(assignment.todo.points_possible);\n                }\n            }\n\n            // Try grading details\n            if (points === 0 && assignment.grading) {\n                if (assignment.grading.points_possible !== undefined && assignment.grading.points_possible !== null) {\n                    points = parseFloat(assignment.grading.points_possible);\n                }\n            }\n\n            this.logger.info(`Points for ${assignment.name || assignment.title}: ${points} (from ${Object.keys({\n                direct: assignment.points_possible,\n                assignment: assignment.assignment?.points_possible,\n                score: assignment.score,\n                grade: assignment.grade,\n                todo: assignment.todo?.points_possible,\n                grading: assignment.grading?.points_possible\n            }).find(key => assignment[key]?.points_possible !== undefined || assignment[key] !== undefined) || 'unknown'})`);\n\n            // Determine completion status\n            const completed = !!assignment.has_submitted_submissions ||\n                             !!assignment.submitted ||\n                             !!assignment.submission?.submitted ||\n                             assignment.submission?.workflow_state === 'submitted';\n\n            this.logger.info(`Converting dashboard assignment: ${assignment.name || assignment.title}, course: ${courseName}, due: ${dueDate}`);\n            \n            const result: Assignment = {\n                id: assignment.id?.toString() || `${courseName}-${assignment.name}-${dueDate}`,\n                title: assignment.name || assignment.title || '',\n                dueDate: dueDate,\n                course: courseName,\n                courseId: card.id?.toString() || assignment.course_id?.toString(),\n                type,\n                points: points,\n                maxPoints: points,\n                completed: completed,\n                url: assignment.html_url || assignment.url,\n                priorityScore: 0, // Default value before calculation\n                details: {\n                    submissionType: assignment.submission_types || [type],\n                    isCompleted: completed,\n                    isLocked: !!assignment.locked_for_user || !!assignment.locked,\n                    description: assignment.description || assignment.body\n                }\n            };\n\n            // Calculate and update priority score\n            result.priorityScore = this.priorityCalculator.calculatePriority({\n                ...result,\n                courseGrade: assignment.score ? assignment.score / points : undefined\n            });\n\n            this.logger.info(`Assignment points: ${result.points}, maxPoints: ${result.maxPoints}, priority: ${result.priorityScore}`);\n            return result;\n        } catch (error) {\n            this.logger.error('Error converting dashboard assignment:', error);\n            return null;\n        }\n    }\n\n    private determineAssignmentType(type: string): AssignmentType {\n        switch (type.toLowerCase()) {\n            case 'quiz':\n            case 'quizzes/quiz':\n                return 'quiz';\n            case 'discussion_topic':\n                return 'discussion';\n            case 'announcement':\n                return 'announcement';\n            default:\n                return 'assignment';\n        }\n    }\n\n    private isValidAssignment(assignment: Assignment | null): assignment is Assignment {\n        if (!assignment) return false;\n        \n        // Check required fields\n        if (!assignment.title || !assignment.dueDate) {\n            this.logger.info(`Invalid assignment - missing title or due date: ${assignment?.title}`);\n            return false;\n        }\n        \n        // Filter out old assignments and far future assignments\n        const dueDate = new Date(assignment.dueDate);\n        const now = new Date();\n        \n        // Show assignments from up to 1 week ago\n        const oneWeekAgo = new Date();\n        oneWeekAgo.setDate(now.getDate() - 7);\n        \n        // And up to 3 months in the future\n        const threeMonthsFuture = new Date();\n        threeMonthsFuture.setMonth(now.getMonth() + 3);\n        \n        if (dueDate < oneWeekAgo) {\n            this.logger.info(`Filtering out old assignment: ${assignment.title}, due: ${assignment.dueDate}`);\n            return false;\n        }\n        \n        if (dueDate > threeMonthsFuture) {\n            this.logger.info(`Filtering out far future assignment: ${assignment.title}, due: ${assignment.dueDate}`);\n            return false;\n        }\n\n        // Ensure course name is set\n        if (!assignment.course || assignment.course === 'undefined') {\n            // Try to extract course name from title\n            const courseMatch = assignment.title.match(/^([A-Z]{2,4}\\s*\\d{4})/);\n            if (courseMatch) {\n                assignment.course = courseMatch[1];\n                this.logger.info(`Extracted course name from title: ${assignment.course}`);\n            } else if (assignment.courseId) {\n                assignment.course = `Course ${assignment.courseId}`;\n                this.logger.info(`Using course ID as name: ${assignment.course}`);\n            } else {\n                // Try to extract from URL\n                const urlMatch = assignment.url?.match(/\\/courses\\/(\\d+)/);\n                if (urlMatch) {\n                    assignment.course = `Course ${urlMatch[1]}`;\n                    this.logger.info(`Extracted course from URL: ${assignment.course}`);\n                } else {\n                    this.logger.warn(`Missing course name for assignment: ${assignment.title}`);\n                    assignment.course = 'Unknown Course';\n                }\n            }\n        }\n\n        this.logger.info(`Valid assignment found: ${assignment.title} for ${assignment.course}, due: ${assignment.dueDate}`);\n        return true;\n    }\n}","console.log('CanvasPal content script loaded');\n\nimport { initializeButton } from './canvasButton';\nimport { AssignmentDetector } from '../utils/assignmentDetector';\n\n// Initialize the extension\nconst initialize = async () => {\n    try {\n        console.log('Initializing CanvasPal extension');\n\n        // Initialize button and popup\n        initializeButton();\n\n        // Initialize assignment detector\n        const detector = new AssignmentDetector();\n        \n        // Detect assignments and send to background script\n        const assignments = await detector.detectAssignments();\n        console.log('Detected assignments:', assignments);\n        \n        // Send assignments to background script\n        chrome.runtime.sendMessage({\n            type: 'DASHBOARD_DATA',\n            data: assignments.map(assignment => ({\n                courseName: assignment.course,\n                id: assignment.courseId,\n                assignments: [{\n                    name: assignment.title,\n                    dueDate: assignment.dueDate,\n                    type: assignment.type,\n                    points: assignment.points,\n                    maxPoints: assignment.maxPoints,\n                    completed: assignment.completed,\n                    url: assignment.url,\n                    submissionType: assignment.details?.submissionType,\n                    description: assignment.details?.description,\n                    locked: assignment.details?.isLocked,\n                    priorityScore: assignment.priorityScore,\n                    priorityDetails: assignment.priorityDetails\n                }]\n            })),\n            gradeData: {\n                assignments: assignments.map(assignment => ({\n                    name: assignment.title,\n                    points: assignment.points,\n                    pointsPossible: assignment.maxPoints,\n                    weight: assignment.gradeWeight\n                }))\n            }\n        });\n\n    } catch (error) {\n        console.error('Error initializing CanvasPal:', error);\n    }\n};\n\n// Start initialization when DOM is ready\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', initialize);\n} else {\n    initialize();\n}\n"],"names":["updateAssignmentsList","assignments","assignmentList","taskCount","console","log","textContent","length","innerHTML","map","assignment","score","priorityScore","title","Date","dueDate","toLocaleString","course","undefined","points","maxPoints","join","error","LogLevel","Logger","context","level","INFO","this","currentLevel","cleanOldLogs","getInstance","key","instances","has","set","get","setLevel","debug","message","data","DEBUG","info","warn","WARN","ERROR","args","timestamp","toISOString","formattedMessage","getLogPrefix","formattedData","formatLogData","entry","stack","Error","saveLogs","notifyError","Array","isArray","item","name","formatted","value","Object","entries","logs","chrome","storage","local","push","MAX_LOGS","splice","thirtyDaysAgo","setDate","getDate","filteredLogs","filter","notifications","create","type","iconUrl","priority","getLogs","Map","PerformanceMonitor","metrics","logger","instance","startMetric","metadata","id","now","startTime","performance","endMetric","metric","find","m","endTime","duration","toFixed","getReport","completedMetrics","summary","totalDuration","averageDuration","slowestOperation","fastestOperation","reduce","sum","sorted","sort","a","b","clear","monitorAsync","fn","finally","monitor","result","DebugPanel","constructor","debugManager","panel","isVisible","performanceMonitor","initializeKeyboardShortcut","createPanel","initPanel","document","body","requestAnimationFrame","createElement","style","cssText","head","appendChild","addEventListener","getElementById","toggleVisibility","updatePerformanceMetrics","readyState","e","isDebugEnabled","ctrlKey","metaKey","shiftKey","preventDefault","display","parentNode","removeChild","metricsContainer","report","slice","getMetricSpeedClass","updateAssignmentInfo","container","typeCounts","getAssignmentTypeCounts","priorityRanges","getPriorityRanges","renderTypeCounts","renderPriorityDistribution","renderAssignmentList","acc","high","medium","low","counts","count","ranges","colors","range","renderAssignmentDetail","priorityColor","formatDate","Math","round","logDetectionEvent","date","dateStr","startsWith","substring","dateObj","isNaN","getTime","toLocaleDateString","month","day","year","updatePerformanceAnalysis","analysis","DateDebugPanel","header","content","updateDebugInfo","totalDates","renderTypeDistribution","types","renderDetections","detections","due","availability","unlock","unknown","charAt","toUpperCase","detection","text","element","logDateDetection","DateDebugger","debugPanel","injectDebugStyles","styleElement","DATE_DEBUG_STYLES","highlightDates","dateMatches","querySelectorAll","forEach","match","processDateElement","applyDebugHighlight","textMatches","findDatesInTextNodes","updateDebugPanel","matches","walker","createTreeWalker","NodeFilter","SHOW_TEXT","acceptNode","node","parentElement","closest","FILTER_REJECT","containsDatePattern","FILTER_ACCEPT","nextNode","findDatesInText","debugInfo","getElementDescription","getDebugLabel","tagName","toLowerCase","from","classList","cls","includes","getAttribute","parseDate","determineDateType","pattern","regex","RegExp","exec","span","splitText","index","replaceChild","normalized","tomorrow","yesterday","formats","format","parsed","add","setAttribute","test","PriorityCalculator","PRIORITY_WEIGHTS","GRADE_IMPACT","COURSE_GRADE","DUE_DATE","TYPE_WEIGHTS","exam","quiz","discussion","announcement","calculatePriority","daysUntilDue","calculateDaysUntilDue","gradeImpact","calculateGradeImpact","courseGradeImpact","calculateCourseGradeImpact","typeWeight","getTypeWeight","components","gradeComponent","courseComponent","dateComponent","calculateDueDatePriority","priorityDetails","dueStatus","getDueStatus","pointsImpact","getPointsImpact","typeImportance","getTypeImportance","dueDateScore","gradeImpactScore","typeScore","finalPriority","min","max","assignmentTitle","dueDateObj","diffTime","ceil","impact","gradeWeight","courseGrade","lowerTitle","setPriorityWeights","weights","totalWeight","abs","assign","AssignmentDetector","dateDebugger","priorityCalculator","async","detectAssignments","window","location","hostname","totalElements","dueDates","allAssignments","plannerItems","missingSubmissions","dashboardItems","Promise","all","fetchPlannerItems","fetchMissingSubmissions","parseDashboardCards","isValidAssignment","validateAssignmentDates","assignmentCount","performanceReport","totalAssignments","matchingDateElements","matchDate","assignmentDate","matchingElements","dateMatchCount","baseUrl","origin","response","fetch","headers","credentials","ok","status","errorText","items","json","convertPlannerItem","submissions","submission","convertMissingSubmission","cardsResponse","cards","streamResponse","streamItems","card","shortName","courseName","upcoming_assignments","converted","convertDashboardAssignment","published_grades","grade","context_name","course_name","course_id","contextCode","context_code","todoResponse","todoItems","context_type","plannable","plannable_type","determineAssignmentType","plannable_date","threeMonthsAgo","setMonth","getMonth","plannable_id","toString","courseId","points_possible","scoring_range","completed","planner_override","marked_complete","url","html_url","details","submissionType","submission_types","isCompleted","isLocked","locked_for_user","description","due_at","due_date","oneWeekAgo","contextName","contextMatch","urlMatch","parseFloat","numericGrade","todo","grading","keys","direct","has_submitted_submissions","submitted","workflow_state","locked","threeMonthsFuture","courseMatch","initialize","isCanvasPage","href","elements","runtime","styleSheet","button","className","toggleContainer","popup","settingsButton","querySelector","settingsUrl","getURL","open","createElements","settings","displayOptions","showOutsideCanvas","checkbox","checked","toggle","target","contains","remove","onMessage","addListener","sendMessage","initializeButton","detector","gradeData","pointsPossible","weight"],"sourceRoot":""}