{"version":3,"file":"contentScript/index.js","mappings":"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","sources":["webpack://canvaspal/./src/contentScript/canvasButton.ts","webpack://canvaspal/./src/utils/logger.ts","webpack://canvaspal/./src/utils/performanceMonitor.ts","webpack://canvaspal/./src/utils/debugPanel.ts","webpack://canvaspal/./src/utils/dateDebugPanel.ts","webpack://canvaspal/./src/utils/dateDebugger.ts","webpack://canvaspal/./src/utils/priorityCalculator.ts","webpack://canvaspal/./src/utils/assignmentDetector.ts","webpack://canvaspal/./src/contentScript/index.ts"],"sourcesContent":["// Types\ninterface Elements {\n    button: HTMLElement;\n    toggleContainer: HTMLElement;\n    popup: HTMLElement;\n}\n\ninterface Assignment {\n    title: string;\n    dueDate: string;\n    course: string;\n    points?: number;\n    maxPoints?: number;\n    priorityScore: number;\n}\n\ninterface Settings {\n    displayOptions?: {\n        showOutsideCanvas?: boolean;\n    };\n}\n\n// Helper functions\nconst getPriorityClass = (score: number): string => {\n    if (score >= 0.7) return 'high-priority';\n    if (score >= 0.4) return 'medium-priority';\n    return 'low-priority';\n};\n\nconst updateAssignmentsList = (assignments: Assignment[], assignmentList: HTMLElement, taskCount: HTMLElement): void => {\n    try {\n        console.log('Updating assignments list:', assignments);\n        taskCount.textContent = `${assignments.length} Tasks`;\n        assignmentList.innerHTML = assignments.map(assignment => `\n            <div class=\"assignment-item ${getPriorityClass(assignment.priorityScore)}\">\n                <div style=\"font-weight: bold;\">${assignment.title}</div>\n                <div>Due: ${new Date(assignment.dueDate).toLocaleString()}</div>\n                <div>Course: ${assignment.course}</div>\n                <div>Points: ${assignment.points !== undefined ? assignment.points : (assignment.maxPoints || 0)}</div>\n            </div>\n        `).join('');\n    } catch (error) {\n        console.error('Error updating assignments list:', error);\n    }\n};\n\nconst handleAssignmentUpdates = (button: HTMLElement, message: any): void => {\n    try {\n        console.log('Received message:', message);\n        if (message.type === 'ASSIGNMENTS_UPDATE') {\n            button.textContent = message.data.length.toString();\n            button.classList.toggle('has-assignments', message.data.length > 0);\n\n            const assignmentList = document.getElementById('assignmentList');\n            const taskCount = document.getElementById('taskCount');\n            \n            if (assignmentList && taskCount) {\n                updateAssignmentsList(message.data, assignmentList, taskCount);\n            }\n        } else if (message.type === 'REFRESH_ASSIGNMENTS') {\n            chrome.runtime.sendMessage({ type: 'GET_ASSIGNMENTS' });\n        }\n    } catch (error) {\n        console.error('Error handling message:', error);\n    }\n};\n\nconst setupEventListeners = (\n    button: HTMLElement,\n    popup: HTMLElement,\n    toggleContainer: HTMLElement,\n    isCanvasPage: boolean\n): void => {\n    // Handle button click\n    button.addEventListener('click', () => {\n        popup.classList.toggle('show');\n    });\n\n    // Handle toggle change\n    const checkbox = document.getElementById('canvas-pal-visibility');\n    checkbox?.addEventListener('change', (e) => {\n        const target = e.target as HTMLInputElement;\n        if (chrome?.storage?.local) {\n            chrome.storage.local.get('settings', (data) => {\n                try {\n                    const settings = data.settings || { displayOptions: {} };\n                    if (!settings.displayOptions) settings.displayOptions = {};\n                    settings.displayOptions.showOutsideCanvas = target.checked;\n                    chrome.storage.local.set({ settings });\n                    \n                    // Update button visibility\n                    if (!isCanvasPage) {\n                        button.style.display = target.checked ? 'flex' : 'none';\n                    }\n                } catch (error) {\n                    console.error('Error updating settings:', error);\n                }\n            });\n        }\n    });\n\n    // Close popup when clicking outside\n    document.addEventListener('click', (e) => {\n        const target = e.target as HTMLElement;\n        if (!popup.contains(target) && !button.contains(target)) {\n            popup.classList.remove('show');\n        }\n    });\n\n    // Handle assignment updates\n    if (chrome?.runtime) {\n        chrome.runtime.onMessage.addListener((message) => handleAssignmentUpdates(button, message));\n\n        // Get initial assignments\n        console.log('Requesting initial assignments');\n        chrome.runtime.sendMessage({ type: 'GET_ASSIGNMENTS' }, (response) => {\n            try {\n                console.log('Received initial assignments:', response);\n                if (response?.assignments) {\n                    handleAssignmentUpdates(button, {\n                        type: 'ASSIGNMENTS_UPDATE',\n                        data: response.assignments\n                    });\n                }\n            } catch (error) {\n                console.error('Error getting initial assignments:', error);\n            }\n        });\n    }\n};\n\nconst createElements = async (): Promise<Elements | null> => {\n    try {\n        console.log('Creating CanvasPal elements');\n        \n        // Ensure we have access to chrome APIs\n        if (!chrome?.runtime) {\n            throw new Error('Chrome APIs not available');\n        }\n\n        // Create and inject styles\n        const styleSheet = document.createElement('style');\n        styleSheet.textContent = `\n            .canvas-pal-button {\n                position: fixed;\n                right: 20px;\n                top: 20px;\n                width: 44px;\n                height: 44px;\n                border-radius: 50%;\n                background: #0066CC;\n                color: white;\n                border: none;\n                font-size: 16px;\n                font-weight: 600;\n                cursor: pointer;\n                z-index: 2147483647;\n                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                backdrop-filter: blur(8px);\n            }\n\n            .canvas-pal-button:hover {\n                transform: translateY(-2px);\n                background: #0056b3;\n                box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n            }\n\n            .canvas-pal-button.has-assignments {\n                animation: canvas-pal-pulse 2s infinite;\n            }\n\n            @keyframes canvas-pal-pulse {\n                0% { transform: scale(1); }\n                50% { transform: scale(1.05); }\n                100% { transform: scale(1); }\n            }\n\n            .canvas-pal-toggle {\n                position: fixed;\n                top: 20px;\n                right: 70px;\n                z-index: 2147483647;\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                background: rgba(255, 255, 255, 0.9);\n                padding: 6px 12px;\n                border-radius: 20px;\n                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n                font-family: 'Lato', sans-serif;\n                font-size: 12px;\n            }\n\n            .canvas-pal-toggle input {\n                margin: 0;\n                cursor: pointer;\n            }\n\n            .popup-container {\n                position: fixed;\n                right: 20px;\n                top: 75px;\n                width: 350px;\n                min-height: 400px;\n                background: #f9f9f9;\n                border: 2px solid #000;\n                z-index: 2147483646;\n                display: none;\n                font-family: 'Lato', sans-serif;\n            }\n\n            .popup-container.show {\n                display: block;\n            }\n\n            .popup-header {\n                display: flex;\n                align-items: center;\n                justify-content: space-between;\n                background-color: #0066CC;\n                color: white;\n                padding: 12px;\n                position: relative;\n                border-bottom: 1px solid #666;\n                margin-bottom: 16px;\n            }\n\n            .popup-title {\n                flex-grow: 1;\n                text-align: center;\n                margin: 0;\n                font-size: 2.3em;\n                color: #FFFFFF;\n                font-family: 'Lato', sans-serif;\n            }\n\n            .task-count {\n                position: absolute;\n                bottom: 8px;\n                left: 9px;\n                font-size: .7em;\n                color: #FFFFFF;\n                font-family: 'Lato', sans-serif;\n            }\n\n            .logo {\n                margin-left: 16px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                width: 32px;\n                height: 32px;\n            }\n\n            .logo-image {\n                width: 0px;\n                height: 0px;\n                border-radius: 4px;\n                border: 1px solid #FFFFFF;\n                padding: 2px;\n                background: white;\n                object-fit: contain;\n            }\n\n            @media (prefers-color-scheme: dark) {\n                .logo-image {\n                    background: transparent;\n                    border-color: rgba(255, 255, 255, 0.8);\n                }\n            }\n\n            .assignments-list {\n                max-height: 300px;\n                overflow-y: auto;\n                padding: 16px;\n            }\n\n            .assignment-item {\n                padding: 12px;\n                border: 1px solid #eee;\n                margin-bottom: 8px;\n                border-radius: 4px;\n                background: white;\n            }\n\n            .assignment-item.high-priority {\n                border-left: 4px solid #d92b2b;\n            }\n\n            .assignment-item.medium-priority {\n                border-left: 4px solid #f0ad4e;\n            }\n\n            .assignment-item.low-priority {\n                border-left: 4px solid #5cb85c;\n            }\n\n            .settings-button {\n                bottom: 16px;\n                right: 16px;\n                position: absolute;\n                text-align: center;\n            }\n\n            .settings-button button {\n                background-color: #0066CC;\n                color: white;\n                padding: 10px 20px;\n                border-radius: 8px;\n                border: none;\n                transition: background-color 0.3s, transform 0.3s;\n                font-family: 'Lato', sans-serif;\n                cursor: pointer;\n                font-size: 14px;\n                font-weight: 500;\n            }\n\n            .settings-button button:hover {\n                background-color: #0056b3;\n                transform: scale(1.08);\n            }\n\n            @media (prefers-color-scheme: dark) {\n                .popup-container {\n                    background: #1c1c1e;\n                    border-color: #666;\n                }\n\n                .assignment-item {\n                    background: #2c2c2e;\n                    border-color: #666;\n                    color: white;\n                }\n\n                .logo img {\n                    background: transparent;\n                }\n\n                .canvas-pal-toggle {\n                    background: rgba(45, 59, 69, 0.9);\n                    color: white;\n                }\n            }\n        `;\n        document.head.appendChild(styleSheet);\n\n        // Create button\n        const button = document.createElement('button');\n        button.className = 'canvas-pal-button';\n        button.textContent = '0';\n        document.body.appendChild(button);\n\n        // Create toggle for non-Canvas pages\n        const toggleContainer = document.createElement('div');\n        toggleContainer.className = 'canvas-pal-toggle';\n        toggleContainer.innerHTML = `\n            <label>\n                <input type=\"checkbox\" id=\"canvas-pal-visibility\" checked>\n                <span>Follow Outside Canvas</span>\n            </label>\n        `;\n        document.body.appendChild(toggleContainer);\n\n        // Create popup container\n        const popup = document.createElement('div');\n        popup.className = 'popup-container';\n        \n        try {\n            // Create popup structure first\n            console.log('Debug: Creating popup HTML structure');\n            popup.innerHTML = `\n                <div class=\"popup-header\">\n                    <div class=\"popup-title\">CanvasPAL</div>\n                    <div class=\"task-count\" id=\"taskCount\">0 Tasks</div>\n                    <div class=\"logo\">\n                        <img id=\"canvaspal-logo\" alt=\"CanvasPAL Logo\" class=\"logo-image\" width=\"24\" height=\"24\" />\n                    </div>\n                </div>\n                <div class=\"assignments-list\" id=\"assignmentList\">\n                    <!-- Assignments will be populated here -->\n                </div>\n                <div class=\"settings-button\">\n                    <button id=\"settings-button\">Settings</button>\n                </div>\n            `;\n\n            // Create popup structure with embedded icon\n            console.log('Debug: Creating popup HTML structure');\n            popup.innerHTML = `\n                <div class=\"popup-header\">\n                    <div class=\"popup-title\">CanvasPAL</div>\n                    <div class=\"task-count\" id=\"taskCount\">0 Tasks</div>\n                    <div class=\"logo\">\n                        <img id=\"canvaspal-logo\"\n                             alt=\"CanvasPAL Logo\"\n                             class=\"logo-image\"\n                             width=\"24\"\n                             height=\"24\"\n                             src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF0WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNy4yLWMwMDAgNzkuMWI2NWE3OWI0LCAyMDIyLzA2LzEzLTIyOjAxOjAxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjQuMCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjMtMDItMjNUMTU6NTc6MjUtMDU6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjMtMDItMjNUMTU6NTc6MjUtMDU6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIzLTAyLTIzVDE1OjU3OjI1LTA1OjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjA1ZTg5ZjQwLTk2ZDgtNDJhZC1hNmE2LTNmODhhNzJhYzhjYyIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjA1ZTg5ZjQwLTk2ZDgtNDJhZC1hNmE2LTNmODhhNzJhYzhjYyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjA1ZTg5ZjQwLTk2ZDgtNDJhZC1hNmE2LTNmODhhNzJhYzhjYyIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjA1ZTg5ZjQwLTk2ZDgtNDJhZC1hNmE2LTNmODhhNzJhYzhjYyIgc3RFdnQ6d2hlbj0iMjAyMy0wMi0yM1QxNTo1NzoyNS0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI0LjAgKE1hY2ludG9zaCkiLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+YcP6EAAAASpJREFUOI2Vkk9Kw0AYxd+kSZqW0kKhFBE8gAvBQ7h24cqtK8FzuHblMTyAC0/gwoWg4MJSaNM0zZ/vG1xpk0zS+sEwzMB7v5n53gwxxvA/6B8XQhAA0DTtJyGEGGPYsqzper2+1XX9TJKkvmmafdd1ryRFUc6llM+2bT/KstwDgPF4/AEA0+n0EwA8z7sNguBuNBrdA0Cv1zsZDAYPhULhDAAMw7jQdf1S07RzAEiSJFoul/eyLJ+qqnoSx/FbGIaPQRB8z+fzt8Vi8RWG4YthGM+SJF3PZrNxkiQRAFBK6Wg0+gQA0zTfCSHUdd0rAHAc55YQgqIo3lNKEUXR42QyeQKAOI6RZRmyLEOe50jTFFmWIU1TUEqRpinSNEWSJKCUYrvdIkkSEEJAKQX+xDcZtYM1GmhGrgAAAABJRU5ErkJggg==\" />\n                    </div>\n                </div>\n                <div class=\"assignments-list\" id=\"assignmentList\">\n                    <!-- Assignments will be populated here -->\n                </div>\n                <div class=\"settings-button\">\n                    <button id=\"settings-button\">Settings</button>\n                </div>\n            `;\n\n            // Add load and error handlers for the icon\n            const logoImg = popup.querySelector('#canvaspal-logo') as HTMLImageElement;\n            if (logoImg) {\n                logoImg.onload = () => {\n                    console.log('Debug: Logo image loaded successfully');\n                    console.log('Debug: Logo image properties:', {\n                        width: logoImg.width,\n                        height: logoImg.height,\n                        complete: logoImg.complete,\n                        naturalWidth: logoImg.naturalWidth,\n                        naturalHeight: logoImg.naturalHeight\n                    });\n                };\n                logoImg.onerror = (error) => {\n                    console.error('Debug: Logo image failed to load:', error);\n                };\n            } else {\n                console.error('Debug: Logo image element not found in popup');\n            }\n        } catch (error) {\n            console.error('Debug: Error setting up popup content:', error);\n        }\n\n        document.body.appendChild(popup);\n\n        // Add settings button click handler\n        const settingsButton = popup.querySelector('#settings-button');\n        if (settingsButton) {\n            settingsButton.addEventListener('click', () => {\n                console.log('Settings button clicked');\n                try {\n                    chrome.runtime.sendMessage({ type: 'OPEN_OPTIONS_PAGE' }, (response) => {\n                        if (!response?.success) {\n                            console.error('Failed to open settings page');\n                        }\n                    });\n                } catch (error) {\n                    console.error('Error opening settings:', error);\n                }\n            });\n        }\n\n        return { button, toggleContainer, popup };\n    } catch (error) {\n        console.error('Error creating elements:', error);\n        return null;\n    }\n};\n\nexport const initializeButton = async (): Promise<void> => {\n    try {\n        console.log('Initializing CanvasPal button');\n        const isCanvasPage = window.location.href.includes('.instructure.com');\n        const elements = await createElements();\n        \n        if (!elements) {\n            console.error('Failed to create elements');\n            return;\n        }\n\n        const { button, toggleContainer, popup } = elements;\n\n        // Show/hide toggle based on page type\n        toggleContainer.style.display = isCanvasPage ? 'flex' : 'none';\n\n        // Initialize visibility from settings\n        if (chrome?.storage?.local) {\n            chrome.storage.local.get('settings', (data) => {\n                try {\n                    const settings = data.settings || { displayOptions: { showOutsideCanvas: true } };\n                    const showOutsideCanvas = settings.displayOptions?.showOutsideCanvas ?? true;\n                    \n                    // Update checkbox state\n                    const checkbox = document.getElementById('canvas-pal-visibility') as HTMLInputElement;\n                    if (checkbox) {\n                        checkbox.checked = showOutsideCanvas;\n                    }\n\n                    // Update button visibility\n                    if (!isCanvasPage) {\n                        button.style.display = showOutsideCanvas ? 'flex' : 'none';\n                    }\n                } catch (error) {\n                    console.error('Error handling settings:', error);\n                }\n            });\n        }\n\n        setupEventListeners(button, popup, toggleContainer, isCanvasPage);\n    } catch (error) {\n        console.error('Error initializing button:', error);\n    }\n};\n","export enum LogLevel {\n    DEBUG = 0,\n    INFO = 1,\n    WARN = 2,\n    ERROR = 3\n}\n\ninterface LogEntry {\n    timestamp: string;\n    level: LogLevel;\n    message: string;\n    data?: any;\n    stack?: string;\n}\n\nexport class Logger {\n    private static readonly MAX_LOGS = 1000;\n    private static instances: Map<string, Logger> = new Map();\n    private context: string;\n    private currentLevel: LogLevel;\n\n    public constructor(context: string, level: LogLevel = LogLevel.INFO) {\n        this.context = context;\n        this.currentLevel = level;\n        this.cleanOldLogs();\n    }\n\n    public static getInstance(context: string, level: LogLevel = LogLevel.INFO): Logger {\n        const key = `${context}-${level}`;\n        if (!this.instances.has(key)) {\n            this.instances.set(key, new Logger(context, level));\n        }\n        return this.instances.get(key)!;\n    }\n\n    setLevel(level: LogLevel): void {\n        this.currentLevel = level;\n    }\n\n    debug(message: string, data?: any): void {\n        this.log(LogLevel.DEBUG, message, data);\n    }\n\n    info(message: string, data?: any): void {\n        this.log(LogLevel.INFO, message, data);\n    }\n\n    warn(message: string, data?: any): void {\n        this.log(LogLevel.WARN, message, data);\n    }\n\n    error(message: string, data?: any): void {\n        this.log(LogLevel.ERROR, message, data);\n    }\n\n    public async log(level: LogLevel, message: string, ...args: any[]): Promise<void> {\n        if (level >= this.currentLevel) {\n            const timestamp = new Date().toISOString();\n            const prefix = this.getLogPrefix(level);\n            const formattedMessage = `[${timestamp}] ${prefix} [${this.context}] ${message}`;\n\n            if (args.length) {\n                const formattedData = this.formatLogData(args);\n                console.log(formattedMessage, formattedData);\n            } else {\n                console.log(formattedMessage);\n            }\n\n            const entry: LogEntry = {\n                timestamp,\n                level,\n                message,\n                data: args,\n                stack: Error().stack\n            };\n\n            this.saveLogs(entry);\n\n            if (level === LogLevel.ERROR) {\n                this.notifyError(entry);\n            }\n        }\n    }\n\n    private getLogPrefix(level: LogLevel): string {\n        switch (level) {\n            case LogLevel.DEBUG:\n                return '🔍 DEBUG:';\n            case LogLevel.INFO:\n                return '📢 INFO:';\n            case LogLevel.WARN:\n                return '⚠️ WARN:';\n            case LogLevel.ERROR:\n                return '❌ ERROR:';\n            default:\n                return '📢';\n        }\n    }\n\n    private formatLogData(data: any): any {\n        try {\n            if (Array.isArray(data)) {\n                return data.map(item => this.formatLogData(item));\n            }\n\n            if (data && typeof data === 'object') {\n                // Check if it's an Error object\n                if (data instanceof Error) {\n                    return {\n                        name: data.name,\n                        message: data.message,\n                        stack: data.stack\n                    };\n                }\n\n                // Handle regular objects\n                const formatted: Record<string, any> = {};\n                for (const [key, value] of Object.entries(data)) {\n                    formatted[key] = this.formatLogData(value);\n                }\n                return formatted;\n            }\n\n            return data;\n        } catch (error) {\n            return '[Error formatting log data]';\n        }\n    }\n\n    private async saveLogs(entry: LogEntry): Promise<void> {\n        const { logs = [] } = await chrome.storage.local.get('logs');\n        logs.push(entry);\n\n        if (logs.length > Logger.MAX_LOGS) {\n            logs.splice(0, logs.length - Logger.MAX_LOGS);\n        }\n\n        await chrome.storage.local.set({ logs });\n    }\n\n    private async cleanOldLogs(): Promise<void> {\n        const { logs = [] } = await chrome.storage.local.get('logs');\n        const thirtyDaysAgo = new Date();\n        thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n\n        const filteredLogs = logs.filter((log: LogEntry) => \n            new Date(log.timestamp) > thirtyDaysAgo\n        );\n\n        await chrome.storage.local.set({ logs: filteredLogs });\n    }\n\n    private notifyError(entry: LogEntry): void {\n        chrome.notifications.create({\n            type: 'basic',\n            iconUrl: '/dist/icons/icon128.png',\n            title: 'CanvasPal Error',\n            message: entry.message,\n            priority: 2\n        });\n    }\n\n    async getLogs(level?: LogLevel): Promise<LogEntry[]> {\n        const { logs = [] } = await chrome.storage.local.get('logs');\n        return level ? logs.filter((log: LogEntry) => log.level === level) : logs;\n    }\n}\n\nexport const logger = Logger.getInstance('default');\n","import { Logger } from './logger';\n\ninterface PerformanceMetric {\n    name: string;\n    startTime: number;\n    endTime?: number;\n    duration?: number;\n    metadata?: Record<string, any>;\n}\n\ninterface PerformanceReport {\n    metrics: PerformanceMetric[];\n    summary: {\n        totalDuration: number;\n        averageDuration: number;\n        slowestOperation: {\n            name: string;\n            duration: number;\n        };\n        fastestOperation: {\n            name: string;\n            duration: number;\n        };\n    };\n}\n\nexport class PerformanceMonitor {\n    private metrics: PerformanceMetric[] = [];\n    private logger: Logger;\n    private static instance: PerformanceMonitor;\n\n    private constructor() {\n        this.logger = new Logger('PerformanceMonitor');\n    }\n\n    public static getInstance(): PerformanceMonitor {\n        if (!PerformanceMonitor.instance) {\n            PerformanceMonitor.instance = new PerformanceMonitor();\n        }\n        return PerformanceMonitor.instance;\n    }\n\n    public startMetric(name: string, metadata?: Record<string, any>): string {\n        const id = `${name}_${Date.now()}`;\n        this.metrics.push({\n            name,\n            startTime: performance.now(),\n            metadata\n        });\n        return id;\n    }\n\n    public endMetric(name: string): void {\n        const metric = this.metrics.find(m => m.name === name && !m.endTime);\n        if (metric) {\n            metric.endTime = performance.now();\n            metric.duration = metric.endTime - metric.startTime;\n            this.logger.debug(`Performance metric - ${name}:`, {\n                duration: `${metric.duration.toFixed(2)}ms`,\n                metadata: metric.metadata\n            });\n        }\n    }\n\n    public getReport(): PerformanceReport {\n        const completedMetrics = this.metrics.filter(m => m.duration !== undefined);\n        \n        if (completedMetrics.length === 0) {\n            return {\n                metrics: [],\n                summary: {\n                    totalDuration: 0,\n                    averageDuration: 0,\n                    slowestOperation: { name: 'none', duration: 0 },\n                    fastestOperation: { name: 'none', duration: 0 }\n                }\n            };\n        }\n\n        const totalDuration = completedMetrics.reduce((sum, m) => sum + (m.duration || 0), 0);\n        const averageDuration = totalDuration / completedMetrics.length;\n\n        const sorted = [...completedMetrics].sort((a, b) => \n            (b.duration || 0) - (a.duration || 0));\n\n        return {\n            metrics: completedMetrics,\n            summary: {\n                totalDuration,\n                averageDuration,\n                slowestOperation: {\n                    name: sorted[0].name,\n                    duration: sorted[0].duration || 0\n                },\n                fastestOperation: {\n                    name: sorted[sorted.length - 1].name,\n                    duration: sorted[sorted.length - 1].duration || 0\n                }\n            }\n        };\n    }\n\n    public clear(): void {\n        this.metrics = [];\n    }\n\n    public monitorAsync<T>(name: string, fn: () => Promise<T>, metadata?: Record<string, any>): Promise<T> {\n        this.startMetric(name, metadata);\n        return fn().finally(() => this.endMetric(name));\n    }\n\n    public monitor<T>(name: string, fn: () => T, metadata?: Record<string, any>): T {\n        this.startMetric(name, metadata);\n        const result = fn();\n        this.endMetric(name);\n        return result;\n    }\n}","import { Assignment } from '../types/models';\nimport { Logger } from './logger';\nimport { PerformanceMonitor } from './performanceMonitor';\n\nexport class DebugPanel {\n    private panel: HTMLElement | null = null;\n    private logger: Logger;\n    private performanceMonitor: PerformanceMonitor;\n    private isVisible: boolean = false;\n    private debugManager: { isDebugEnabled(): boolean };\n\n    constructor(debugManager: { isDebugEnabled(): boolean }) {\n        this.logger = new Logger('DebugPanel');\n        this.performanceMonitor = PerformanceMonitor.getInstance();\n        this.debugManager = debugManager;\n        this.initializeKeyboardShortcut();\n    }\n\n    private createPanel(): void {\n        const initPanel = () => {\n            if (!document.body) {\n                // Wait for body to be available\n                requestAnimationFrame(initPanel);\n                return;\n            }\n\n            this.panel = document.createElement('div');\n            this.panel.id = 'canvaspal-debug-panel';\n            this.panel.innerHTML = `\n                <div class=\"debug-panel-header\">\n                    <span>🔍 CanvasPal Debug</span>\n                    <div class=\"debug-panel-controls\">\n                        <button id=\"clear-metrics\" title=\"Clear Performance Metrics\">🗑️</button>\n                        <button id=\"canvaspal-debug-close\">✕</button>\n                    </div>\n                </div>\n                <div class=\"debug-panel-content\">\n                    <div id=\"performance-metrics\"></div>\n                    <div id=\"assignment-info\"></div>\n                </div>\n            `;\n\n            // Apply styles\n            this.panel.style.cssText = `\n                position: fixed;\n                bottom: 20px;\n                right: 20px;\n                width: 350px;\n                max-height: 500px;\n                background: rgba(0, 0, 0, 0.9);\n                color: white;\n                padding: 15px;\n                border-radius: 8px;\n                font-family: monospace;\n                font-size: 12px;\n                z-index: 9999;\n                overflow-y: auto;\n                box-shadow: 0 0 10px rgba(0,0,0,0.5);\n                display: none;\n            `;\n\n            // Add button styles\n            const style = document.createElement('style');\n            style.textContent = `\n                .debug-panel-header {\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: center;\n                    margin-bottom: 10px;\n                    padding-bottom: 10px;\n                    border-bottom: 1px solid rgba(255,255,255,0.1);\n                }\n\n                .debug-panel-controls {\n                    display: flex;\n                    gap: 8px;\n                }\n\n                .debug-panel-controls button {\n                    background: none;\n                    border: none;\n                    color: white;\n                    cursor: pointer;\n                    padding: 4px;\n                    border-radius: 4px;\n                    transition: background 0.2s;\n                }\n\n                .debug-panel-controls button:hover {\n                    background: rgba(255,255,255,0.1);\n                }\n\n                .performance-section {\n                    margin: 10px 0;\n                    padding: 8px;\n                    background: rgba(255,255,255,0.05);\n                    border-radius: 4px;\n                }\n\n                .metric-item {\n                    margin: 4px 0;\n                    display: flex;\n                    justify-content: space-between;\n                }\n\n                .metric-value {\n                    color: #90EE90;\n                }\n\n                .slow-metric {\n                    color: #ff6b6b;\n                }\n\n                .normal-metric {\n                    color: #ffd700;\n                }\n\n                .fast-metric {\n                    color: #90EE90;\n                }\n            `;\n\n            // Wait for head to be available\n            if (document.head) {\n                document.head.appendChild(style);\n            } else {\n                document.addEventListener('DOMContentLoaded', () => {\n                    document.head.appendChild(style);\n                });\n            }\n\n            document.body.appendChild(this.panel);\n\n            // Add event listeners\n            document.getElementById('canvaspal-debug-close')?.addEventListener('click', () => {\n                this.toggleVisibility();\n            });\n\n            document.getElementById('clear-metrics')?.addEventListener('click', () => {\n                this.performanceMonitor.clear();\n                this.updatePerformanceMetrics();\n            });\n        };\n\n        // Start the initialization process\n        if (document.readyState === 'loading') {\n            document.addEventListener('DOMContentLoaded', initPanel);\n        } else {\n            initPanel();\n        }\n    }\n\n    private initializeKeyboardShortcut(): void {\n        document.addEventListener('keydown', (e) => {\n            // Only respond to shortcuts if debug mode is enabled\n            if (this.debugManager.isDebugEnabled() && (e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'D') {\n                e.preventDefault();\n                this.toggleVisibility();\n            }\n        });\n    }\n\n    public toggleVisibility(): void {\n        // Only allow showing the panel if debug mode is enabled\n        if (this.isVisible || this.debugManager.isDebugEnabled()) {\n            // Create panel if it doesn't exist and we're showing it\n            if (!this.panel && !this.isVisible) {\n                this.createPanel();\n            }\n            \n            if (this.panel) {\n                this.isVisible = !this.isVisible;\n                this.panel.style.display = this.isVisible ? 'block' : 'none';\n                \n                // Remove panel from DOM when hiding it\n                if (!this.isVisible && this.panel.parentNode) {\n                    this.panel.parentNode.removeChild(this.panel);\n                    this.panel = null;\n                }\n                \n                this.logger.debug(`Debug panel ${this.isVisible ? 'shown' : 'hidden'}`);\n            }\n        }\n    }\n\n    private updatePerformanceMetrics(): void {\n        const metricsContainer = document.getElementById('performance-metrics');\n        if (!metricsContainer) return;\n\n        const report = this.performanceMonitor.getReport();\n        \n        metricsContainer.innerHTML = `\n            <div class=\"performance-section\">\n                <h3>Performance Summary</h3>\n                <div class=\"metric-item\">\n                    <span>Total Duration:</span>\n                    <span class=\"metric-value\">${report.summary.totalDuration.toFixed(2)}ms</span>\n                </div>\n                <div class=\"metric-item\">\n                    <span>Average Duration:</span>\n                    <span class=\"metric-value\">${report.summary.averageDuration.toFixed(2)}ms</span>\n                </div>\n                <div class=\"metric-item\">\n                    <span>Slowest Operation:</span>\n                    <span class=\"slow-metric\">${report.summary.slowestOperation.name} (${report.summary.slowestOperation.duration.toFixed(2)}ms)</span>\n                </div>\n                <div class=\"metric-item\">\n                    <span>Fastest Operation:</span>\n                    <span class=\"fast-metric\">${report.summary.fastestOperation.name} (${report.summary.fastestOperation.duration.toFixed(2)}ms)</span>\n                </div>\n            </div>\n            <div class=\"performance-section\">\n                <h3>Recent Operations</h3>\n                ${report.metrics.slice(-5).map(metric => `\n                    <div class=\"metric-item\">\n                        <span>${metric.name}</span>\n                        <span class=\"${this.getMetricSpeedClass(metric.duration || 0)}\">${metric.duration?.toFixed(2)}ms</span>\n                    </div>\n                `).join('')}\n            </div>\n        `;\n    }\n\n    private getMetricSpeedClass(duration: number): string {\n        if (duration > 100) return 'slow-metric';\n        if (duration > 50) return 'normal-metric';\n        return 'fast-metric';\n    }\n\n    public updateAssignmentInfo(assignments: Assignment[]): void {\n        const container = document.getElementById('assignment-info');\n        if (!container) return;\n\n        const typeCounts = this.getAssignmentTypeCounts(assignments);\n        const priorityRanges = this.getPriorityRanges(assignments);\n\n        container.innerHTML = `\n            <div style=\"margin-bottom: 15px;\">\n                <div style=\"color: #0066cc; margin-bottom: 8px;\">\n                    Found ${assignments.length} assignments\n                </div>\n                ${this.renderTypeCounts(typeCounts)}\n                ${this.renderPriorityDistribution(priorityRanges)}\n            </div>\n            ${this.renderAssignmentList(assignments)}\n        `;\n\n        // Update performance metrics\n        this.updatePerformanceMetrics();\n    }\n\n    private getAssignmentTypeCounts(assignments: Assignment[]): Record<string, number> {\n        return assignments.reduce((acc, assignment) => {\n            acc[assignment.type] = (acc[assignment.type] || 0) + 1;\n            return acc;\n        }, {} as Record<string, number>);\n    }\n\n    private getPriorityRanges(assignments: Assignment[]): Record<string, number> {\n        return assignments.reduce((acc, assignment) => {\n            if (assignment.priorityScore >= 0.7) acc.high = (acc.high || 0) + 1;\n            else if (assignment.priorityScore >= 0.4) acc.medium = (acc.medium || 0) + 1;\n            else acc.low = (acc.low || 0) + 1;\n            return acc;\n        }, {} as Record<string, number>);\n    }\n\n    private renderTypeCounts(counts: Record<string, number>): string {\n        return `\n            <div style=\"margin-bottom: 10px;\">\n                <div style=\"color: #ffd700; margin-bottom: 5px;\">Assignment Types:</div>\n                ${Object.entries(counts).map(([type, count]) => `\n                    <div style=\"margin-left: 10px; color: #90EE90;\">\n                        ${type}: ${count}\n                    </div>\n                `).join('')}\n            </div>\n        `;\n    }\n\n    private renderPriorityDistribution(ranges: Record<string, number>): string {\n        const colors = {\n            high: '#ff6b6b',\n            medium: '#ffd700',\n            low: '#90EE90'\n        };\n\n        return `\n            <div style=\"margin-bottom: 10px;\">\n                <div style=\"color: #ffd700; margin-bottom: 5px;\">Priority Distribution:</div>\n                ${Object.entries(ranges).map(([range, count]) => `\n                    <div style=\"margin-left: 10px; color: ${colors[range as keyof typeof colors]};\">\n                        ${range}: ${count}\n                    </div>\n                `).join('')}\n            </div>\n        `;\n    }\n\n    private renderAssignmentList(assignments: Assignment[]): string {\n        return `\n            <div style=\"margin-top: 15px;\">\n                <div style=\"color: #ffd700; margin-bottom: 5px;\">Detailed Assignments:</div>\n                ${assignments.map(assignment => this.renderAssignmentDetail(assignment)).join('')}\n            </div>\n        `;\n    }\n\n    private renderAssignmentDetail(assignment: Assignment): string {\n        const priorityColor = assignment.priorityScore >= 0.7 ? '#ff6b6b' :\n                            assignment.priorityScore >= 0.4 ? '#ffd700' : '#90EE90';\n\n        return `\n            <div style=\"margin: 8px 0; padding: 8px; border-left: 2px solid ${priorityColor}; background: rgba(255,255,255,0.1);\">\n                <div style=\"margin-bottom: 4px;\">📚 ${assignment.title}</div>\n                <div style=\"color: #90EE90; margin-bottom: 4px;\">\n                    ${assignment.points ? `📝 ${assignment.points}/${assignment.maxPoints} points` : 'No points data'}\n                </div>\n                <div style=\"color: #ADD8E6; font-size: 11px;\">\n                    ⏰ Due: ${this.formatDate(assignment.dueDate)}\n                </div>\n                <div style=\"color: #DDA0DD; font-size: 11px;\">\n                    📚 Course: ${assignment.course}\n                </div>\n                <div style=\"color: ${priorityColor}; font-size: 11px; margin-top: 4px;\">\n                    ⚡ Priority: ${Math.round(assignment.priorityScore * 100)}%\n                </div>\n            </div>\n        `;\n    }\n\n    public logDetectionEvent(message: string, data?: any): void {\n        this.logger.debug(message, data);\n        // Could add visual indication of new events in the panel\n    }\n\n    private formatDate(date: string): string {\n        // Handle special date strings\n        if (date === 'All Day' || date === 'No due date') {\n            return date;\n        }\n\n        // Extract date from \"Due: \" format if present\n        const dateStr = date.startsWith('Due: ') ? date.substring(5) : date;\n        \n        try {\n            const dateObj = new Date(dateStr);\n            // Check if date parsing was successful\n            if (!isNaN(dateObj.getTime())) {\n                return dateObj.toLocaleDateString('en-US', {\n                    month: 'short',\n                    day: 'numeric',\n                    year: 'numeric'\n                });\n            }\n            // Return original string if parsing fails\n            return date;\n        } catch {\n            // Return original string if parsing fails\n            return date;\n        }\n    }\n\n    public updatePerformanceAnalysis(analysis: any): void {\n        // Implementation\n    }\n}","import { Logger } from './logger';\n\ninterface DateDebugInfo {\n    totalDates: number;\n    types: {\n        due: number;\n        availability: number;\n        unlock: number;\n        unknown: number;\n    };\n    detections: {\n        element: string;\n        text: string;\n        type: string;\n        date: string;\n    }[];\n}\n\nexport class DateDebugPanel {\n    private panel: HTMLElement | null = null;\n    private logger: Logger;\n    private debugManager: { isDebugEnabled(): boolean };\n    private isVisible: boolean = false;\n\n    constructor(debugManager: { isDebugEnabled(): boolean }) {\n        this.logger = new Logger('DateDebugPanel');\n        this.debugManager = debugManager;\n        this.initializeKeyboardShortcut();\n    }\n\n    private initializeKeyboardShortcut(): void {\n        document.addEventListener('keydown', (e) => {\n            if (this.debugManager.isDebugEnabled() && (e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'T') {\n                e.preventDefault();\n                this.toggleVisibility();\n            }\n        });\n    }\n\n    private createPanel(): void {\n        if (!document.body) {\n            // Wait for body to be available\n            requestAnimationFrame(() => this.createPanel());\n            return;\n        }\n\n        this.panel = document.createElement('div');\n        this.panel.id = 'date-debug-panel';\n        this.panel.style.cssText = `\n            position: fixed;\n            bottom: 20px;\n            left: 20px;\n            width: 300px;\n            max-height: 400px;\n            background: rgba(0, 0, 0, 0.9);\n            color: white;\n            padding: 15px;\n            border-radius: 8px;\n            font-family: monospace;\n            font-size: 12px;\n            z-index: 9999;\n            overflow-y: auto;\n            box-shadow: 0 0 10px rgba(0,0,0,0.5);\n            display: none;\n        `;\n\n        const header = document.createElement('div');\n        header.innerHTML = `\n            <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;\">\n                <span style=\"color: #ffd700; font-weight: bold;\">📅 Date Detection Debug</span>\n                <button id=\"date-debug-close\" style=\"background: none; border: none; color: white; cursor: pointer;\">✕</button>\n            </div>\n        `;\n        this.panel.appendChild(header);\n\n        const content = document.createElement('div');\n        content.id = 'date-debug-content';\n        this.panel.appendChild(content);\n\n        document.body.appendChild(this.panel);\n\n        document.getElementById('date-debug-close')?.addEventListener('click', () => {\n            this.toggleVisibility();\n        });\n    }\n\n    public toggleVisibility(): void {\n        // Only allow showing the panel if debug mode is enabled\n        if (this.isVisible || this.debugManager.isDebugEnabled()) {\n            // Create panel if it doesn't exist and we're showing it\n            if (!this.panel && !this.isVisible) {\n                this.createPanel();\n            }\n            \n            if (this.panel) {\n                this.isVisible = !this.isVisible;\n                this.panel.style.display = this.isVisible ? 'block' : 'none';\n                \n                // Remove panel from DOM when hiding it\n                if (!this.isVisible && this.panel.parentNode) {\n                    this.panel.parentNode.removeChild(this.panel);\n                    this.panel = null;\n                }\n                \n                this.logger.debug(`Date debug panel ${this.isVisible ? 'shown' : 'hidden'}`);\n            }\n        }\n    }\n\n    public updateDebugInfo(info: DateDebugInfo): void {\n        const content = document.getElementById('date-debug-content');\n        if (!content) return;\n\n        content.innerHTML = `\n            <div class=\"date-stats\" style=\"margin-bottom: 15px;\">\n                <div style=\"color: #0066cc; margin-bottom: 8px;\">\n                    Found ${info.totalDates} date${info.totalDates !== 1 ? 's' : ''}\n                </div>\n                ${this.renderTypeDistribution(info.types)}\n            </div>\n            <div class=\"date-detections\">\n                <div style=\"color: #ffd700; margin-bottom: 8px;\">Detected Dates:</div>\n                ${this.renderDetections(info.detections)}\n            </div>\n        `;\n    }\n\n    private renderTypeDistribution(types: DateDebugInfo['types']): string {\n        const colors = {\n            due: '#ff6b6b',\n            availability: '#4CAF50',\n            unlock: '#2196F3',\n            unknown: '#9e9e9e'\n        };\n\n        return Object.entries(types)\n            .map(([type, count]) => `\n                <div style=\"margin-left: 10px; color: ${colors[type as keyof typeof colors]};\">\n                    ${type.charAt(0).toUpperCase() + type.slice(1)}: ${count}\n                </div>\n            `).join('');\n    }\n\n    private renderDetections(detections: DateDebugInfo['detections']): string {\n        return detections\n            .map(detection => `\n                <div style=\"margin: 8px 0; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 4px;\">\n                    <div style=\"margin-bottom: 4px; color: #90EE90;\">\n                        ${detection.text}\n                    </div>\n                    <div style=\"font-size: 11px; color: #ADD8E6;\">\n                        Type: ${detection.type}\n                    </div>\n                    <div style=\"font-size: 11px; color: #DDA0DD;\">\n                        Parsed: ${detection.date}\n                    </div>\n                    <div style=\"font-size: 11px; color: #FFB6C1;\">\n                        Element: ${detection.element}\n                    </div>\n                </div>\n            `).join('');\n    }\n\n    public logDateDetection(message: string, data?: any): void {\n        this.logger.debug(message, data);\n    }\n}","import { Logger } from './logger';\nimport { DateDebugPanel } from './dateDebugPanel';\n\ninterface DateMatch {\n    element: HTMLElement;\n    date: Date;\n    type: 'due' | 'availability' | 'unlock' | 'unknown';\n    text: string;\n}\n\nexport class DateDebugger {\n    private logger: Logger;\n    private debugPanel: DateDebugPanel;\n    private debugManager: { isDebugEnabled(): boolean };\n    private static readonly DATE_DEBUG_STYLES = `\n        .debug-date {\n            background-color: rgba(255, 255, 0, 0.3) !important;\n            border: 2px solid #ffd700 !important;\n            position: relative !important;\n            z-index: 1000;\n            padding: 2px !important;\n            margin: 2px !important;\n            border-radius: 3px !important;\n            display: inline-block !important;\n        }\n\n        .debug-date::after {\n            content: attr(data-debug-type);\n            position: absolute;\n            top: -20px;\n            left: 0;\n            background: #ffd700;\n            color: black;\n            font-size: 10px;\n            padding: 2px 4px;\n            border-radius: 2px;\n            z-index: 1001;\n            pointer-events: none;\n            white-space: nowrap;\n        }\n\n        .debug-date[data-debug-type=\"DUE DATE\"] {\n            border-color: #ff6b6b !important;\n        }\n\n        .debug-date[data-debug-type=\"DUE DATE\"]::after {\n            background: #ff6b6b;\n            color: white;\n        }\n\n        .debug-date[data-debug-type=\"AVAILABILITY\"] {\n            border-color: #4CAF50 !important;\n        }\n\n        .debug-date[data-debug-type=\"AVAILABILITY\"]::after {\n            background: #4CAF50;\n            color: white;\n        }\n\n        .debug-date[data-debug-type=\"UNLOCK\"] {\n            border-color: #2196F3 !important;\n        }\n\n        .debug-date[data-debug-type=\"UNLOCK\"]::after {\n            background: #2196F3;\n            color: white;\n        }\n    `;\n\n    constructor() {\n        // Create debug manager\n        this.debugManager = {\n            isDebugEnabled: () => true // Always enable debug for development\n        };\n\n        this.logger = new Logger('DateDebugger');\n        this.debugPanel = new DateDebugPanel(this.debugManager);\n        this.injectDebugStyles();\n    }\n\n    private injectDebugStyles(): void {\n        const styleElement = document.createElement('style');\n        styleElement.textContent = DateDebugger.DATE_DEBUG_STYLES;\n        document.head.appendChild(styleElement);\n    }\n\n    public highlightDates(): DateMatch[] {\n        const dateMatches: DateMatch[] = [];\n        \n        // Common date-containing elements\n        const dateElements = document.querySelectorAll<HTMLElement>(\n            '[class*=\"date\"], [class*=\"due\"], [class*=\"deadline\"], ' +\n            '[aria-label*=\"due\"], [title*=\"due\"], ' +\n            '[data-date], [datetime]'\n        );\n\n        dateElements.forEach(element => {\n            const match = this.processDateElement(element);\n            if (match) {\n                dateMatches.push(match);\n                this.applyDebugHighlight(match);\n            }\n        });\n\n        // Look for dates in text content\n        const textMatches = this.findDatesInTextNodes();\n        dateMatches.push(...textMatches);\n\n        // Update debug panel with results\n        this.updateDebugPanel(dateMatches);\n\n        this.logger.debug('Found dates:', dateMatches);\n        return dateMatches;\n    }\n\n    private findDatesInTextNodes(): DateMatch[] {\n        const matches: DateMatch[] = [];\n        const walker = document.createTreeWalker(\n            document.body,\n            NodeFilter.SHOW_TEXT,\n            {\n                acceptNode: (node) => {\n                    if (node.parentElement?.closest('.debug-date')) {\n                        return NodeFilter.FILTER_REJECT;\n                    }\n                    const hasDate = this.containsDatePattern(node.textContent || '');\n                    return hasDate ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;\n                }\n            }\n        );\n\n        let node: Text | null;\n        while (node = walker.nextNode() as Text) {\n            const textMatches = this.findDatesInText(node);\n            textMatches.forEach(match => {\n                matches.push(match);\n                this.applyDebugHighlight(match);\n            });\n        }\n\n        return matches;\n    }\n\n    private updateDebugPanel(matches: DateMatch[]): void {\n        const types = {\n            due: 0,\n            availability: 0,\n            unlock: 0,\n            unknown: 0\n        };\n\n        matches.forEach(match => {\n            types[match.type]++;\n        });\n\n        const debugInfo = {\n            totalDates: matches.length,\n            types,\n            detections: matches.map(match => ({\n                element: this.getElementDescription(match.element),\n                text: match.text,\n                type: this.getDebugLabel(match.type),\n                date: match.date.toLocaleString()\n            }))\n        };\n\n        this.debugPanel.updateDebugInfo(debugInfo);\n    }\n\n    private getElementDescription(element: HTMLElement): string {\n        const tagName = element.tagName.toLowerCase();\n        const id = element.id ? `#${element.id}` : '';\n        const classes = Array.from(element.classList)\n            .filter(cls => !cls.includes('debug-date'))\n            .map(cls => `.${cls}`)\n            .join('');\n        \n        return `${tagName}${id}${classes}`;\n    }\n\n    private processDateElement(element: HTMLElement): DateMatch | null {\n        const dateStr = element.getAttribute('data-date') ||\n                       element.getAttribute('datetime') ||\n                       element.getAttribute('title') ||\n                       element.getAttribute('aria-label') ||\n                       element.textContent;\n\n        if (!dateStr) return null;\n\n        const date = this.parseDate(dateStr);\n        if (!date) return null;\n\n        const type = this.determineDateType(element, dateStr);\n        \n        return {\n            element,\n            date,\n            type,\n            text: dateStr\n        };\n    }\n\n    private findDatesInText(node: Text): DateMatch[] {\n        const matches: DateMatch[] = [];\n        const text = node.textContent || '';\n        \n        // Common date patterns\n        const datePatterns = [\n            // ISO format\n            /\\d{4}-\\d{2}-\\d{2}/g,\n            // MM/DD/YYYY or DD/MM/YYYY\n            /\\d{1,2}\\/\\d{1,2}\\/\\d{4}/g,\n            // Month DD, YYYY\n            /(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]* \\d{1,2},? \\d{4}/gi,\n            // Tomorrow, Today, etc.\n            /\\b(?:today|tomorrow|yesterday)\\b/gi,\n            // Next/Last Day\n            /(?:next|last) (?:monday|tuesday|wednesday|thursday|friday|saturday|sunday)\\b/gi\n        ];\n\n        datePatterns.forEach(pattern => {\n            const regex = new RegExp(pattern);\n            let match;\n            while ((match = regex.exec(text)) !== null) {\n                const date = this.parseDate(match[0]);\n                if (date) {\n                    // Create a new span element to wrap the date text\n                    const span = document.createElement('span');\n                    node.splitText(match.index);\n                    const dateNode = node.splitText(match[0].length);\n                    span.textContent = match[0];\n                    node.parentNode?.replaceChild(span, node);\n\n                    matches.push({\n                        element: span,\n                        date,\n                        type: this.determineDateType(span, match[0]),\n                        text: match[0]\n                    });\n                }\n            }\n        });\n\n        return matches;\n    }\n\n    private parseDate(dateStr: string): Date | null {\n        try {\n            const normalized = dateStr.toLowerCase();\n            \n            // Handle relative dates\n            if (normalized.includes('today')) {\n                return new Date();\n            } else if (normalized.includes('tomorrow')) {\n                const tomorrow = new Date();\n                tomorrow.setDate(tomorrow.getDate() + 1);\n                return tomorrow;\n            } else if (normalized.includes('yesterday')) {\n                const yesterday = new Date();\n                yesterday.setDate(yesterday.getDate() - 1);\n                return yesterday;\n            }\n\n            // Try parsing as ISO date first\n            const date = new Date(dateStr);\n            if (!isNaN(date.getTime())) {\n                return date;\n            }\n\n            // Try other common formats\n            const formats = [\n                // Add more date formats as needed\n                /(\\d{1,2})\\/(\\d{1,2})\\/(\\d{4})/,\n                /(\\w+) (\\d{1,2}),? (\\d{4})/\n            ];\n\n            for (const format of formats) {\n                const match = dateStr.match(format);\n                if (match) {\n                    const parsed = new Date(dateStr);\n                    if (!isNaN(parsed.getTime())) {\n                        return parsed;\n                    }\n                }\n            }\n        } catch (error) {\n            this.logger.debug('Date parsing failed:', { dateStr, error });\n        }\n        return null;\n    }\n\n    private determineDateType(element: HTMLElement, text: string): DateMatch['type'] {\n        const context = (element.textContent + ' ' +\n                        (element.getAttribute('aria-label') || '') + ' ' +\n                        (element.getAttribute('title') || '')).toLowerCase();\n\n        if (context.includes('due') || context.includes('deadline')) {\n            return 'due';\n        } else if (context.includes('available') || context.includes('opens')) {\n            return 'availability';\n        } else if (context.includes('unlock') || context.includes('start')) {\n            return 'unlock';\n        }\n        return 'unknown';\n    }\n\n    private applyDebugHighlight(match: DateMatch): void {\n        const element = match.element;\n        element.classList.add('debug-date');\n        element.setAttribute('data-debug-type', this.getDebugLabel(match.type));\n        element.setAttribute('title', `Detected ${match.type} date: ${match.date.toLocaleDateString()}`);\n    }\n\n    private getDebugLabel(type: DateMatch['type']): string {\n        switch (type) {\n            case 'due': return 'DUE DATE';\n            case 'availability': return 'AVAILABILITY';\n            case 'unlock': return 'UNLOCK';\n            default: return 'DATE';\n        }\n    }\n\n    private containsDatePattern(text: string | null): boolean {\n        if (!text) return false;\n        return /\\d{4}-\\d{2}-\\d{2}|\\d{1,2}\\/\\d{1,2}\\/\\d{4}|(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[a-z]* \\d{1,2},? \\d{4}|\\b(?:today|tomorrow|yesterday)\\b|(?:next|last) (?:monday|tuesday|wednesday|thursday|friday|saturday|sunday)\\b/i.test(text);\n    }\n}","import { Assignment, PriorityWeights, PriorityDetails } from '../types/models';\nimport { Logger } from './logger';\nimport { DebugPanel } from './debugPanel';\nimport { PerformanceMonitor } from './performanceMonitor';\n\nexport class PriorityCalculator {\n    private PRIORITY_WEIGHTS: PriorityWeights = {\n        GRADE_IMPACT: 0.35,\n        COURSE_GRADE: 0.25,\n        DUE_DATE: 0.4  // Increased weight for due dates\n    };\n\n    private readonly TYPE_WEIGHTS = {\n        exam: 1.4,     // Highest priority\n        quiz: 1.2,     // High priority\n        assignment: 1.0, // Standard weight\n        discussion: 0.8, // Lower priority\n        announcement: 0.5 // Lowest priority\n    };\n\n    private logger: Logger;\n    private debugPanel: DebugPanel;\n    private performanceMonitor: PerformanceMonitor;\n    private debugManager: { isDebugEnabled(): boolean };\n\n    constructor() {\n        // Create debug manager\n        this.debugManager = {\n            isDebugEnabled: () => true // Always enable debug for development\n        };\n\n        this.logger = new Logger('PriorityCalculator');\n        this.debugPanel = new DebugPanel(this.debugManager);\n        this.performanceMonitor = PerformanceMonitor.getInstance();\n    }\n\n    public calculatePriority(assignment: Assignment): number {\n        return this.performanceMonitor.monitor('calculatePriority', () => {\n            try {\n                const metrics = {\n                    daysUntilDue: this.performanceMonitor.monitor('calculateDaysUntilDue', \n                        () => this.calculateDaysUntilDue(assignment.dueDate)),\n                    gradeImpact: this.performanceMonitor.monitor('calculateGradeImpact', \n                        () => this.calculateGradeImpact(assignment)),\n                    courseGradeImpact: this.performanceMonitor.monitor('calculateCourseGradeImpact', \n                        () => this.calculateCourseGradeImpact(assignment)),\n                    typeWeight: this.performanceMonitor.monitor('getTypeWeight', \n                        () => this.getTypeWeight(assignment.type))\n                };\n\n                // Calculate individual components\n                const components = this.performanceMonitor.monitor('calculateComponents', () => ({\n                    gradeComponent: metrics.gradeImpact * this.PRIORITY_WEIGHTS.GRADE_IMPACT,\n                    courseComponent: metrics.courseGradeImpact * this.PRIORITY_WEIGHTS.COURSE_GRADE,\n                    dateComponent: this.calculateDueDatePriority(metrics.daysUntilDue) * this.PRIORITY_WEIGHTS.DUE_DATE\n                }));\n\n                // Generate priority details\n                const priorityDetails: PriorityDetails = {\n                    dueStatus: this.getDueStatus(metrics.daysUntilDue),\n                    daysUntilDue: metrics.daysUntilDue,\n                    pointsImpact: this.getPointsImpact(assignment.points),\n                    typeImportance: this.getTypeImportance(assignment.type, assignment.title),\n                    components: {\n                        dueDateScore: components.dateComponent,\n                        gradeImpactScore: components.gradeComponent,\n                        typeScore: metrics.typeWeight\n                    }\n                };\n\n                // Calculate final priority with enhanced weighting\n                const finalPriority = this.performanceMonitor.monitor('calculateFinalPriority', () => {\n                    let priority = components.gradeComponent + components.courseComponent + components.dateComponent;\n                    \n                    // Apply type weight using both type and title\n                    priority *= this.getTypeWeight(assignment.type, assignment.title);\n                    \n                    // Additional boosts for critical assignments\n                    if (metrics.daysUntilDue <= 0) {\n                        priority *= 1.5; // 50% boost for overdue\n                    } else if (metrics.daysUntilDue <= 1) {\n                        priority *= 1.3; // 30% boost for due within 24 hours\n                    }\n                    \n                    // Boost for high-point assignments\n                    if (assignment.points >= 50) {\n                        priority *= 1.2; // 20% boost for assignments worth 50+ points\n                    }\n                    \n                    // Cap final priority between 0 and 1.5\n                    return Math.min(Math.max(priority, 0), 1.5);\n                });\n\n                // Attach priority details to assignment\n                assignment.priorityDetails = priorityDetails;\n\n                // Log calculation details to debug panel\n                this.debugPanel.logDetectionEvent('Priority calculation:', {\n                    assignment: assignment.title,\n                    components,\n                    metrics,\n                    finalPriority,\n                    performance: this.performanceMonitor.getReport()\n                });\n\n                return finalPriority;\n            } catch (error) {\n                this.logger.error('Error calculating priority:', error);\n                return 0;\n            }\n        }, { assignmentTitle: assignment.title });\n    }\n\n    private calculateDaysUntilDue(dueDate: string): number {\n        // Handle special cases\n        if (dueDate === 'All Day') {\n            return 0; // Due today\n        }\n        if (dueDate === 'No due date') {\n            return 14; // Default to 2 weeks\n        }\n\n        // Extract date from \"Due: \" format if present\n        const dateStr = dueDate.startsWith('Due: ') ? dueDate.substring(5) : dueDate;\n        \n        try {\n            const dueDateObj = new Date(dateStr);\n            // Check if date parsing was successful\n            if (!isNaN(dueDateObj.getTime())) {\n                const now = new Date();\n                const diffTime = dueDateObj.getTime() - now.getTime();\n                return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n            }\n            // Default to 2 weeks if parsing fails\n            this.logger.warn('Invalid date format:', dueDate);\n            return 14;\n        } catch (error) {\n            this.logger.error('Error calculating days until due:', error);\n            return 14; // Default to 2 weeks on error\n        }\n    }\n\n    private calculateDueDatePriority(daysUntilDue: number): number {\n        if (daysUntilDue <= 0) return 1.5; // Overdue assignments get 150% priority\n        if (daysUntilDue <= 1) return 1.2; // Due within 24 hours gets 120% priority\n        if (daysUntilDue <= 3) return 1.0; // Due within 3 days gets full priority\n        if (daysUntilDue >= 14) return 0.3; // Far future assignments get low priority\n        return 1 - (daysUntilDue / 14); // Linear decrease in priority over 14 days\n    }\n\n    private calculateGradeImpact(assignment: Assignment): number {\n        // If no points info available, use a moderate default based on type\n        if (!assignment.points || !assignment.maxPoints) {\n            switch (assignment.type) {\n                case 'quiz':\n                    return 0.7; // Quizzes typically important\n                case 'exam':\n                    return 0.9; // Exams very important\n                default:\n                    return 0.5;\n            }\n        }\n\n        // Calculate base impact from points\n        let impact = 0;\n        \n        // Scale based on point ranges\n        if (assignment.points >= 100) impact = 1.0;        // 100+ points = max priority\n        else if (assignment.points >= 50) impact = 0.9;    // 50-99 points = very high\n        else if (assignment.points >= 20) impact = 0.7;    // 20-49 points = high\n        else if (assignment.points >= 10) impact = 0.5;    // 10-19 points = medium\n        else impact = 0.3;                                 // <10 points = lower\n\n        // Adjust impact based on grade weight if available\n        if (assignment.gradeWeight) {\n            impact *= (1 + assignment.gradeWeight); // Weight increases impact\n        }\n\n        // Title-based adjustments\n        const title = assignment.title.toLowerCase();\n        if (title.includes('exam') || title.includes('final') || title.includes('midterm')) {\n            impact *= 1.3; // 30% boost for exams\n        } else if (title.includes('quiz')) {\n            impact *= 1.1; // 10% boost for quizzes\n        }\n\n        // Cap final impact at 1.5\n        return Math.min(impact, 1.5);\n    }\n\n    private calculateCourseGradeImpact(assignment: Assignment): number {\n        if (!assignment.courseGrade) return 0.85; // Default if no course grade available\n        return 1 - assignment.courseGrade; // Lower grades mean higher priority\n    }\n\n    private getTypeWeight(type: Assignment['type'], title: string = ''): number {\n        // Check title for exam-related keywords\n        const lowerTitle = title.toLowerCase();\n        if (lowerTitle.includes('exam') ||\n            lowerTitle.includes('final') ||\n            lowerTitle.includes('midterm')) {\n            return this.TYPE_WEIGHTS.exam;\n        }\n\n        // Check title for quiz if type is assignment\n        if (type === 'assignment' && lowerTitle.includes('quiz')) {\n            return this.TYPE_WEIGHTS.quiz;\n        }\n\n        // Use type-based weights\n        switch (type) {\n            case 'quiz':\n                return this.TYPE_WEIGHTS.quiz;\n            case 'assignment':\n                return this.TYPE_WEIGHTS.assignment;\n            case 'discussion':\n                return this.TYPE_WEIGHTS.discussion;\n            case 'announcement':\n                return this.TYPE_WEIGHTS.announcement;\n            default:\n                return this.TYPE_WEIGHTS.assignment;\n        }\n    }\n\n    private getDueStatus(daysUntilDue: number): PriorityDetails['dueStatus'] {\n        if (daysUntilDue <= 0) return 'overdue';\n        if (daysUntilDue <= 1) return 'due-soon';\n        if (daysUntilDue <= 7) return 'upcoming';\n        return 'far-future';\n    }\n\n    private getPointsImpact(points: number): PriorityDetails['pointsImpact'] {\n        if (points >= 50) return 'high';\n        if (points >= 20) return 'medium';\n        return 'low';\n    }\n\n    private getTypeImportance(type: Assignment['type'], title: string): PriorityDetails['typeImportance'] {\n        const lowerTitle = title.toLowerCase();\n        \n        // Check for exam-related keywords in title\n        if (lowerTitle.includes('exam') ||\n            lowerTitle.includes('final') ||\n            lowerTitle.includes('midterm')) {\n            return 'critical';\n        }\n\n        // Check for quiz in title if type is assignment\n        if (type === 'assignment' && lowerTitle.includes('quiz')) {\n            return 'high';\n        }\n\n        // Use type-based importance\n        switch (type) {\n            case 'quiz':\n                return 'high';\n            case 'assignment':\n                return 'normal';\n            case 'discussion':\n                return 'low';\n            case 'announcement':\n                return 'low';\n            default:\n                return 'normal';\n        }\n    }\n\n    public setPriorityWeights(weights: Partial<PriorityWeights>): void {\n        const totalWeight = (weights.GRADE_IMPACT || this.PRIORITY_WEIGHTS.GRADE_IMPACT) +\n                          (weights.COURSE_GRADE || this.PRIORITY_WEIGHTS.COURSE_GRADE) +\n                          (weights.DUE_DATE || this.PRIORITY_WEIGHTS.DUE_DATE);\n\n        if (Math.abs(totalWeight - 1) > 0.001) {\n            this.logger.warn('Priority weights do not sum to 1. Using default weights.');\n            return;\n        }\n\n        Object.assign(this.PRIORITY_WEIGHTS, weights);\n        this.logger.info('Priority weights updated:', this.PRIORITY_WEIGHTS);\n        this.debugPanel.logDetectionEvent('Priority weights updated:', this.PRIORITY_WEIGHTS);\n    }\n}\n","import { Assignment, AssignmentType, AssignmentDetails } from '../types/models';\nimport { Logger, LogLevel } from '../utils/logger';\nimport { DebugPanel } from './debugPanel';\nimport { DateDebugger } from './dateDebugger';\nimport { PerformanceMonitor } from './performanceMonitor';\nimport { PriorityCalculator } from './priorityCalculator';\n\nexport class AssignmentDetector {\n    private logger: Logger;\n    private debugPanel: DebugPanel;\n    private dateDebugger: DateDebugger;\n    private performanceMonitor: PerformanceMonitor;\n    private debugManager: { isDebugEnabled(): boolean };\n    private priorityCalculator: PriorityCalculator;\n\n    constructor() {\n        // Create debug manager\n        this.debugManager = {\n            isDebugEnabled: () => true // Always enable debug for development\n        };\n\n        this.logger = new Logger('AssignmentDetector', LogLevel.INFO);\n        try {\n          this.debugPanel = new DebugPanel(this.debugManager);\n          this.dateDebugger = new DateDebugger();\n          this.performanceMonitor = PerformanceMonitor.getInstance();\n          this.priorityCalculator = new PriorityCalculator();\n        } catch (error) {\n          console.error(\"Error initializing debug tools: \", error);\n          // Provide fallback implementations to prevent crashes\n          this.debugPanel = { logDetectionEvent: () => {} } as any;\n          this.dateDebugger = { highlightDates: async () => [] } as any;\n          this.performanceMonitor = { monitorAsync: async (name: string, fn: () => Promise<any>) => fn() } as any;\n          this.priorityCalculator = new PriorityCalculator();\n        }\n    }\n\n    public async detectAssignments(): Promise<Assignment[]> {\n        return this.performanceMonitor.monitorAsync('detectAssignments', async () => {\n            try {\n                // Check if we're on a Canvas page\n                if (!window.location.hostname.includes('instructure.com')) {\n                    this.logger.info('Not on a Canvas page, skipping assignment detection');\n                    return [];\n                }\n\n                this.logger.info('Starting assignment detection');\n                this.debugPanel.logDetectionEvent('Starting assignment detection');\n                \n                // Monitor date detection\n                const dateMatches = await this.performanceMonitor.monitorAsync('dateDetection',\n                    async () => this.dateDebugger.highlightDates(),\n                    { totalElements: document.querySelectorAll('[class*=\"date\"]').length }\n                );\n\n                this.debugPanel.logDetectionEvent('Date detection complete', {\n                    totalDates: dateMatches.length,\n                    dueDates: dateMatches.filter(m => m.type === 'due').length,\n                    performance: this.performanceMonitor.getReport()\n                });\n\n                let allAssignments: Assignment[] = [];\n\n                try {\n                    // Monitor API fetches in parallel\n                    const [plannerItems, missingSubmissions, dashboardItems] = await Promise.all([\n                        this.performanceMonitor.monitorAsync('fetchPlannerItems',\n                            () => this.fetchPlannerItems()),\n                        this.performanceMonitor.monitorAsync('fetchMissingSubmissions',\n                            () => this.fetchMissingSubmissions()),\n                        this.performanceMonitor.monitorAsync('parseDashboardCards',\n                            () => this.parseDashboardCards())\n                    ]);\n\n                    this.logger.info(`Retrieved: ${plannerItems.length} planner items, ${missingSubmissions.length} missing submissions, ${dashboardItems.length} dashboard items`);\n\n                    // Combine and filter assignments\n                    allAssignments = [...plannerItems, ...missingSubmissions, ...dashboardItems]\n                        .filter(assignment => this.isValidAssignment(assignment));\n\n                    // Sort assignments by priority score (highest first)\n                    allAssignments.sort((a, b) => b.priorityScore - a.priorityScore);\n\n                    this.logger.info(`Total valid assignments found: ${allAssignments.length}`);\n                    this.debugPanel.logDetectionEvent('Assignments sorted by priority:',\n                        allAssignments.map(a => ({\n                            title: a.title,\n                            dueDate: a.dueDate,\n                            priority: a.priorityScore\n                        }))\n                    );\n                } catch (error) {\n                    this.logger.error('Error fetching assignments:', error);\n                    return [];\n                }\n\n                // Monitor date validation\n                await this.performanceMonitor.monitorAsync('validateDates',\n                    async () => this.validateAssignmentDates(allAssignments, dateMatches),\n                    { assignmentCount: allAssignments.length }\n                );\n\n                const performanceReport = this.performanceMonitor.getReport();\n                this.debugPanel.logDetectionEvent('Assignment detection complete', {\n                    totalAssignments: allAssignments.length,\n                    performance: performanceReport\n                });\n\n                return allAssignments;\n            } catch (error) {\n                this.logger.error('Error detecting assignments:', error);\n                return [];\n            }\n        });\n    }\n\n    private async validateAssignmentDates(assignments: Assignment[], dateMatches: any[]): Promise<void> {\n        return this.performanceMonitor.monitorAsync('validateAssignmentDates', async () => {\n            assignments.forEach(assignment => {\n                const matchingDateElements = dateMatches.filter(match => {\n                    try {\n                        const matchDate = new Date(match.date).getTime();\n                        const assignmentDate = new Date(assignment.dueDate).getTime();\n                        return Math.abs(matchDate - assignmentDate) < 24 * 60 * 60 * 1000;\n                    } catch {\n                        return false;\n                    }\n                });\n\n                if (matchingDateElements.length > 0) {\n                    this.debugPanel.logDetectionEvent('Date validation:', {\n                        assignment: assignment.title,\n                        dueDate: assignment.dueDate,\n                        matchingElements: matchingDateElements.length\n                    });\n                }\n            });\n        }, { assignmentCount: assignments.length, dateMatchCount: dateMatches.length });\n    }\n\n    private async fetchPlannerItems(): Promise<Assignment[]> {\n        try {\n            const baseUrl = window.location.origin;\n            this.logger.info(`Fetching planner items from ${baseUrl}`);\n            \n            const response = await fetch(`${baseUrl}/api/v1/planner/items?per_page=50`, {\n                headers: {\n                    'Accept': 'application/json+canvas-string-ids, application/json',\n                    'X-Requested-With': 'XMLHttpRequest'\n                },\n                credentials: 'include'\n            });\n\n            if (!response.ok) {\n                this.logger.error(`HTTP error fetching planner items! status: ${response.status}`);\n                const errorText = await response.text();\n                this.logger.error(`Error details: ${errorText}`);\n                return [];\n            }\n            \n            const items = await response.json();\n            this.debugPanel.logDetectionEvent('Planner items retrieved:', items);\n            this.logger.info(`Retrieved ${items.length} planner items`);\n\n            return items.map((item: any) => {\n                try {\n                    const assignment = this.convertPlannerItem(item);\n                    if (assignment) {\n                        this.debugPanel.logDetectionEvent('Processed planner item:', {\n                            title: assignment.title,\n                            type: assignment.type,\n                            dueDate: assignment.dueDate\n                        });\n                        return assignment;\n                    }\n                    return null;\n                } catch (error) {\n                    this.logger.error('Error processing planner item:', error);\n                    return null;\n                }\n            }).filter((item: Assignment | null): item is Assignment => item !== null);\n        } catch (error) {\n            this.logger.error('Error fetching planner items:', error);\n            return [];\n        }\n    }\n\n    private async fetchMissingSubmissions(): Promise<Assignment[]> {\n        try {\n            const baseUrl = window.location.origin;\n            this.logger.info(`Fetching missing submissions from ${baseUrl}`);\n            \n            const response = await fetch(`${baseUrl}/api/v1/users/self/missing_submissions?include[]=planner_overrides`, {\n                headers: {\n                    'Accept': 'application/json',\n                    'X-Requested-With': 'XMLHttpRequest'\n                },\n                credentials: 'include'\n            });\n\n            if (!response.ok) {\n                this.logger.error(`HTTP error fetching missing submissions! status: ${response.status}`);\n                const errorText = await response.text();\n                this.logger.error(`Error details: ${errorText}`);\n                return [];\n            }\n            \n            const submissions = await response.json();\n            this.logger.info(`Retrieved ${submissions.length} missing submissions`);\n            return submissions.map((submission: any) => {\n                try {\n                    return this.convertMissingSubmission(submission);\n                } catch (error) {\n                    this.logger.error('Error processing missing submission:', error);\n                    return null;\n                }\n            })\n                .filter((item: Assignment | null): item is Assignment => item !== null) as Assignment[];\n        } catch (error) {\n            this.logger.error('Error fetching missing submissions:', error);\n            return [];\n        }\n    }\n\n    private async parseDashboardCards(): Promise<Assignment[]> {\n        try {\n            // Check if we're on a Canvas page\n            if (!window.location.hostname.includes('instructure.com')) {\n                this.logger.info('Not on a Canvas page, skipping dashboard cards fetch');\n                return [];\n            }\n\n            const baseUrl = window.location.origin;\n            this.logger.info(`Fetching dashboard cards from ${baseUrl}`);\n            \n            // First get the dashboard cards\n            const cardsResponse = await fetch(`${baseUrl}/api/v1/dashboard/dashboard_cards`, {\n                headers: {\n                    'Accept': 'application/json+canvas-string-ids, application/json',\n                    'X-Requested-With': 'XMLHttpRequest'\n                },\n                credentials: 'include'\n            });\n\n            if (!cardsResponse.ok) {\n                this.logger.error(`HTTP error fetching dashboard cards! status: ${cardsResponse.status}`);\n                const errorText = await cardsResponse.text();\n                this.logger.error(`Error details: ${errorText}`);\n                return [];\n            }\n            \n            const cards = await cardsResponse.json();\n            this.logger.info(`Retrieved ${cards?.length || 0} dashboard cards`);\n\n            // Then get the activity stream items which contain more recent assignments\n            const streamResponse = await fetch(`${baseUrl}/api/v1/users/self/activity_stream?only_active_courses=true`, {\n                headers: {\n                    'Accept': 'application/json',\n                    'X-Requested-With': 'XMLHttpRequest'\n                },\n                credentials: 'include'\n            });\n\n            if (!streamResponse.ok) {\n                this.logger.error(`HTTP error fetching activity stream! status: ${streamResponse.status}`);\n                return [];\n            }\n\n            const streamItems = await streamResponse.json();\n            this.logger.info(`Retrieved ${streamItems?.length || 0} activity stream items`);\n\n            const assignments: Assignment[] = [];\n\n            // Process dashboard cards\n            if (cards) {\n                for (const card of cards) {\n                    this.logger.info(`Processing card: ${card.shortName || card.courseName}`);\n                    \n                    // Get assignments from the card's upcoming_assignments\n                    if (card.upcoming_assignments) {\n                        this.logger.info(`Card has ${card.upcoming_assignments.length} upcoming assignments`);\n                        for (const assignment of card.upcoming_assignments) {\n                            try {\n                                const converted = this.convertDashboardAssignment(assignment, card);\n                                if (converted) {\n                                    this.logger.info(`Processed upcoming assignment: ${converted.title} for course ${converted.course}`);\n                                    assignments.push(converted);\n                                }\n                            } catch (error) {\n                                this.logger.error('Error processing upcoming assignment:', error);\n                            }\n                        }\n                    }\n\n                    // Get assignments from the card's published_grades\n                    if (card.published_grades) {\n                        this.logger.info(`Card has ${card.published_grades.length} published grades`);\n                        for (const grade of card.published_grades) {\n                            try {\n                                if (grade.assignment) {\n                                    const converted = this.convertDashboardAssignment(grade.assignment, card);\n                                    if (converted) {\n                                        this.logger.info(`Processed graded assignment: ${converted.title} for course ${converted.course}`);\n                                        assignments.push(converted);\n                                    }\n                                }\n                            } catch (error) {\n                                this.logger.error('Error processing graded assignment:', error);\n                            }\n                        }\n                    }\n                }\n            }\n\n            // Process activity stream items\n            if (streamItems) {\n                for (const item of streamItems) {\n                    if (item.type === 'Assignment' || item.type === 'Submission') {\n                        try {\n                            const assignment = item.assignment || item;\n                            const converted = this.convertDashboardAssignment(assignment, {\n                                shortName: item.context_name || item.course_name,\n                                id: item.course_id,\n                                contextCode: item.context_code\n                            });\n                            if (converted) {\n                                this.logger.info(`Processed stream assignment: ${converted.title} for course ${converted.course}`);\n                                assignments.push(converted);\n                            }\n                        } catch (error) {\n                            this.logger.error('Error processing stream assignment:', error);\n                        }\n                    }\n                }\n            }\n\n            // Also try to get assignments from the todo list\n            try {\n                const todoResponse = await fetch(`${baseUrl}/api/v1/users/self/todo`, {\n                    headers: {\n                        'Accept': 'application/json',\n                        'X-Requested-With': 'XMLHttpRequest'\n                    },\n                    credentials: 'include'\n                });\n\n                if (todoResponse.ok) {\n                    const todoItems = await todoResponse.json();\n                    this.logger.info(`Retrieved ${todoItems?.length || 0} todo items`);\n\n                    for (const item of todoItems) {\n                        try {\n                            if (item.assignment) {\n                                const converted = this.convertDashboardAssignment(item.assignment, {\n                                    shortName: item.context_name,\n                                    id: item.course_id,\n                                    contextCode: item.context_type\n                                });\n                                if (converted) {\n                                    this.logger.info(`Processed todo assignment: ${converted.title} for course ${converted.course}`);\n                                    assignments.push(converted);\n                                }\n                            }\n                        } catch (error) {\n                            this.logger.error('Error processing todo assignment:', error);\n                        }\n                    }\n                }\n            } catch (error) {\n                this.logger.error('Error fetching todo items:', error);\n            }\n\n            this.logger.info(`Total assignments found from dashboard: ${assignments.length}`);\n            return assignments;\n        } catch (error) {\n            this.logger.error('Error parsing dashboard cards:', error);\n            return [];\n        }\n    }\n\n    private convertPlannerItem(item: any): Assignment | null {\n        if (!item.plannable || !item.plannable_type) return null;\n\n        const type = this.determineAssignmentType(item.plannable_type);\n        if (!type || !item.plannable_date) return null;\n\n        // Try to get course name from various sources\n        let courseName = '';\n        if (item.context_name) {\n            courseName = item.context_name;\n        } else if (item.context?.name) {\n            courseName = item.context.name;\n        } else if (item.plannable?.context_name) {\n            courseName = item.plannable.context_name;\n        }\n\n        // If we still don't have a course name, try to extract from context_type\n        if (!courseName && item.context_type === 'Course' && item.course_id) {\n            courseName = `Course ${item.course_id}`;\n        }\n\n        // Ensure the assignment isn't too old\n        const dueDate = new Date(item.plannable_date);\n        const now = new Date();\n        const threeMonthsAgo = new Date();\n        threeMonthsAgo.setMonth(now.getMonth() - 3);\n\n        if (dueDate < threeMonthsAgo) {\n            this.logger.info(`Skipping old planner item: ${item.plannable?.title}, due: ${item.plannable_date}`);\n            return null;\n        }\n\n        this.logger.info(`Converting planner item: ${item.plannable?.title}, course: ${courseName}`);\n\n        const result: Assignment = {\n            id: item.plannable_id.toString(),\n            title: item.plannable?.title || item.plannable?.name || '',\n            dueDate: item.plannable_date,\n            course: courseName,\n            courseId: item.course_id?.toString(),\n            type,\n            points: item.plannable?.points_possible || item.plannable?.scoring_range?.points_possible || 0,\n            maxPoints: item.plannable?.points_possible || item.plannable?.scoring_range?.points_possible || 0,\n            completed: !!item.planner_override?.marked_complete,\n            priorityScore: 0,\n            url: item.html_url,\n            details: {\n                submissionType: item.plannable?.submission_types,\n                isCompleted: !!item.planner_override?.marked_complete,\n                isLocked: !!item.plannable?.locked_for_user,\n                description: item.plannable?.description\n            }\n        };\n\n        // Calculate priority score\n        result.priorityScore = this.priorityCalculator.calculatePriority({\n            ...result,\n            courseGrade: item.plannable?.score ? item.plannable.score / result.maxPoints : undefined\n        });\n\n        return result;\n    }\n\n    private convertMissingSubmission(submission: any): Assignment | null {\n        if (!submission.due_at) return null;\n\n        // Ensure the submission isn't too old\n        const dueDate = new Date(submission.due_at);\n        const now = new Date();\n        const threeMonthsAgo = new Date();\n        threeMonthsAgo.setMonth(now.getMonth() - 3);\n\n        if (dueDate < threeMonthsAgo) {\n            this.logger.info(`Skipping old missing submission: ${submission.name}, due: ${submission.due_at}`);\n            return null;\n        }\n\n        // Try to get course name from various sources\n        let courseName = '';\n        if (submission.course?.name) {\n            courseName = submission.course.name;\n        } else if (submission.context_name) {\n            courseName = submission.context_name;\n        } else if (submission.assignment?.course?.name) {\n            courseName = submission.assignment.course.name;\n        }\n\n        // If we still don't have a course name, try to extract from course_id\n        if (!courseName && submission.course_id) {\n            courseName = `Course ${submission.course_id}`;\n        }\n\n        this.logger.info(`Converting missing submission: ${submission.name}, course: ${courseName}`);\n\n        const result: Assignment = {\n            id: submission.id.toString(),\n            title: submission.name || submission.assignment?.name || '',\n            dueDate: submission.due_at,\n            course: courseName,\n            courseId: submission.course_id?.toString(),\n            type: 'assignment',\n            points: submission.points_possible || submission.assignment?.points_possible || 0,\n            maxPoints: submission.points_possible || submission.assignment?.points_possible || 0,\n            completed: false,\n            priorityScore: 0,\n            url: submission.html_url,\n            details: {\n                isCompleted: false,\n                isLocked: false,\n                submissionType: submission.submission_types,\n                description: submission.description || submission.assignment?.description\n            }\n        };\n\n        // Calculate priority score - missing submissions get a courseGrade of 0 to increase priority\n        result.priorityScore = this.priorityCalculator.calculatePriority({\n            ...result,\n            courseGrade: 0 // Missing submission means no grade, which should increase priority\n        });\n\n        return result;\n    }\n\n    private convertDashboardAssignment(assignment: any, card: any): Assignment | null {\n        try {\n            // Check if this is a valid assignment with a due date\n            if (!assignment || (!assignment.due_at && !assignment.due_date)) {\n                return null;\n            }\n\n            const dueDate = assignment.due_at || assignment.due_date;\n            \n            // Filter out old assignments\n            const now = new Date();\n            const oneWeekAgo = new Date();\n            oneWeekAgo.setDate(now.getDate() - 7);\n            \n            const assignmentDate = new Date(dueDate);\n            if (assignmentDate < oneWeekAgo) {\n                this.logger.info(`Skipping old dashboard assignment: ${assignment.name || assignment.title}, due: ${dueDate}`);\n                return null;\n            }\n\n            const type = this.determineAssignmentType(assignment.type || assignment.submission_types?.[0] || 'assignment');\n            \n            // Try to get course name from various sources\n            let courseName = '';\n            if (card.shortName) {\n                courseName = card.shortName;\n            } else if (card.courseName) {\n                courseName = card.courseName;\n            } else if (card.contextName) {\n                courseName = card.contextName;\n            } else if (assignment.contextName) {\n                courseName = assignment.contextName;\n            } else if (assignment.course_name) {\n                courseName = assignment.course_name;\n            }\n\n            // If we still don't have a course name, try to extract from context_code or URL\n            if (!courseName) {\n                if (card.contextCode) {\n                    const contextMatch = card.contextCode.match(/course_(\\d+)/i);\n                    if (contextMatch) {\n                        courseName = `Course ${contextMatch[1]}`;\n                    }\n                } else if (assignment.html_url) {\n                    const urlMatch = assignment.html_url.match(/courses\\/(\\d+)/);\n                    if (urlMatch) {\n                        courseName = `Course ${urlMatch[1]}`;\n                    }\n                }\n            }\n\n            // Extract points from various sources\n            let points = 0;\n            \n            // First try direct points_possible\n            if (assignment.points_possible !== undefined && assignment.points_possible !== null) {\n                points = parseFloat(assignment.points_possible);\n            }\n            \n            // Then try assignment details\n            if (points === 0 && assignment.assignment) {\n                if (assignment.assignment.points_possible !== undefined && assignment.assignment.points_possible !== null) {\n                    points = parseFloat(assignment.assignment.points_possible);\n                }\n            }\n            \n            // Try score or grade\n            if (points === 0) {\n                if (assignment.score !== undefined && assignment.score !== null) {\n                    points = parseFloat(assignment.score);\n                } else if (assignment.grade !== undefined && assignment.grade !== null) {\n                    const numericGrade = parseFloat(assignment.grade);\n                    if (!isNaN(numericGrade)) {\n                        points = numericGrade;\n                    }\n                }\n            }\n\n            // Try todo item points\n            if (points === 0 && assignment.todo) {\n                if (assignment.todo.points_possible !== undefined && assignment.todo.points_possible !== null) {\n                    points = parseFloat(assignment.todo.points_possible);\n                }\n            }\n\n            // Try grading details\n            if (points === 0 && assignment.grading) {\n                if (assignment.grading.points_possible !== undefined && assignment.grading.points_possible !== null) {\n                    points = parseFloat(assignment.grading.points_possible);\n                }\n            }\n\n            this.logger.info(`Points for ${assignment.name || assignment.title}: ${points} (from ${Object.keys({\n                direct: assignment.points_possible,\n                assignment: assignment.assignment?.points_possible,\n                score: assignment.score,\n                grade: assignment.grade,\n                todo: assignment.todo?.points_possible,\n                grading: assignment.grading?.points_possible\n            }).find(key => assignment[key]?.points_possible !== undefined || assignment[key] !== undefined) || 'unknown'})`);\n\n            // Determine completion status\n            const completed = !!assignment.has_submitted_submissions ||\n                             !!assignment.submitted ||\n                             !!assignment.submission?.submitted ||\n                             assignment.submission?.workflow_state === 'submitted';\n\n            this.logger.info(`Converting dashboard assignment: ${assignment.name || assignment.title}, course: ${courseName}, due: ${dueDate}`);\n            \n            const result: Assignment = {\n                id: assignment.id?.toString() || `${courseName}-${assignment.name}-${dueDate}`,\n                title: assignment.name || assignment.title || '',\n                dueDate: dueDate,\n                course: courseName,\n                courseId: card.id?.toString() || assignment.course_id?.toString(),\n                type,\n                points: points,\n                maxPoints: points,\n                completed: completed,\n                url: assignment.html_url || assignment.url,\n                priorityScore: 0, // Default value before calculation\n                details: {\n                    submissionType: assignment.submission_types || [type],\n                    isCompleted: completed,\n                    isLocked: !!assignment.locked_for_user || !!assignment.locked,\n                    description: assignment.description || assignment.body\n                }\n            };\n\n            // Calculate and update priority score\n            result.priorityScore = this.priorityCalculator.calculatePriority({\n                ...result,\n                courseGrade: assignment.score ? assignment.score / points : undefined\n            });\n\n            this.logger.info(`Assignment points: ${result.points}, maxPoints: ${result.maxPoints}, priority: ${result.priorityScore}`);\n            return result;\n        } catch (error) {\n            this.logger.error('Error converting dashboard assignment:', error);\n            return null;\n        }\n    }\n\n    private determineAssignmentType(type: string): AssignmentType {\n        switch (type.toLowerCase()) {\n            case 'quiz':\n            case 'quizzes/quiz':\n                return 'quiz';\n            case 'discussion_topic':\n                return 'discussion';\n            case 'announcement':\n                return 'announcement';\n            default:\n                return 'assignment';\n        }\n    }\n\n    private isValidAssignment(assignment: Assignment | null): assignment is Assignment {\n        if (!assignment) return false;\n        \n        // Check required fields\n        if (!assignment.title || !assignment.dueDate) {\n            this.logger.info(`Invalid assignment - missing title or due date: ${assignment?.title}`);\n            return false;\n        }\n        \n        // Filter out old assignments and far future assignments\n        const dueDate = new Date(assignment.dueDate);\n        const now = new Date();\n        \n        // Show assignments from up to 1 week ago\n        const oneWeekAgo = new Date();\n        oneWeekAgo.setDate(now.getDate() - 7);\n        \n        // And up to 3 months in the future\n        const threeMonthsFuture = new Date();\n        threeMonthsFuture.setMonth(now.getMonth() + 3);\n        \n        if (dueDate < oneWeekAgo) {\n            this.logger.info(`Filtering out old assignment: ${assignment.title}, due: ${assignment.dueDate}`);\n            return false;\n        }\n        \n        if (dueDate > threeMonthsFuture) {\n            this.logger.info(`Filtering out far future assignment: ${assignment.title}, due: ${assignment.dueDate}`);\n            return false;\n        }\n\n        // Ensure course name is set\n        if (!assignment.course || assignment.course === 'undefined') {\n            // Try to extract course name from title\n            const courseMatch = assignment.title.match(/^([A-Z]{2,4}\\s*\\d{4})/);\n            if (courseMatch) {\n                assignment.course = courseMatch[1];\n                this.logger.info(`Extracted course name from title: ${assignment.course}`);\n            } else if (assignment.courseId) {\n                assignment.course = `Course ${assignment.courseId}`;\n                this.logger.info(`Using course ID as name: ${assignment.course}`);\n            } else {\n                // Try to extract from URL\n                const urlMatch = assignment.url?.match(/\\/courses\\/(\\d+)/);\n                if (urlMatch) {\n                    assignment.course = `Course ${urlMatch[1]}`;\n                    this.logger.info(`Extracted course from URL: ${assignment.course}`);\n                } else {\n                    this.logger.warn(`Missing course name for assignment: ${assignment.title}`);\n                    assignment.course = 'Unknown Course';\n                }\n            }\n        }\n\n        this.logger.info(`Valid assignment found: ${assignment.title} for ${assignment.course}, due: ${assignment.dueDate}`);\n        return true;\n    }\n}","console.log('CanvasPal content script loaded');\n\nimport { initializeButton } from './canvasButton';\nimport { AssignmentDetector } from '../utils/assignmentDetector';\n\n// Initialize the extension\nconst initialize = async () => {\n    try {\n        console.log('Initializing CanvasPal extension');\n\n        // Initialize button and popup\n        initializeButton();\n\n        // Initialize assignment detector\n        const detector = new AssignmentDetector();\n        \n        // Detect assignments and send to background script\n        const assignments = await detector.detectAssignments();\n        console.log('Detected assignments:', assignments);\n        \n        // Send assignments to background script\n        chrome.runtime.sendMessage({\n            type: 'DASHBOARD_DATA',\n            data: assignments.map(assignment => ({\n                courseName: assignment.course,\n                id: assignment.courseId,\n                assignments: [{\n                    name: assignment.title,\n                    dueDate: assignment.dueDate,\n                    type: assignment.type,\n                    points: assignment.points,\n                    maxPoints: assignment.maxPoints,\n                    completed: assignment.completed,\n                    url: assignment.url,\n                    submissionType: assignment.details?.submissionType,\n                    description: assignment.details?.description,\n                    locked: assignment.details?.isLocked,\n                    priorityScore: assignment.priorityScore,\n                    priorityDetails: assignment.priorityDetails\n                }]\n            })),\n            gradeData: {\n                assignments: assignments.map(assignment => ({\n                    name: assignment.title,\n                    points: assignment.points,\n                    pointsPossible: assignment.maxPoints,\n                    weight: assignment.gradeWeight\n                }))\n            }\n        });\n\n    } catch (error) {\n        console.error('Error initializing CanvasPal:', error);\n    }\n};\n\n// Start initialization when DOM is ready\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', initialize);\n} else {\n    initialize();\n}\n"],"names":["handleAssignmentUpdates","button","message","console","log","type","textContent","data","length","toString","classList","toggle","assignmentList","document","getElementById","taskCount","assignments","innerHTML","map","assignment","score","priorityScore","title","Date","dueDate","toLocaleString","course","undefined","points","maxPoints","join","error","updateAssignmentsList","chrome","runtime","sendMessage","LogLevel","Logger","context","level","INFO","this","currentLevel","cleanOldLogs","getInstance","key","instances","has","set","get","setLevel","debug","DEBUG","info","warn","WARN","ERROR","args","timestamp","toISOString","formattedMessage","getLogPrefix","formattedData","formatLogData","entry","stack","Error","saveLogs","notifyError","Array","isArray","item","name","formatted","value","Object","entries","logs","storage","local","push","MAX_LOGS","splice","thirtyDaysAgo","setDate","getDate","filteredLogs","filter","notifications","create","iconUrl","priority","getLogs","Map","PerformanceMonitor","metrics","logger","instance","startMetric","metadata","id","now","startTime","performance","endMetric","metric","find","m","endTime","duration","toFixed","getReport","completedMetrics","summary","totalDuration","averageDuration","slowestOperation","fastestOperation","reduce","sum","sorted","sort","a","b","clear","monitorAsync","fn","finally","monitor","result","DebugPanel","constructor","debugManager","panel","isVisible","performanceMonitor","initializeKeyboardShortcut","createPanel","initPanel","body","requestAnimationFrame","createElement","style","cssText","head","appendChild","addEventListener","toggleVisibility","updatePerformanceMetrics","readyState","e","isDebugEnabled","ctrlKey","metaKey","shiftKey","preventDefault","display","parentNode","removeChild","metricsContainer","report","slice","getMetricSpeedClass","updateAssignmentInfo","container","typeCounts","getAssignmentTypeCounts","priorityRanges","getPriorityRanges","renderTypeCounts","renderPriorityDistribution","renderAssignmentList","acc","high","medium","low","counts","count","ranges","colors","range","renderAssignmentDetail","priorityColor","formatDate","Math","round","logDetectionEvent","date","dateStr","startsWith","substring","dateObj","isNaN","getTime","toLocaleDateString","month","day","year","updatePerformanceAnalysis","analysis","DateDebugPanel","header","content","updateDebugInfo","totalDates","renderTypeDistribution","types","renderDetections","detections","due","availability","unlock","unknown","charAt","toUpperCase","detection","text","element","logDateDetection","DateDebugger","debugPanel","injectDebugStyles","styleElement","DATE_DEBUG_STYLES","highlightDates","dateMatches","querySelectorAll","forEach","match","processDateElement","applyDebugHighlight","textMatches","findDatesInTextNodes","updateDebugPanel","matches","walker","createTreeWalker","NodeFilter","SHOW_TEXT","acceptNode","node","parentElement","closest","FILTER_REJECT","containsDatePattern","FILTER_ACCEPT","nextNode","findDatesInText","debugInfo","getElementDescription","getDebugLabel","tagName","toLowerCase","from","cls","includes","getAttribute","parseDate","determineDateType","pattern","regex","RegExp","exec","span","splitText","index","replaceChild","normalized","tomorrow","yesterday","formats","format","parsed","add","setAttribute","test","PriorityCalculator","PRIORITY_WEIGHTS","GRADE_IMPACT","COURSE_GRADE","DUE_DATE","TYPE_WEIGHTS","exam","quiz","discussion","announcement","calculatePriority","daysUntilDue","calculateDaysUntilDue","gradeImpact","calculateGradeImpact","courseGradeImpact","calculateCourseGradeImpact","typeWeight","getTypeWeight","components","gradeComponent","courseComponent","dateComponent","calculateDueDatePriority","priorityDetails","dueStatus","getDueStatus","pointsImpact","getPointsImpact","typeImportance","getTypeImportance","dueDateScore","gradeImpactScore","typeScore","finalPriority","min","max","assignmentTitle","dueDateObj","diffTime","ceil","impact","gradeWeight","courseGrade","lowerTitle","setPriorityWeights","weights","totalWeight","abs","assign","AssignmentDetector","dateDebugger","priorityCalculator","async","detectAssignments","window","location","hostname","totalElements","dueDates","allAssignments","plannerItems","missingSubmissions","dashboardItems","Promise","all","fetchPlannerItems","fetchMissingSubmissions","parseDashboardCards","isValidAssignment","validateAssignmentDates","assignmentCount","performanceReport","totalAssignments","matchingDateElements","matchDate","assignmentDate","matchingElements","dateMatchCount","baseUrl","origin","response","fetch","headers","credentials","ok","status","errorText","items","json","convertPlannerItem","submissions","submission","convertMissingSubmission","cardsResponse","cards","streamResponse","streamItems","card","shortName","courseName","upcoming_assignments","converted","convertDashboardAssignment","published_grades","grade","context_name","course_name","course_id","contextCode","context_code","todoResponse","todoItems","context_type","plannable","plannable_type","determineAssignmentType","plannable_date","threeMonthsAgo","setMonth","getMonth","plannable_id","courseId","points_possible","scoring_range","completed","planner_override","marked_complete","url","html_url","details","submissionType","submission_types","isCompleted","isLocked","locked_for_user","description","due_at","due_date","oneWeekAgo","contextName","contextMatch","urlMatch","parseFloat","numericGrade","todo","grading","keys","direct","has_submitted_submissions","submitted","workflow_state","locked","threeMonthsFuture","courseMatch","initialize","isCanvasPage","href","elements","styleSheet","className","toggleContainer","popup","logoImg","querySelector","onload","width","height","complete","naturalWidth","naturalHeight","onerror","settingsButton","success","createElements","settings","displayOptions","showOutsideCanvas","checkbox","checked","target","contains","remove","onMessage","addListener","setupEventListeners","initializeButton","detector","gradeData","pointsPossible","weight"],"sourceRoot":""}