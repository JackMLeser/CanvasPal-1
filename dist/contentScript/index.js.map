{"version":3,"file":"contentScript/index.js","mappings":"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","sources":["webpack://canvaspal/./src/contentScript/canvasButton.ts","webpack://canvaspal/./src/contentScript/index.ts"],"sourcesContent":["// Create and inject the button and popup HTML\nconst createElements = async () => {\n    try {\n        console.log('Creating CanvasPal elements');\n        \n        // Ensure we have access to chrome APIs\n        if (!chrome?.runtime) {\n            throw new Error('Chrome APIs not available');\n        }\n\n        // Get icon URL\n        const iconUrl = chrome.runtime.getURL('icons/icon128.png');\n        console.log('Icon URL:', iconUrl);\n\n        // Create and inject styles\n        const styleSheet = document.createElement('style');\n        styleSheet.textContent = `\n            .canvas-pal-button {\n                position: fixed;\n                right: 20px;\n                top: 20px;\n                width: 44px;\n                height: 44px;\n                border-radius: 50%;\n                background: #0066CC;\n                color: white;\n                border: none;\n                font-size: 16px;\n                font-weight: 600;\n                cursor: pointer;\n                z-index: 2147483647;\n                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                backdrop-filter: blur(8px);\n            }\n\n            .canvas-pal-button:hover {\n                transform: translateY(-2px);\n                background: #0056b3;\n                box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n            }\n\n            .canvas-pal-button.has-assignments {\n                animation: canvas-pal-pulse 2s infinite;\n            }\n\n            @keyframes canvas-pal-pulse {\n                0% { transform: scale(1); }\n                50% { transform: scale(1.05); }\n                100% { transform: scale(1); }\n            }\n\n            .canvas-pal-toggle {\n                position: fixed;\n                top: 20px;\n                right: 70px;\n                z-index: 2147483647;\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                background: rgba(255, 255, 255, 0.9);\n                padding: 6px 12px;\n                border-radius: 20px;\n                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n                font-family: 'Lato', sans-serif;\n                font-size: 12px;\n            }\n\n            .canvas-pal-toggle input {\n                margin: 0;\n                cursor: pointer;\n            }\n\n            .popup-container {\n                position: fixed;\n                right: 20px;\n                top: 75px;\n                width: 350px;\n                min-height: 400px;\n                background: #f9f9f9;\n                border: 2px solid #000;\n                z-index: 2147483646;\n                display: none;\n                font-family: 'Lato', sans-serif;\n            }\n\n            .popup-container.show {\n                display: block;\n            }\n\n            .popup-header {\n                display: flex;\n                align-items: center;\n                justify-content: space-between;\n                background-color: #0066CC;\n                color: white;\n                padding: 12px;\n                position: relative;\n                border-bottom: 1px solid #666;\n                margin-bottom: 16px;\n            }\n\n            .popup-title {\n                flex-grow: 1;\n                text-align: center;\n                margin: 0;\n                font-size: 2.3em;\n                color: #FFFFFF;\n                font-family: 'Lato', sans-serif;\n            }\n\n            .task-count {\n                position: absolute;\n                bottom: 8px;\n                left: 9px;\n                font-size: .7em;\n                color: #FFFFFF;\n                font-family: 'Lato', sans-serif;\n            }\n\n            .logo {\n                margin-left: 16px;\n                display: flex;\n                align-items: center;\n            }\n\n            .logo img {\n                width: 50px;\n                height: 50px;\n                border-radius: 20%;\n                border: 3px solid #FFFFFF;\n                padding: 0;\n                background: white;\n                object-fit: contain;\n            }\n\n            .assignments-list {\n                max-height: 300px;\n                overflow-y: auto;\n                padding: 16px;\n            }\n\n            .assignment-item {\n                padding: 12px;\n                border: 1px solid #eee;\n                margin-bottom: 8px;\n                border-radius: 4px;\n                background: white;\n            }\n\n            .assignment-item.high-priority {\n                border-left: 4px solid #d92b2b;\n            }\n\n            .assignment-item.medium-priority {\n                border-left: 4px solid #f0ad4e;\n            }\n\n            .assignment-item.low-priority {\n                border-left: 4px solid #5cb85c;\n            }\n\n            .settings-button {\n                bottom: 16px;\n                right: 16px;\n                position: absolute;\n                text-align: center;\n            }\n\n            .settings-button button {\n                background-color: #0066CC;\n                color: white;\n                padding: 10px 20px;\n                border-radius: 8px;\n                border: none;\n                transition: background-color 0.3s, transform 0.3s;\n                font-family: 'Lato', sans-serif;\n                cursor: pointer;\n                font-size: 14px;\n                font-weight: 500;\n            }\n\n            .settings-button button:hover {\n                background-color: #0056b3;\n                transform: scale(1.08);\n            }\n\n            @media (prefers-color-scheme: dark) {\n                .popup-container {\n                    background: #1c1c1e;\n                    border-color: #666;\n                }\n\n                .assignment-item {\n                    background: #2c2c2e;\n                    border-color: #666;\n                    color: white;\n                }\n\n                .logo img {\n                    background: transparent;\n                }\n\n                .canvas-pal-toggle {\n                    background: rgba(45, 59, 69, 0.9);\n                    color: white;\n                }\n            }\n        `;\n        document.head.appendChild(styleSheet);\n\n        // Create button\n        const button = document.createElement('button');\n        button.className = 'canvas-pal-button';\n        button.textContent = '0';\n        document.body.appendChild(button);\n\n        // Create toggle for non-Canvas pages\n        const toggleContainer = document.createElement('div');\n        toggleContainer.className = 'canvas-pal-toggle';\n        toggleContainer.innerHTML = `\n            <label>\n                <input type=\"checkbox\" id=\"canvas-pal-visibility\" checked>\n                <span>Follow Outside Canvas</span>\n            </label>\n        `;\n        document.body.appendChild(toggleContainer);\n\n        // Create popup container\n        const popup = document.createElement('div');\n        popup.className = 'popup-container';\n        popup.innerHTML = `\n            <div class=\"popup-header\">\n                <div class=\"popup-title\">CanvasPAL</div>\n                <div class=\"task-count\" id=\"taskCount\">0 Tasks</div>\n                <div class=\"logo\">\n                    <img src=\"${iconUrl}\" alt=\"CanvasPAL Logo\" />\n                </div>\n            </div>\n            <div class=\"assignments-list\" id=\"assignmentList\">\n                <!-- Assignments will be populated here -->\n            </div>\n            <div class=\"settings-button\">\n                <button id=\"settings-button\">Settings</button>\n            </div>\n        `;\n        document.body.appendChild(popup);\n\n        // Add settings button click handler\n        const settingsButton = popup.querySelector('#settings-button');\n        if (settingsButton) {\n            settingsButton.addEventListener('click', () => {\n                console.log('Settings button clicked');\n                try {\n                    const settingsUrl = chrome.runtime.getURL('settings/settings.html');\n                    console.log('Opening settings at:', settingsUrl);\n                    window.open(settingsUrl, '_blank');\n                } catch (error) {\n                    console.error('Error opening settings:', error);\n                }\n            });\n        }\n\n        return { button, toggleContainer, popup };\n    } catch (error) {\n        console.error('Error creating elements:', error);\n        return null;\n    }\n};\n\n// Helper function to determine priority class\nfunction getPriorityClass(score: number): string {\n    if (score >= 0.7) return 'high-priority';\n    if (score >= 0.4) return 'medium-priority';\n    return 'low-priority';\n}\n\n// Helper function to safely update assignments list\nfunction updateAssignmentsList(assignments: any[], assignmentList: HTMLElement, taskCount: HTMLElement) {\n    try {\n        console.log('Updating assignments list:', assignments);\n        taskCount.textContent = `${assignments.length} Tasks`;\n        assignmentList.innerHTML = assignments.map(assignment => `\n            <div class=\"assignment-item ${getPriorityClass(assignment.priorityScore)}\">\n                <div style=\"font-weight: bold;\">${assignment.title}</div>\n                <div>Due: ${assignment.dueDate}</div>\n                <div>Course: ${assignment.courseName}</div>\n                <div>Points: ${assignment.points}</div>\n            </div>\n        `).join('');\n    } catch (error) {\n        console.error('Error updating assignments list:', error);\n    }\n}\n\n// Initialize button and popup functionality\nexport const initializeButton = async () => {\n    try {\n        console.log('Initializing CanvasPal button');\n        const isCanvasPage = window.location.href.includes('.instructure.com');\n        const elements = await createElements();\n        \n        if (!elements) {\n            console.error('Failed to create elements');\n            return;\n        }\n\n        const { button, toggleContainer, popup } = elements;\n\n        // Show/hide toggle based on page type\n        toggleContainer.style.display = isCanvasPage ? 'flex' : 'none';\n\n        // Initialize visibility from settings\n        if (chrome?.storage?.local) {\n            chrome.storage.local.get('settings', (data) => {\n                try {\n                    const settings = data.settings || { displayOptions: { showOutsideCanvas: true } };\n                    const showOutsideCanvas = settings.displayOptions?.showOutsideCanvas ?? true;\n                    \n                    // Update checkbox state\n                    const checkbox = document.getElementById('canvas-pal-visibility') as HTMLInputElement;\n                    if (checkbox) {\n                        checkbox.checked = showOutsideCanvas;\n                    }\n\n                    // Update button visibility\n                    if (!isCanvasPage) {\n                        button.style.display = showOutsideCanvas ? 'flex' : 'none';\n                    }\n                } catch (error) {\n                    console.error('Error handling settings:', error);\n                }\n            });\n        }\n\n        // Handle button click\n        button.addEventListener('click', () => {\n            popup.classList.toggle('show');\n        });\n\n        // Handle toggle change\n        const checkbox = document.getElementById('canvas-pal-visibility');\n        checkbox?.addEventListener('change', (e) => {\n            const target = e.target as HTMLInputElement;\n            if (chrome?.storage?.local) {\n                chrome.storage.local.get('settings', (data) => {\n                    try {\n                        const settings = data.settings || { displayOptions: {} };\n                        if (!settings.displayOptions) settings.displayOptions = {};\n                        settings.displayOptions.showOutsideCanvas = target.checked;\n                        chrome.storage.local.set({ settings });\n                        \n                        // Update button visibility\n                        if (!isCanvasPage) {\n                            button.style.display = target.checked ? 'flex' : 'none';\n                        }\n                    } catch (error) {\n                        console.error('Error updating settings:', error);\n                    }\n                });\n            }\n        });\n\n        // Close popup when clicking outside\n        document.addEventListener('click', (e) => {\n            const target = e.target as HTMLElement;\n            if (!popup.contains(target) && !button.contains(target)) {\n                popup.classList.remove('show');\n            }\n        });\n\n        // Handle assignment updates\n        if (chrome?.runtime) {\n            chrome.runtime.onMessage.addListener((message) => {\n                try {\n                    console.log('Received message:', message);\n                    if (message.type === 'ASSIGNMENTS_UPDATE') {\n                        button.textContent = message.data.length.toString();\n                        button.classList.toggle('has-assignments', message.data.length > 0);\n\n                        const assignmentList = document.getElementById('assignmentList');\n                        const taskCount = document.getElementById('taskCount');\n                        \n                        if (assignmentList && taskCount) {\n                            updateAssignmentsList(message.data, assignmentList, taskCount);\n                        }\n                    } else if (message.type === 'REFRESH_ASSIGNMENTS') {\n                        // Request fresh assignments from the background script\n                        chrome.runtime.sendMessage({ type: 'GET_ASSIGNMENTS' });\n                    }\n                } catch (error) {\n                    console.error('Error handling message:', error);\n                }\n            });\n\n            // Get initial assignments\n            console.log('Requesting initial assignments');\n            chrome.runtime.sendMessage({ type: 'GET_ASSIGNMENTS' }, (response) => {\n                try {\n                    console.log('Received initial assignments:', response);\n                    if (response?.assignments) {\n                        button.textContent = response.assignments.length.toString();\n                        button.classList.toggle('has-assignments', response.assignments.length > 0);\n\n                        const assignmentList = document.getElementById('assignmentList');\n                        const taskCount = document.getElementById('taskCount');\n                        \n                        if (assignmentList && taskCount) {\n                            updateAssignmentsList(response.assignments, assignmentList, taskCount);\n                        }\n                    }\n                } catch (error) {\n                    console.error('Error getting initial assignments:', error);\n                }\n            });\n        }\n    } catch (error) {\n        console.error('Error initializing button:', error);\n    }\n};\n","console.log('CanvasPal content script loaded');\n\nimport { initializeButton } from './canvasButton';\n\n// Initialize the extension\nconst initialize = async () => {\n    try {\n        console.log('Initializing CanvasPal extension');\n\n        // Initialize button and popup\n        initializeButton();\n\n    } catch (error) {\n        console.error('Error initializing CanvasPal:', error);\n    }\n};\n\n// Start initialization when DOM is ready\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', initialize);\n} else {\n    initialize();\n}\n"],"names":["updateAssignmentsList","assignments","assignmentList","taskCount","console","log","textContent","length","innerHTML","map","assignment","score","priorityScore","title","dueDate","courseName","points","join","error","initialize","async","isCanvasPage","window","location","href","includes","elements","chrome","runtime","Error","iconUrl","getURL","styleSheet","document","createElement","head","appendChild","button","className","body","toggleContainer","popup","settingsButton","querySelector","addEventListener","settingsUrl","open","createElements","style","display","storage","local","get","data","settings","displayOptions","showOutsideCanvas","checkbox","getElementById","checked","classList","toggle","e","target","set","contains","remove","onMessage","addListener","message","type","toString","sendMessage","response","initializeButton","readyState"],"sourceRoot":""}